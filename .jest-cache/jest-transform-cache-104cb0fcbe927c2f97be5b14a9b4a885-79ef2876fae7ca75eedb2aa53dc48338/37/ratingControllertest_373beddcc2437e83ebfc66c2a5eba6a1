1827d35c6e234b8c47edab23102cfb79
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the rating service
jest.mock('../services/ratingService');
jest.mock('../services/loggerService', () => ({
    logger: {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn()
    }
}));
const ratingController_1 = require("../controllers/ratingController");
const ratingService_1 = require("../services/ratingService");
describe('RatingController', () => {
    let ratingController;
    let mockRequest;
    let mockResponse;
    let mockStatus;
    let mockJson;
    let mockRatingService;
    beforeEach(() => {
        mockStatus = jest.fn().mockReturnThis();
        mockJson = jest.fn().mockReturnThis();
        mockResponse = {
            status: mockStatus,
            json: mockJson
        };
        ratingController = new ratingController_1.RatingController();
        mockRatingService = ratingService_1.ratingService;
        jest.clearAllMocks();
    });
    // Helper function para crear usuario mock v치lido
    const createValidUser = (overrides = {}) => (Object.assign({ id: 'user123', userId: 'user123', userEmail: 'user@example.com', email: 'user@example.com', role: 'user', name: 'Test User' }, overrides));
    // Helper function para crear rating data v치lido
    const createValidRatingData = (overrides = {}) => (Object.assign({ eventId: 'event123', musicianId: 'musician123', rating: 5, review: 'Excellent performance!', category: 'musician' }, overrides));
    describe('createRating', () => {
        it('should create rating successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingData = createValidRatingData();
            const mockRating = {
                id: 'rating123',
                eventId: 'event123',
                musicianId: 'musician123',
                eventCreatorId: 'user123',
                rating: 5,
                review: 'Excellent performance!',
                category: 'musician',
                isVerified: false,
                createdAt: new Date(),
                updatedAt: new Date(),
                helpfulCount: 0,
                reportedCount: 0,
                isActive: true
            };
            mockRequest = {
                user: createValidUser(),
                body: ratingData
            };
            mockRatingService.createRating.mockResolvedValue(mockRating);
            // Act
            yield ratingController.createRating(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.createRating).toHaveBeenCalledWith({
                eventId: 'event123',
                musicianId: 'musician123',
                eventCreatorId: 'user123',
                rating: 5,
                review: 'Excellent performance!',
                category: 'musician',
                isVerified: false
            });
            expect(mockStatus).toHaveBeenCalledWith(201);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Rating creado exitosamente',
                rating: mockRating
            });
        }));
        it('should return error when user is not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingData = createValidRatingData();
            mockRequest = {
                user: undefined,
                body: ratingData
            };
            // Act
            yield ratingController.createRating(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(401);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                message: 'Usuario no autenticado'
            });
        }));
        it('should return error when required fields are missing', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingData = {
                eventId: 'event123',
                // Missing musicianId, rating, category
                review: 'Excellent performance!'
            };
            mockRequest = {
                user: createValidUser(),
                body: ratingData
            };
            // Act
            yield ratingController.createRating(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                message: 'Faltan campos requeridos: eventId, musicianId, rating, category'
            });
        }));
        // 游 TESTS MEJORADOS: Casos edge para rating
        describe('rating validation edge cases', () => {
            it.each([
                { rating: 0, description: 'rating cero' },
                { rating: -1, description: 'rating negativo' },
                { rating: 6, description: 'rating mayor a 5' },
                { rating: 5.5, description: 'rating decimal' },
                { rating: NaN, description: 'rating NaN' },
                { rating: Infinity, description: 'rating infinito' },
                { rating: -Infinity, description: 'rating infinito negativo' }
            ])('should return error for $description', (_a) => __awaiter(void 0, [_a], void 0, function* ({ rating }) {
                // Arrange
                const ratingData = {
                    eventId: 'event123',
                    musicianId: 'musician123',
                    rating: rating,
                    review: 'Excellent performance!',
                    category: 'musician'
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockStatus).toHaveBeenCalledWith(400);
                // Para rating 0 y NaN, el controlador devuelve "Faltan campos requeridos"
                // Para otros valores, devuelve el mensaje espec칤fico
                if (rating === 0 || isNaN(rating)) {
                    expect(mockJson).toHaveBeenCalledWith({
                        success: false,
                        message: 'Faltan campos requeridos: eventId, musicianId, rating, category'
                    });
                }
                else {
                    expect(mockJson).toHaveBeenCalledWith({
                        success: false,
                        message: 'El rating debe estar entre 1 y 5 estrellas'
                    });
                }
            }));
            it.each([
                { rating: 1, description: 'rating m칤nimo v치lido' },
                { rating: 2, description: 'rating v치lido' },
                { rating: 3, description: 'rating v치lido' },
                { rating: 4, description: 'rating v치lido' },
                { rating: 5, description: 'rating m치ximo v치lido' }
            ])('should accept $description', (_a) => __awaiter(void 0, [_a], void 0, function* ({ rating }) {
                // Arrange
                const ratingData = createValidRatingData({ rating });
                const mockRating = {
                    id: 'rating123',
                    eventId: 'event123',
                    musicianId: 'musician123',
                    eventCreatorId: 'user123',
                    rating,
                    review: 'Excellent performance!',
                    category: 'musician',
                    isVerified: false,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockResolvedValue(mockRating);
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockRatingService.createRating).toHaveBeenCalledWith(expect.objectContaining({ rating }));
                expect(mockStatus).toHaveBeenCalledWith(201);
            }));
        });
        // 游 TESTS MEJORADOS: Validaci칩n de categor칤as
        describe('category validation', () => {
            it.each([
                'invalid',
                'musician_',
                '_musician',
                'MUSICIAN',
                'Musician',
                '',
                null,
                undefined
            ])('should return error for invalid category: %s', (category) => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const ratingData = {
                    eventId: 'event123',
                    musicianId: 'musician123',
                    rating: 5,
                    review: 'Excellent performance!',
                    category: category
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockStatus).toHaveBeenCalledWith(400);
                // Para categor칤as null, undefined o vac칤as, el controlador devuelve "Faltan campos requeridos"
                // Para otros valores, devuelve el mensaje espec칤fico
                if (category === null || category === undefined || category === '') {
                    expect(mockJson).toHaveBeenCalledWith({
                        success: false,
                        message: 'Faltan campos requeridos: eventId, musicianId, rating, category'
                    });
                }
                else {
                    expect(mockJson).toHaveBeenCalledWith({
                        success: false,
                        message: 'Categor칤a debe ser "musician" o "event_creator"'
                    });
                }
            }));
            it.each(['musician', 'event_creator'])('should accept valid category: %s', (category) => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const ratingData = createValidRatingData({ category });
                const mockRating = {
                    id: 'rating123',
                    eventId: 'event123',
                    musicianId: 'musician123',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review: 'Excellent performance!',
                    category: category,
                    isVerified: false,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockResolvedValue(mockRating);
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockRatingService.createRating).toHaveBeenCalledWith(expect.objectContaining({ category }));
                expect(mockStatus).toHaveBeenCalledWith(201);
            }));
        });
        // 游 TESTS MEJORADOS: Validaci칩n de IDs
        describe('ID validation', () => {
            it.each([
                { field: 'eventId', value: '', description: 'eventId vac칤o' },
                { field: 'eventId', value: null, description: 'eventId null' },
                { field: 'eventId', value: undefined, description: 'eventId undefined' },
                { field: 'musicianId', value: '', description: 'musicianId vac칤o' },
                { field: 'musicianId', value: null, description: 'musicianId null' },
                { field: 'musicianId', value: undefined, description: 'musicianId undefined' }
            ])('should return error for $description', (_a) => __awaiter(void 0, [_a], void 0, function* ({ field, value }) {
                // Arrange
                const ratingData = createValidRatingData({ [field]: value });
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockStatus).toHaveBeenCalledWith(400);
                expect(mockJson).toHaveBeenCalledWith({
                    success: false,
                    message: 'Faltan campos requeridos: eventId, musicianId, rating, category'
                });
            }));
        });
        // 游 TESTS MEJORADOS: Casos de error del servicio
        describe('service error handling', () => {
            it('should handle service throwing error', () => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const ratingData = createValidRatingData();
                const serviceError = new Error('Database connection failed');
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockRejectedValue(serviceError);
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockStatus).toHaveBeenCalledWith(500);
                expect(mockJson).toHaveBeenCalledWith({
                    success: false,
                    message: 'Database connection failed'
                });
            }));
            it('should handle unknown error type', () => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const ratingData = createValidRatingData();
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockRejectedValue('String error');
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockStatus).toHaveBeenCalledWith(500);
                expect(mockJson).toHaveBeenCalledWith({
                    success: false,
                    message: 'Error interno del servidor'
                });
            }));
        });
        // 游 TESTS MEJORADOS: Validaci칩n de review
        describe('review validation', () => {
            it('should accept review with special characters', () => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const review = '춰Excelente presentaci칩n! 游꿧游꿨 Muy profesional.';
                const ratingData = createValidRatingData({ review });
                const mockRating = {
                    id: 'rating123',
                    eventId: 'event123',
                    musicianId: 'musician123',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review,
                    category: 'musician',
                    isVerified: false,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockResolvedValue(mockRating);
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockRatingService.createRating).toHaveBeenCalledWith(expect.objectContaining({ review }));
                expect(mockStatus).toHaveBeenCalledWith(201);
            }));
            it('should accept empty review', () => __awaiter(void 0, void 0, void 0, function* () {
                // Arrange
                const ratingData = createValidRatingData({ review: '' });
                const mockRating = {
                    id: 'rating123',
                    eventId: 'event123',
                    musicianId: 'musician123',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review: '',
                    category: 'musician',
                    isVerified: false,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                };
                mockRequest = {
                    user: createValidUser(),
                    body: ratingData
                };
                mockRatingService.createRating.mockResolvedValue(mockRating);
                // Act
                yield ratingController.createRating(mockRequest, mockResponse);
                // Assert
                expect(mockRatingService.createRating).toHaveBeenCalledWith(expect.objectContaining({ review: '' }));
                expect(mockStatus).toHaveBeenCalledWith(201);
            }));
        });
    });
    describe('getUserRatings', () => {
        it('should return user ratings successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            const category = 'musician';
            const mockRatings = [
                {
                    id: 'rating1',
                    eventId: 'event1',
                    musicianId: 'musician1',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review: 'Great performance',
                    category: 'musician',
                    isVerified: true,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                }
            ];
            mockRequest = {
                params: { userId, category },
                query: {
                    minRating: '4',
                    maxRating: '5',
                    isVerified: 'true'
                }
            };
            mockRatingService.getUserRatings.mockResolvedValue(mockRatings);
            // Act
            yield ratingController.getUserRatings(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getUserRatings).toHaveBeenCalledWith(userId, category, {
                minRating: 4,
                maxRating: 5,
                isVerified: true,
                dateFrom: undefined,
                dateTo: undefined
            });
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Ratings obtenidos exitosamente',
                ratings: mockRatings,
                count: mockRatings.length
            });
        }));
        it('should return error when required parameters are missing', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            mockRequest = {
                params: { userId: 'user123' }, // Missing category
                query: {}
            };
            // Act
            yield ratingController.getUserRatings(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                message: 'Faltan par치metros requeridos: userId, category'
            });
        }));
    });
    describe('getUserRatingStats', () => {
        it('should return user rating stats successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            const category = 'musician';
            const mockStats = {
                totalRatings: 10,
                averageRating: 4.5,
                ratingDistribution: {
                    1: 0,
                    2: 1,
                    3: 2,
                    4: 4,
                    5: 3
                },
                verifiedRatings: 8,
                totalReviews: 7,
                recentRatings: [],
                responseRate: 85.5
            };
            mockRequest = {
                params: { userId, category }
            };
            mockRatingService.getUserRatingStats.mockResolvedValue(mockStats);
            // Act
            yield ratingController.getUserRatingStats(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getUserRatingStats).toHaveBeenCalledWith(userId, category);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Estad칤sticas obtenidas exitosamente',
                stats: mockStats
            });
        }));
    });
    describe('updateRating', () => {
        it('should update rating successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingId = 'rating123';
            const updateData = {
                rating: 4,
                review: 'Updated review'
            };
            const mockUpdatedRating = {
                id: ratingId,
                eventId: 'event123',
                musicianId: 'musician123',
                eventCreatorId: 'user123',
                rating: 4,
                review: 'Updated review',
                category: 'musician',
                isVerified: false,
                createdAt: new Date(),
                updatedAt: new Date(),
                helpfulCount: 0,
                reportedCount: 0,
                isActive: true
            };
            mockRequest = {
                user: {
                    id: 'user123',
                    userId: 'user123',
                    userEmail: 'user@example.com',
                    email: 'user@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                params: { ratingId },
                body: updateData
            };
            mockRatingService.getRatingById.mockResolvedValue({
                id: ratingId,
                eventId: 'event123',
                musicianId: 'musician123',
                eventCreatorId: 'user123',
                rating: 3,
                review: 'Original review',
                category: 'musician',
                isActive: true,
                createdAt: new Date(),
                updatedAt: new Date(),
                isVerified: false,
                helpfulCount: 0,
                reportedCount: 0
            });
            mockRatingService.updateRating.mockResolvedValue(mockUpdatedRating);
            // Act
            yield ratingController.updateRating(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.updateRating).toHaveBeenCalledWith(ratingId, updateData);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Rating actualizado exitosamente',
                rating: mockUpdatedRating
            });
        }));
        it('should return error when rating is out of range', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingId = 'rating123';
            const updateData = {
                rating: 6, // Invalid rating
                review: 'Updated review'
            };
            const existingRating = {
                id: ratingId,
                eventId: 'event123',
                musicianId: 'musician123',
                eventCreatorId: 'user123',
                rating: 4,
                review: 'Original review',
                category: 'musician',
                isVerified: false,
                createdAt: new Date(),
                updatedAt: new Date(),
                helpfulCount: 0,
                reportedCount: 0,
                isActive: true
            };
            mockRequest = {
                user: {
                    id: 'user123',
                    userId: 'user123',
                    userEmail: 'user@example.com',
                    email: 'user@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                params: { ratingId },
                body: updateData
            };
            mockRatingService.getRatingById.mockResolvedValue(existingRating);
            // Act
            yield ratingController.updateRating(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                message: 'El rating debe estar entre 1 y 5 estrellas'
            });
        }));
    });
    describe('markRatingAsHelpful', () => {
        it('should mark rating as helpful successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingId = 'rating123';
            const mockUpdatedRating = {
                id: ratingId,
                helpfulCount: 5,
                isHelpful: true
            };
            mockRequest = {
                user: {
                    id: 'user123',
                    userId: 'user123',
                    userEmail: 'user@example.com',
                    email: 'user@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                params: { ratingId }
            };
            mockRatingService.markRatingAsHelpful.mockResolvedValue();
            // Act
            yield ratingController.markRatingAsHelpful(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.markRatingAsHelpful).toHaveBeenCalledWith(ratingId);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Rating marcado como 칰til exitosamente'
            });
        }));
    });
    describe('reportRating', () => {
        it('should report rating successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingId = 'rating123';
            const reportData = {
                reason: 'inappropriate_content',
                description: 'This rating contains inappropriate content'
            };
            mockRequest = {
                user: {
                    id: 'user123',
                    userId: 'user123',
                    userEmail: 'user@example.com',
                    email: 'user@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                params: { ratingId },
                body: reportData
            };
            mockRatingService.reportRating.mockResolvedValue(undefined);
            // Act
            yield ratingController.reportRating(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.reportRating).toHaveBeenCalledWith(ratingId, 'inappropriate_content');
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Rating reportado exitosamente'
            });
        }));
        it('should return error when reason is missing', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const ratingId = 'rating123';
            const reportData = {
                description: 'This rating contains inappropriate content'
                // Missing reason
            };
            mockRequest = {
                user: {
                    id: 'user123',
                    userId: 'user123',
                    userEmail: 'user@example.com',
                    email: 'user@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                params: { ratingId },
                body: reportData
            };
            // Act
            yield ratingController.reportRating(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                message: 'ID de rating y raz칩n requeridos'
            });
        }));
    });
    describe('getEventRatings', () => {
        it('should return event ratings successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const eventId = 'event123';
            const mockRatings = [
                {
                    id: 'rating1',
                    eventId: 'event123',
                    musicianId: 'musician1',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review: 'Great performance',
                    category: 'musician',
                    isVerified: true,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    helpfulCount: 0,
                    reportedCount: 0,
                    isActive: true
                }
            ];
            mockRequest = {
                params: { eventId },
                query: {
                    category: 'musician',
                    minRating: '4'
                }
            };
            mockRatingService.getEventRatings.mockResolvedValue(mockRatings);
            // Act
            yield ratingController.getEventRatings(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getEventRatings).toHaveBeenCalledWith(eventId);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Ratings del evento obtenidos exitosamente',
                ratings: mockRatings,
                count: mockRatings.length
            });
        }));
    });
    describe('getTopRatedMusicians', () => {
        it('should return top rated musicians successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const mockMusicians = [
                {
                    userId: 'musician1',
                    stats: {
                        averageRating: 4.8,
                        totalRatings: 50,
                        ratingDistribution: { 1: 0, 2: 1, 3: 2, 4: 15, 5: 32 },
                        recentRatings: [],
                        verifiedRatings: 45,
                        responseRate: 90.0
                    }
                }
            ];
            mockRequest = {
                query: {
                    limit: '10',
                    minRatings: '5'
                }
            };
            mockRatingService.getTopRatedMusicians.mockResolvedValue(mockMusicians);
            // Act
            yield ratingController.getTopRatedMusicians(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getTopRatedMusicians).toHaveBeenCalledWith(10, 5);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Top m칰sicos obtenidos exitosamente',
                musicians: mockMusicians,
                count: mockMusicians.length
            });
        }));
    });
    describe('getRatingTrends', () => {
        it('should return rating trends successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const mockTrends = {
                averageRatingByDay: {
                    '2024-01-01': 4.2,
                    '2024-01-02': 4.5
                },
                totalRatingsByDay: {
                    '2024-01-01': 25,
                    '2024-01-02': 30
                },
                categoryDistribution: {
                    'musician': 60,
                    'event_creator': 40
                }
            };
            mockRequest = {
                query: {
                    period: 'monthly',
                    userId: 'user123'
                }
            };
            mockRatingService.getRatingTrends.mockResolvedValue(mockTrends);
            // Act
            yield ratingController.getRatingTrends(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getRatingTrends).toHaveBeenCalledWith(30);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Tendencias de rating obtenidas exitosamente',
                trends: mockTrends
            });
        }));
    });
    describe('getMostHelpfulRatings', () => {
        it('should return most helpful ratings successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const mockRatings = [
                {
                    id: 'rating1',
                    eventId: 'event1',
                    musicianId: 'musician1',
                    eventCreatorId: 'user123',
                    rating: 5,
                    review: 'Very helpful review',
                    category: 'musician',
                    helpfulCount: 10,
                    isVerified: true,
                    createdAt: new Date(),
                    updatedAt: new Date(),
                    reportedCount: 0,
                    isActive: true
                }
            ];
            mockRequest = {
                params: {
                    userId: 'user123',
                    category: 'musician'
                },
                query: {
                    limit: '5'
                }
            };
            mockRatingService.getMostHelpfulRatings.mockResolvedValue(mockRatings);
            // Act
            yield ratingController.getMostHelpfulRatings(mockRequest, mockResponse);
            // Assert
            expect(mockRatingService.getMostHelpfulRatings).toHaveBeenCalledWith('user123', 'musician', 5);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Ratings m치s 칰tiles obtenidos exitosamente',
                ratings: mockRatings,
                count: mockRatings.length
            });
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXHJhdGluZ0NvbnRyb2xsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUlBLDBCQUEwQjtBQUMxQixJQUFJLENBQUMsSUFBSSxDQUFDLDJCQUEyQixDQUFDLENBQUM7QUFDdkMsSUFBSSxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzVDLE1BQU0sRUFBRTtRQUNOLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2YsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDaEI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQVhKLHNFQUFtRTtBQUNuRSw2REFBMEQ7QUFZMUQsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLGdCQUFrQyxDQUFDO0lBQ3ZDLElBQUksV0FBNkIsQ0FBQztJQUNsQyxJQUFJLFlBQStCLENBQUM7SUFDcEMsSUFBSSxVQUFxQixDQUFDO0lBQzFCLElBQUksUUFBbUIsQ0FBQztJQUN4QixJQUFJLGlCQUFvRCxDQUFDO0lBRXpELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3hDLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdEMsWUFBWSxHQUFHO1lBQ2IsTUFBTSxFQUFFLFVBQVU7WUFDbEIsSUFBSSxFQUFFLFFBQVE7U0FDZixDQUFDO1FBRUYsZ0JBQWdCLEdBQUcsSUFBSSxtQ0FBZ0IsRUFBRSxDQUFDO1FBQzFDLGlCQUFpQixHQUFHLDZCQUFrRCxDQUFDO1FBRXZFLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FB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Q3BELE9BQU8sRUFBRSxXQUFXO2dCQUNwQixLQUFLLEVBQUUsV0FBVyxDQUFDLE1BQU07YUFDMUIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXHJhdGluZ0NvbnRyb2xsZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgUmF0aW5nQ29udHJvbGxlciB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL3JhdGluZ0NvbnRyb2xsZXInO1xuaW1wb3J0IHsgcmF0aW5nU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3JhdGluZ1NlcnZpY2UnO1xuXG4vLyBNb2NrIHRoZSByYXRpbmcgc2VydmljZVxuamVzdC5tb2NrKCcuLi9zZXJ2aWNlcy9yYXRpbmdTZXJ2aWNlJyk7XG5qZXN0Lm1vY2soJy4uL3NlcnZpY2VzL2xvZ2dlclNlcnZpY2UnLCAoKSA9PiAoe1xuICBsb2dnZXI6IHtcbiAgICBpbmZvOiBqZXN0LmZuKCksXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcbiAgICB3YXJuOiBqZXN0LmZuKClcbiAgfVxufSkpO1xuXG5kZXNjcmliZSgnUmF0aW5nQ29udHJvbGxlcicsICgpID0+IHtcbiAgbGV0IHJhdGluZ0NvbnRyb2xsZXI6IFJhdGluZ0NvbnRyb2xsZXI7XG4gIGxldCBtb2NrUmVxdWVzdDogUGFydGlhbDxSZXF1ZXN0PjtcbiAgbGV0IG1vY2tSZXNwb25zZTogUGFydGlhbDxSZXNwb25zZT47XG4gIGxldCBtb2NrU3RhdHVzOiBqZXN0Lk1vY2s7XG4gIGxldCBtb2NrSnNvbjogamVzdC5Nb2NrO1xuICBsZXQgbW9ja1JhdGluZ1NlcnZpY2U6IGplc3QuTW9ja2VkPHR5cGVvZiByYXRpbmdTZXJ2aWNlPjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrU3RhdHVzID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgbW9ja0pzb24gPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICBtb2NrUmVzcG9uc2UgPSB7XG4gICAgICBzdGF0dXM6IG1vY2tTdGF0dXMsXG4gICAgICBqc29uOiBtb2NrSnNvblxuICAgIH07XG5cbiAgICByYXRpbmdDb250cm9sbGVyID0gbmV3IFJhdGluZ0NvbnRyb2xsZXIoKTtcbiAgICBtb2NrUmF0aW5nU2VydmljZSA9IHJhdGluZ1NlcnZpY2UgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIHJhdGluZ1NlcnZpY2U+O1xuXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiBwYXJhIGNyZWFyIHVzdWFyaW8gbW9jayB2w6FsaWRvXG4gIGNvbnN0IGNyZWF0ZVZhbGlkVXNlciA9IChvdmVycmlkZXMgPSB7fSkgPT4gKHtcbiAgICBpZDogJ3VzZXIxMjMnLFxuICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgIHVzZXJFbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXG4gICAgcm9sZTogJ3VzZXInLFxuICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgIC4uLm92ZXJyaWRlc1xuICB9KTtcblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gcGFyYSBjcmVhciByYXRpbmcgZGF0YSB2w6FsaWRvXG4gIGNvbnN0IGNyZWF0ZVZhbGlkUmF0aW5nRGF0YSA9IChvdmVycmlkZXMgPSB7fSkgPT4gKHtcbiAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgcmF0aW5nOiA1LFxuICAgIHJldmlldzogJ0V4Y2VsbGVudCBwZXJmb3JtYW5jZSEnLFxuICAgIGNhdGVnb3J5OiAnbXVzaWNpYW4nIGFzIGNvbnN0LFxuICAgIC4uLm92ZXJyaWRlc1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JlYXRlUmF0aW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIHJhdGluZyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCByYXRpbmdEYXRhID0gY3JlYXRlVmFsaWRSYXRpbmdEYXRhKCk7XG4gICAgICBjb25zdCBtb2NrUmF0aW5nID0ge1xuICAgICAgICBpZDogJ3JhdGluZzEyMycsXG4gICAgICAgIGV2ZW50SWQ6ICdldmVudDEyMycsXG4gICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgICAgIGV2ZW50Q3JlYXRvcklkOiAndXNlcjEyMycsXG4gICAgICAgIHJhdGluZzogNSxcbiAgICAgICAgcmV2aWV3OiAnRXhjZWxsZW50IHBlcmZvcm1hbmNlIScsXG4gICAgICAgIGNhdGVnb3J5OiAnbXVzaWNpYW4nIGFzIGNvbnN0LFxuICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGhlbHBmdWxDb3VudDogMCxcbiAgICAgICAgcmVwb3J0ZWRDb3VudDogMCxcbiAgICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiBjcmVhdGVWYWxpZFVzZXIoKSxcbiAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgfTtcblxuICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuY3JlYXRlUmF0aW5nLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRpbmcpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIuY3JlYXRlUmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xMjMnLFxuICAgICAgICBldmVudENyZWF0b3JJZDogJ3VzZXIxMjMnLFxuICAgICAgICByYXRpbmc6IDUsXG4gICAgICAgIHJldmlldzogJ0V4Y2VsbGVudCBwZXJmb3JtYW5jZSEnLFxuICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyxcbiAgICAgICAgaXNWZXJpZmllZDogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JhdGluZyBjcmVhZG8gZXhpdG9zYW1lbnRlJyxcbiAgICAgICAgcmF0aW5nOiBtb2NrUmF0aW5nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHJhdGluZ0RhdGEgPSBjcmVhdGVWYWxpZFJhdGluZ0RhdGEoKTtcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB1bmRlZmluZWQsXG4gICAgICAgIGJvZHk6IHJhdGluZ0RhdGFcbiAgICAgIH07XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5jcmVhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ1VzdWFyaW8gbm8gYXV0ZW50aWNhZG8nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gcmVxdWlyZWQgZmllbGRzIGFyZSBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcmF0aW5nRGF0YSA9IHtcbiAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgLy8gTWlzc2luZyBtdXNpY2lhbklkLCByYXRpbmcsIGNhdGVnb3J5XG4gICAgICAgIHJldmlldzogJ0V4Y2VsbGVudCBwZXJmb3JtYW5jZSEnXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgIGJvZHk6IHJhdGluZ0RhdGFcbiAgICAgIH07XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5jcmVhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbWVzc2FnZTogJ0ZhbHRhbiBjYW1wb3MgcmVxdWVyaWRvczogZXZlbnRJZCwgbXVzaWNpYW5JZCwgcmF0aW5nLCBjYXRlZ29yeSdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8g8J+GlSBURVNUUyBNRUpPUkFET1M6IENhc29zIGVkZ2UgcGFyYSByYXRpbmdcbiAgICBkZXNjcmliZSgncmF0aW5nIHZhbGlkYXRpb24gZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICAgIGl0LmVhY2goW1xuICAgICAgICB7IHJhdGluZzogMCwgZGVzY3JpcHRpb246ICdyYXRpbmcgY2VybycgfSxcbiAgICAgICAgeyByYXRpbmc6IC0xLCBkZXNjcmlwdGlvbjogJ3JhdGluZyBuZWdhdGl2bycgfSxcbiAgICAgICAgeyByYXRpbmc6IDYsIGRlc2NyaXB0aW9uOiAncmF0aW5nIG1heW9yIGEgNScgfSxcbiAgICAgICAgeyByYXRpbmc6IDUuNSwgZGVzY3JpcHRpb246ICdyYXRpbmcgZGVjaW1hbCcgfSxcbiAgICAgICAgeyByYXRpbmc6IE5hTiwgZGVzY3JpcHRpb246ICdyYXRpbmcgTmFOJyB9LFxuICAgICAgICB7IHJhdGluZzogSW5maW5pdHksIGRlc2NyaXB0aW9uOiAncmF0aW5nIGluZmluaXRvJyB9LFxuICAgICAgICB7IHJhdGluZzogLUluZmluaXR5LCBkZXNjcmlwdGlvbjogJ3JhdGluZyBpbmZpbml0byBuZWdhdGl2bycgfVxuICAgICAgXSkoJ3Nob3VsZCByZXR1cm4gZXJyb3IgZm9yICRkZXNjcmlwdGlvbicsIGFzeW5jICh7IHJhdGluZyB9KSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgcmF0aW5nRGF0YSA9IHtcbiAgICAgICAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgICAgICAgcmF0aW5nOiByYXRpbmcsXG4gICAgICAgICAgcmV2aWV3OiAnRXhjZWxsZW50IHBlcmZvcm1hbmNlIScsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdtdXNpY2lhbicgYXMgY29uc3RcbiAgICAgICAgfTtcbiAgICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLmNyZWF0ZVJhdGluZyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAgIC8vIEFzc2VydFxuICAgICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcbiAgICAgICAgLy8gUGFyYSByYXRpbmcgMCB5IE5hTiwgZWwgY29udHJvbGFkb3IgZGV2dWVsdmUgXCJGYWx0YW4gY2FtcG9zIHJlcXVlcmlkb3NcIlxuICAgICAgICAvLyBQYXJhIG90cm9zIHZhbG9yZXMsIGRldnVlbHZlIGVsIG1lbnNhamUgZXNwZWPDrWZpY29cbiAgICAgICAgaWYgKHJhdGluZyA9PT0gMCB8fCBpc05hTihyYXRpbmcpKSB7XG4gICAgICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdGYWx0YW4gY2FtcG9zIHJlcXVlcmlkb3M6IGV2ZW50SWQsIG11c2ljaWFuSWQsIHJhdGluZywgY2F0ZWdvcnknXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdFbCByYXRpbmcgZGViZSBlc3RhciBlbnRyZSAxIHkgNSBlc3RyZWxsYXMnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpdC5lYWNoKFtcbiAgICAgICAgeyByYXRpbmc6IDEsIGRlc2NyaXB0aW9uOiAncmF0aW5nIG3DrW5pbW8gdsOhbGlkbycgfSxcbiAgICAgICAgeyByYXRpbmc6IDIsIGRlc2NyaXB0aW9uOiAncmF0aW5nIHbDoWxpZG8nIH0sXG4gICAgICAgIHsgcmF0aW5nOiAzLCBkZXNjcmlwdGlvbjogJ3JhdGluZyB2w6FsaWRvJyB9LFxuICAgICAgICB7IHJhdGluZzogNCwgZGVzY3JpcHRpb246ICdyYXRpbmcgdsOhbGlkbycgfSxcbiAgICAgICAgeyByYXRpbmc6IDUsIGRlc2NyaXB0aW9uOiAncmF0aW5nIG3DoXhpbW8gdsOhbGlkbycgfVxuICAgICAgXSkoJ3Nob3VsZCBhY2NlcHQgJGRlc2NyaXB0aW9uJywgYXN5bmMgKHsgcmF0aW5nIH0pID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCByYXRpbmdEYXRhID0gY3JlYXRlVmFsaWRSYXRpbmdEYXRhKHsgcmF0aW5nIH0pO1xuICAgICAgICBjb25zdCBtb2NrUmF0aW5nID0ge1xuICAgICAgICAgIGlkOiAncmF0aW5nMTIzJyxcbiAgICAgICAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgICAgICAgZXZlbnRDcmVhdG9ySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICByYXRpbmcsXG4gICAgICAgICAgcmV2aWV3OiAnRXhjZWxsZW50IHBlcmZvcm1hbmNlIScsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdtdXNpY2lhbicgYXMgY29uc3QsXG4gICAgICAgICAgaXNWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICBoZWxwZnVsQ291bnQ6IDAsXG4gICAgICAgICAgcmVwb3J0ZWRDb3VudDogMCxcbiAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICAgIHVzZXI6IGNyZWF0ZVZhbGlkVXNlcigpLFxuICAgICAgICAgIGJvZHk6IHJhdGluZ0RhdGFcbiAgICAgICAgfTtcblxuICAgICAgICBtb2NrUmF0aW5nU2VydmljZS5jcmVhdGVSYXRpbmcubW9ja1Jlc29sdmVkVmFsdWUobW9ja1JhdGluZyk7XG5cbiAgICAgICAgLy8gQWN0XG4gICAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIuY3JlYXRlUmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChtb2NrUmF0aW5nU2VydmljZS5jcmVhdGVSYXRpbmcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgcmF0aW5nIH0pXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDEpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyDwn4aVIFRFU1RTIE1FSk9SQURPUzogVmFsaWRhY2nDs24gZGUgY2F0ZWdvcsOtYXNcbiAgICBkZXNjcmliZSgnY2F0ZWdvcnkgdmFsaWRhdGlvbicsICgpID0+IHtcbiAgICAgIGl0LmVhY2goW1xuICAgICAgICAnaW52YWxpZCcsXG4gICAgICAgICdtdXNpY2lhbl8nLFxuICAgICAgICAnX211c2ljaWFuJyxcbiAgICAgICAgJ01VU0lDSUFOJyxcbiAgICAgICAgJ011c2ljaWFuJyxcbiAgICAgICAgJycsXG4gICAgICAgIG51bGwsXG4gICAgICAgIHVuZGVmaW5lZFxuICAgICAgXSkoJ3Nob3VsZCByZXR1cm4gZXJyb3IgZm9yIGludmFsaWQgY2F0ZWdvcnk6ICVzJywgYXN5bmMgKGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgcmF0aW5nRGF0YSA9IHtcbiAgICAgICAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgICAgICAgcmF0aW5nOiA1LFxuICAgICAgICAgIHJldmlldzogJ0V4Y2VsbGVudCBwZXJmb3JtYW5jZSEnLFxuICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeVxuICAgICAgICB9O1xuICAgICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgICB1c2VyOiBjcmVhdGVWYWxpZFVzZXIoKSxcbiAgICAgICAgICBib2R5OiByYXRpbmdEYXRhXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0XG4gICAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIuY3JlYXRlUmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xuICAgICAgICAvLyBQYXJhIGNhdGVnb3LDrWFzIG51bGwsIHVuZGVmaW5lZCBvIHZhY8OtYXMsIGVsIGNvbnRyb2xhZG9yIGRldnVlbHZlIFwiRmFsdGFuIGNhbXBvcyByZXF1ZXJpZG9zXCJcbiAgICAgICAgLy8gUGFyYSBvdHJvcyB2YWxvcmVzLCBkZXZ1ZWx2ZSBlbCBtZW5zYWplIGVzcGVjw61maWNvXG4gICAgICAgIGlmIChjYXRlZ29yeSA9PT0gbnVsbCB8fCBjYXRlZ29yeSA9PT0gdW5kZWZpbmVkIHx8IGNhdGVnb3J5ID09PSAnJykge1xuICAgICAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiAnRmFsdGFuIGNhbXBvcyByZXF1ZXJpZG9zOiBldmVudElkLCBtdXNpY2lhbklkLCByYXRpbmcsIGNhdGVnb3J5J1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiAnQ2F0ZWdvcsOtYSBkZWJlIHNlciBcIm11c2ljaWFuXCIgbyBcImV2ZW50X2NyZWF0b3JcIidcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGl0LmVhY2goWydtdXNpY2lhbicsICdldmVudF9jcmVhdG9yJ10pKCdzaG91bGQgYWNjZXB0IHZhbGlkIGNhdGVnb3J5OiAlcycsIGFzeW5jIChjYXRlZ29yeSkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IHJhdGluZ0RhdGEgPSBjcmVhdGVWYWxpZFJhdGluZ0RhdGEoeyBjYXRlZ29yeSB9KTtcbiAgICAgICAgY29uc3QgbW9ja1JhdGluZyA9IHtcbiAgICAgICAgICBpZDogJ3JhdGluZzEyMycsXG4gICAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xMjMnLFxuICAgICAgICAgIGV2ZW50Q3JlYXRvcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgcmF0aW5nOiA1LFxuICAgICAgICAgIHJldmlldzogJ0V4Y2VsbGVudCBwZXJmb3JtYW5jZSEnLFxuICAgICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSBhcyAnbXVzaWNpYW4nIHwgJ2V2ZW50X2NyZWF0b3InLFxuICAgICAgICAgIGlzVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgaGVscGZ1bENvdW50OiAwLFxuICAgICAgICAgIHJlcG9ydGVkQ291bnQ6IDAsXG4gICAgICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICAgICAgfTtcblxuICAgICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgICB1c2VyOiBjcmVhdGVWYWxpZFVzZXIoKSxcbiAgICAgICAgICBib2R5OiByYXRpbmdEYXRhXG4gICAgICAgIH07XG5cbiAgICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuY3JlYXRlUmF0aW5nLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRpbmcpO1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLmNyZWF0ZVJhdGluZyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAgIC8vIEFzc2VydFxuICAgICAgICBleHBlY3QobW9ja1JhdGluZ1NlcnZpY2UuY3JlYXRlUmF0aW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGNhdGVnb3J5IH0pXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDEpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyDwn4aVIFRFU1RTIE1FSk9SQURPUzogVmFsaWRhY2nDs24gZGUgSURzXG4gICAgZGVzY3JpYmUoJ0lEIHZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgICBpdC5lYWNoKFtcbiAgICAgICAgeyBmaWVsZDogJ2V2ZW50SWQnLCB2YWx1ZTogJycsIGRlc2NyaXB0aW9uOiAnZXZlbnRJZCB2YWPDrW8nIH0sXG4gICAgICAgIHsgZmllbGQ6ICdldmVudElkJywgdmFsdWU6IG51bGwsIGRlc2NyaXB0aW9uOiAnZXZlbnRJZCBudWxsJyB9LFxuICAgICAgICB7IGZpZWxkOiAnZXZlbnRJZCcsIHZhbHVlOiB1bmRlZmluZWQsIGRlc2NyaXB0aW9uOiAnZXZlbnRJZCB1bmRlZmluZWQnIH0sXG4gICAgICAgIHsgZmllbGQ6ICdtdXNpY2lhbklkJywgdmFsdWU6ICcnLCBkZXNjcmlwdGlvbjogJ211c2ljaWFuSWQgdmFjw61vJyB9LFxuICAgICAgICB7IGZpZWxkOiAnbXVzaWNpYW5JZCcsIHZhbHVlOiBudWxsLCBkZXNjcmlwdGlvbjogJ211c2ljaWFuSWQgbnVsbCcgfSxcbiAgICAgICAgeyBmaWVsZDogJ211c2ljaWFuSWQnLCB2YWx1ZTogdW5kZWZpbmVkLCBkZXNjcmlwdGlvbjogJ211c2ljaWFuSWQgdW5kZWZpbmVkJyB9XG4gICAgICBdKSgnc2hvdWxkIHJldHVybiBlcnJvciBmb3IgJGRlc2NyaXB0aW9uJywgYXN5bmMgKHsgZmllbGQsIHZhbHVlIH0pID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCByYXRpbmdEYXRhID0gY3JlYXRlVmFsaWRSYXRpbmdEYXRhKHsgW2ZpZWxkXTogdmFsdWUgfSk7XG4gICAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICAgIHVzZXI6IGNyZWF0ZVZhbGlkVXNlcigpLFxuICAgICAgICAgIGJvZHk6IHJhdGluZ0RhdGFcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5jcmVhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XG4gICAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWx0YW4gY2FtcG9zIHJlcXVlcmlkb3M6IGV2ZW50SWQsIG11c2ljaWFuSWQsIHJhdGluZywgY2F0ZWdvcnknXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyDwn4aVIFRFU1RTIE1FSk9SQURPUzogQ2Fzb3MgZGUgZXJyb3IgZGVsIHNlcnZpY2lvXG4gICAgZGVzY3JpYmUoJ3NlcnZpY2UgZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXJ2aWNlIHRocm93aW5nIGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IHJhdGluZ0RhdGEgPSBjcmVhdGVWYWxpZFJhdGluZ0RhdGEoKTtcbiAgICAgICAgY29uc3Qgc2VydmljZUVycm9yID0gbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgICAgICBcbiAgICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZy5tb2NrUmVqZWN0ZWRWYWx1ZShzZXJ2aWNlRXJyb3IpO1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLmNyZWF0ZVJhdGluZyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAgIC8vIEFzc2VydFxuICAgICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNTAwKTtcbiAgICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgbWVzc2FnZTogJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJ1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmtub3duIGVycm9yIHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgcmF0aW5nRGF0YSA9IGNyZWF0ZVZhbGlkUmF0aW5nRGF0YSgpO1xuICAgICAgICBcbiAgICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZy5tb2NrUmVqZWN0ZWRWYWx1ZSgnU3RyaW5nIGVycm9yJyk7XG5cbiAgICAgICAgLy8gQWN0XG4gICAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIuY3JlYXRlUmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xuICAgICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBtZXNzYWdlOiAnRXJyb3IgaW50ZXJubyBkZWwgc2Vydmlkb3InXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyDwn4aVIFRFU1RTIE1FSk9SQURPUzogVmFsaWRhY2nDs24gZGUgcmV2aWV3XG4gICAgZGVzY3JpYmUoJ3JldmlldyB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgcmV2aWV3IHdpdGggc3BlY2lhbCBjaGFyYWN0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IHJldmlldyA9ICfCoUV4Y2VsZW50ZSBwcmVzZW50YWNpw7NuISDwn4618J+OtiBNdXkgcHJvZmVzaW9uYWwuJztcbiAgICAgICAgY29uc3QgcmF0aW5nRGF0YSA9IGNyZWF0ZVZhbGlkUmF0aW5nRGF0YSh7IHJldmlldyB9KTtcbiAgICAgICAgY29uc3QgbW9ja1JhdGluZyA9IHtcbiAgICAgICAgICBpZDogJ3JhdGluZzEyMycsXG4gICAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xMjMnLFxuICAgICAgICAgIGV2ZW50Q3JlYXRvcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgcmF0aW5nOiA1LFxuICAgICAgICAgIHJldmlldyxcbiAgICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyBhcyBjb25zdCxcbiAgICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGhlbHBmdWxDb3VudDogMCxcbiAgICAgICAgICByZXBvcnRlZENvdW50OiAwLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmF0aW5nKTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5jcmVhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyByZXZpZXcgfSlcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgZW1wdHkgcmV2aWV3JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IHJhdGluZ0RhdGEgPSBjcmVhdGVWYWxpZFJhdGluZ0RhdGEoeyByZXZpZXc6ICcnIH0pO1xuICAgICAgICBjb25zdCBtb2NrUmF0aW5nID0ge1xuICAgICAgICAgIGlkOiAncmF0aW5nMTIzJyxcbiAgICAgICAgICBldmVudElkOiAnZXZlbnQxMjMnLFxuICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXG4gICAgICAgICAgZXZlbnRDcmVhdG9ySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICByYXRpbmc6IDUsXG4gICAgICAgICAgcmV2aWV3OiAnJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyBhcyBjb25zdCxcbiAgICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGhlbHBmdWxDb3VudDogMCxcbiAgICAgICAgICByZXBvcnRlZENvdW50OiAwLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlVmFsaWRVc2VyKCksXG4gICAgICAgICAgYm9keTogcmF0aW5nRGF0YVxuICAgICAgICB9O1xuXG4gICAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmF0aW5nKTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5jcmVhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KG1vY2tSYXRpbmdTZXJ2aWNlLmNyZWF0ZVJhdGluZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyByZXZpZXc6ICcnIH0pXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRVc2VyUmF0aW5ncycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIHJhdGluZ3Mgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlcklkID0gJ3VzZXIxMjMnO1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSAnbXVzaWNpYW4nO1xuICAgICAgY29uc3QgbW9ja1JhdGluZ3MgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3JhdGluZzEnLFxuICAgICAgICAgIGV2ZW50SWQ6ICdldmVudDEnLFxuICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEnLFxuICAgICAgICAgIGV2ZW50Q3JlYXRvcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgcmF0aW5nOiA1LFxuICAgICAgICAgIHJldmlldzogJ0dyZWF0IHBlcmZvcm1hbmNlJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyBhcyBjb25zdCxcbiAgICAgICAgICBpc1ZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgaGVscGZ1bENvdW50OiAwLFxuICAgICAgICAgIHJlcG9ydGVkQ291bnQ6IDAsXG4gICAgICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHBhcmFtczogeyB1c2VySWQsIGNhdGVnb3J5IH0sXG4gICAgICAgIHF1ZXJ5OiB7XG4gICAgICAgICAgbWluUmF0aW5nOiAnNCcsXG4gICAgICAgICAgbWF4UmF0aW5nOiAnNScsXG4gICAgICAgICAgaXNWZXJpZmllZDogJ3RydWUnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmdldFVzZXJSYXRpbmdzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRpbmdzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLmdldFVzZXJSYXRpbmdzKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tSYXRpbmdTZXJ2aWNlLmdldFVzZXJSYXRpbmdzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VySWQsIGNhdGVnb3J5LCB7XG4gICAgICAgIG1pblJhdGluZzogNCxcbiAgICAgICAgbWF4UmF0aW5nOiA1LFxuICAgICAgICBpc1ZlcmlmaWVkOiB0cnVlLFxuICAgICAgICBkYXRlRnJvbTogdW5kZWZpbmVkLFxuICAgICAgICBkYXRlVG86IHVuZGVmaW5lZFxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JhdGluZ3Mgb2J0ZW5pZG9zIGV4aXRvc2FtZW50ZScsXG4gICAgICAgIHJhdGluZ3M6IG1vY2tSYXRpbmdzLFxuICAgICAgICBjb3VudDogbW9ja1JhdGluZ3MubGVuZ3RoXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gcmVxdWlyZWQgcGFyYW1ldGVycyBhcmUgbWlzc2luZycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHsgdXNlcklkOiAndXNlcjEyMycgfSwgLy8gTWlzc2luZyBjYXRlZ29yeVxuICAgICAgICBxdWVyeToge31cbiAgICAgIH07XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5nZXRVc2VyUmF0aW5ncyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnRmFsdGFuIHBhcsOhbWV0cm9zIHJlcXVlcmlkb3M6IHVzZXJJZCwgY2F0ZWdvcnknXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFVzZXJSYXRpbmdTdGF0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIHJhdGluZyBzdGF0cyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1c2VySWQgPSAndXNlcjEyMyc7XG4gICAgICBjb25zdCBjYXRlZ29yeSA9ICdtdXNpY2lhbic7XG4gICAgICBjb25zdCBtb2NrU3RhdHMgPSB7XG4gICAgICAgIHRvdGFsUmF0aW5nczogMTAsXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDQuNSxcbiAgICAgICAgcmF0aW5nRGlzdHJpYnV0aW9uOiB7XG4gICAgICAgICAgMTogMCxcbiAgICAgICAgICAyOiAxLFxuICAgICAgICAgIDM6IDIsXG4gICAgICAgICAgNDogNCxcbiAgICAgICAgICA1OiAzXG4gICAgICAgIH0sXG4gICAgICAgIHZlcmlmaWVkUmF0aW5nczogOCxcbiAgICAgICAgdG90YWxSZXZpZXdzOiA3LFxuICAgICAgICByZWNlbnRSYXRpbmdzOiBbXSxcbiAgICAgICAgcmVzcG9uc2VSYXRlOiA4NS41XG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgcGFyYW1zOiB7IHVzZXJJZCwgY2F0ZWdvcnkgfVxuICAgICAgfTtcblxuICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuZ2V0VXNlclJhdGluZ1N0YXRzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tTdGF0cyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5nZXRVc2VyUmF0aW5nU3RhdHMobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1JhdGluZ1NlcnZpY2UuZ2V0VXNlclJhdGluZ1N0YXRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VySWQsIGNhdGVnb3J5KTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnRXN0YWTDrXN0aWNhcyBvYnRlbmlkYXMgZXhpdG9zYW1lbnRlJyxcbiAgICAgICAgc3RhdHM6IG1vY2tTdGF0c1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVSYXRpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgcmF0aW5nIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHJhdGluZ0lkID0gJ3JhdGluZzEyMyc7XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICByYXRpbmc6IDQsXG4gICAgICAgIHJldmlldzogJ1VwZGF0ZWQgcmV2aWV3J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgbW9ja1VwZGF0ZWRSYXRpbmcgPSB7XG4gICAgICAgIGlkOiByYXRpbmdJZCxcbiAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgbXVzaWNpYW5JZDogJ211c2ljaWFuMTIzJyxcbiAgICAgICAgZXZlbnRDcmVhdG9ySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgcmF0aW5nOiA0LFxuICAgICAgICByZXZpZXc6ICdVcGRhdGVkIHJldmlldycsXG4gICAgICAgIGNhdGVnb3J5OiAnbXVzaWNpYW4nIGFzIGNvbnN0LFxuICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIGhlbHBmdWxDb3VudDogMCxcbiAgICAgICAgcmVwb3J0ZWRDb3VudDogMCxcbiAgICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBlbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBwYXJhbXM6IHsgcmF0aW5nSWQgfSxcbiAgICAgICAgYm9keTogdXBkYXRlRGF0YVxuICAgICAgfTtcblxuICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuZ2V0UmF0aW5nQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiByYXRpbmdJZCxcbiAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgbXVzaWNpYW5JZDogJ211c2ljaWFuMTIzJyxcbiAgICAgICAgZXZlbnRDcmVhdG9ySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgcmF0aW5nOiAzLFxuICAgICAgICByZXZpZXc6ICdPcmlnaW5hbCByZXZpZXcnLFxuICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgaGVscGZ1bENvdW50OiAwLFxuICAgICAgICByZXBvcnRlZENvdW50OiAwXG4gICAgICB9KTtcbiAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLnVwZGF0ZVJhdGluZy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBkYXRlZFJhdGluZyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci51cGRhdGVSYXRpbmcobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1JhdGluZ1NlcnZpY2UudXBkYXRlUmF0aW5nKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChyYXRpbmdJZCwgdXBkYXRlRGF0YSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JhdGluZyBhY3R1YWxpemFkbyBleGl0b3NhbWVudGUnLFxuICAgICAgICByYXRpbmc6IG1vY2tVcGRhdGVkUmF0aW5nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gcmF0aW5nIGlzIG91dCBvZiByYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHJhdGluZ0lkID0gJ3JhdGluZzEyMyc7XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICByYXRpbmc6IDYsIC8vIEludmFsaWQgcmF0aW5nXG4gICAgICAgIHJldmlldzogJ1VwZGF0ZWQgcmV2aWV3J1xuICAgICAgfTtcblxuICAgICAgY29uc3QgZXhpc3RpbmdSYXRpbmcgPSB7XG4gICAgICAgIGlkOiByYXRpbmdJZCxcbiAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgbXVzaWNpYW5JZDogJ211c2ljaWFuMTIzJyxcbiAgICAgICAgZXZlbnRDcmVhdG9ySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgcmF0aW5nOiA0LFxuICAgICAgICByZXZpZXc6ICdPcmlnaW5hbCByZXZpZXcnLFxuICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyBhcyBjb25zdCxcbiAgICAgICAgaXNWZXJpZmllZDogZmFsc2UsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICBoZWxwZnVsQ291bnQ6IDAsXG4gICAgICAgIHJlcG9ydGVkQ291bnQ6IDAsXG4gICAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgICAgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfSxcbiAgICAgICAgcGFyYW1zOiB7IHJhdGluZ0lkIH0sXG4gICAgICAgIGJvZHk6IHVwZGF0ZURhdGFcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmdldFJhdGluZ0J5SWQubW9ja1Jlc29sdmVkVmFsdWUoZXhpc3RpbmdSYXRpbmcpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIudXBkYXRlUmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdFbCByYXRpbmcgZGViZSBlc3RhciBlbnRyZSAxIHkgNSBlc3RyZWxsYXMnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21hcmtSYXRpbmdBc0hlbHBmdWwnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBtYXJrIHJhdGluZyBhcyBoZWxwZnVsIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHJhdGluZ0lkID0gJ3JhdGluZzEyMyc7XG4gICAgICBjb25zdCBtb2NrVXBkYXRlZFJhdGluZyA9IHtcbiAgICAgICAgaWQ6IHJhdGluZ0lkLFxuICAgICAgICBoZWxwZnVsQ291bnQ6IDUsXG4gICAgICAgIGlzSGVscGZ1bDogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyByYXRpbmdJZCB9XG4gICAgICB9O1xuXG4gICAgICBtb2NrUmF0aW5nU2VydmljZS5tYXJrUmF0aW5nQXNIZWxwZnVsLm1vY2tSZXNvbHZlZFZhbHVlKCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5tYXJrUmF0aW5nQXNIZWxwZnVsKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tSYXRpbmdTZXJ2aWNlLm1hcmtSYXRpbmdBc0hlbHBmdWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJhdGluZ0lkKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnUmF0aW5nIG1hcmNhZG8gY29tbyDDunRpbCBleGl0b3NhbWVudGUnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlcG9ydFJhdGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlcG9ydCByYXRpbmcgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcmF0aW5nSWQgPSAncmF0aW5nMTIzJztcbiAgICAgIGNvbnN0IHJlcG9ydERhdGEgPSB7XG4gICAgICAgIHJlYXNvbjogJ2luYXBwcm9wcmlhdGVfY29udGVudCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyByYXRpbmcgY29udGFpbnMgaW5hcHByb3ByaWF0ZSBjb250ZW50J1xuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyByYXRpbmdJZCB9LFxuICAgICAgICBib2R5OiByZXBvcnREYXRhXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmF0aW5nU2VydmljZS5yZXBvcnRSYXRpbmcubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLnJlcG9ydFJhdGluZyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrUmF0aW5nU2VydmljZS5yZXBvcnRSYXRpbmcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJhdGluZ0lkLCAnaW5hcHByb3ByaWF0ZV9jb250ZW50Jyk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JhdGluZyByZXBvcnRhZG8gZXhpdG9zYW1lbnRlJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBlcnJvciB3aGVuIHJlYXNvbiBpcyBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgcmF0aW5nSWQgPSAncmF0aW5nMTIzJztcbiAgICAgIGNvbnN0IHJlcG9ydERhdGEgPSB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyByYXRpbmcgY29udGFpbnMgaW5hcHByb3ByaWF0ZSBjb250ZW50J1xuICAgICAgICAvLyBNaXNzaW5nIHJlYXNvblxuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGVtYWlsOiAndXNlckBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyByYXRpbmdJZCB9LFxuICAgICAgICBib2R5OiByZXBvcnREYXRhXG4gICAgICB9O1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IHJhdGluZ0NvbnRyb2xsZXIucmVwb3J0UmF0aW5nKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdJRCBkZSByYXRpbmcgeSByYXrDs24gcmVxdWVyaWRvcydcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0RXZlbnRSYXRpbmdzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGV2ZW50IHJhdGluZ3Mgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXZlbnRJZCA9ICdldmVudDEyMyc7XG4gICAgICBjb25zdCBtb2NrUmF0aW5ncyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAncmF0aW5nMScsXG4gICAgICAgICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcbiAgICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyxcbiAgICAgICAgICBldmVudENyZWF0b3JJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHJhdGluZzogNSxcbiAgICAgICAgICByZXZpZXc6ICdHcmVhdCBwZXJmb3JtYW5jZScsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdtdXNpY2lhbicgYXMgY29uc3QsXG4gICAgICAgICAgaXNWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGhlbHBmdWxDb3VudDogMCxcbiAgICAgICAgICByZXBvcnRlZENvdW50OiAwLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHsgZXZlbnRJZCB9LFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIGNhdGVnb3J5OiAnbXVzaWNpYW4nLFxuICAgICAgICAgIG1pblJhdGluZzogJzQnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tSYXRpbmdTZXJ2aWNlLmdldEV2ZW50UmF0aW5ncy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmF0aW5ncyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5nZXRFdmVudFJhdGluZ3MobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1JhdGluZ1NlcnZpY2UuZ2V0RXZlbnRSYXRpbmdzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChldmVudElkKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnUmF0aW5ncyBkZWwgZXZlbnRvIG9idGVuaWRvcyBleGl0b3NhbWVudGUnLFxuICAgICAgICByYXRpbmdzOiBtb2NrUmF0aW5ncyxcbiAgICAgICAgY291bnQ6IG1vY2tSYXRpbmdzLmxlbmd0aFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRUb3BSYXRlZE11c2ljaWFucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0b3AgcmF0ZWQgbXVzaWNpYW5zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tNdXNpY2lhbnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VySWQ6ICdtdXNpY2lhbjEnLFxuICAgICAgICAgIHN0YXRzOiB7XG4gICAgICAgICAgICBhdmVyYWdlUmF0aW5nOiA0LjgsXG4gICAgICAgICAgICB0b3RhbFJhdGluZ3M6IDUwLFxuICAgICAgICAgICAgcmF0aW5nRGlzdHJpYnV0aW9uOiB7IDE6IDAsIDI6IDEsIDM6IDIsIDQ6IDE1LCA1OiAzMiB9LFxuICAgICAgICAgICAgcmVjZW50UmF0aW5nczogW10sXG4gICAgICAgICAgICB2ZXJpZmllZFJhdGluZ3M6IDQ1LFxuICAgICAgICAgICAgcmVzcG9uc2VSYXRlOiA5MC4wXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICBsaW1pdDogJzEwJyxcbiAgICAgICAgICBtaW5SYXRpbmdzOiAnNSdcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuZ2V0VG9wUmF0ZWRNdXNpY2lhbnMubW9ja1Jlc29sdmVkVmFsdWUobW9ja011c2ljaWFucyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5nZXRUb3BSYXRlZE11c2ljaWFucyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrUmF0aW5nU2VydmljZS5nZXRUb3BSYXRlZE11c2ljaWFucykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMTAsIDUpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdUb3AgbcO6c2ljb3Mgb2J0ZW5pZG9zIGV4aXRvc2FtZW50ZScsXG4gICAgICAgIG11c2ljaWFuczogbW9ja011c2ljaWFucyxcbiAgICAgICAgY291bnQ6IG1vY2tNdXNpY2lhbnMubGVuZ3RoXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFJhdGluZ1RyZW5kcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiByYXRpbmcgdHJlbmRzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tUcmVuZHMgPSB7XG4gICAgICAgIGF2ZXJhZ2VSYXRpbmdCeURheToge1xuICAgICAgICAgICcyMDI0LTAxLTAxJzogNC4yLFxuICAgICAgICAgICcyMDI0LTAxLTAyJzogNC41XG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsUmF0aW5nc0J5RGF5OiB7XG4gICAgICAgICAgJzIwMjQtMDEtMDEnOiAyNSxcbiAgICAgICAgICAnMjAyNC0wMS0wMic6IDMwXG4gICAgICAgIH0sXG4gICAgICAgIGNhdGVnb3J5RGlzdHJpYnV0aW9uOiB7XG4gICAgICAgICAgJ211c2ljaWFuJzogNjAsXG4gICAgICAgICAgJ2V2ZW50X2NyZWF0b3InOiA0MFxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICBwZXJpb2Q6ICdtb250aGx5JyxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBtb2NrUmF0aW5nU2VydmljZS5nZXRSYXRpbmdUcmVuZHMubW9ja1Jlc29sdmVkVmFsdWUobW9ja1RyZW5kcyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgcmF0aW5nQ29udHJvbGxlci5nZXRSYXRpbmdUcmVuZHMobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1JhdGluZ1NlcnZpY2UuZ2V0UmF0aW5nVHJlbmRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgzMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1RlbmRlbmNpYXMgZGUgcmF0aW5nIG9idGVuaWRhcyBleGl0b3NhbWVudGUnLFxuICAgICAgICB0cmVuZHM6IG1vY2tUcmVuZHNcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0TW9zdEhlbHBmdWxSYXRpbmdzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIG1vc3QgaGVscGZ1bCByYXRpbmdzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tSYXRpbmdzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdyYXRpbmcxJyxcbiAgICAgICAgICBldmVudElkOiAnZXZlbnQxJyxcbiAgICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyxcbiAgICAgICAgICBldmVudENyZWF0b3JJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHJhdGluZzogNSxcbiAgICAgICAgICByZXZpZXc6ICdWZXJ5IGhlbHBmdWwgcmV2aWV3JyxcbiAgICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJyBhcyBjb25zdCxcbiAgICAgICAgICBoZWxwZnVsQ291bnQ6IDEwLFxuICAgICAgICAgIGlzVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICByZXBvcnRlZENvdW50OiAwLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ211c2ljaWFuJ1xuICAgICAgICB9LFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIGxpbWl0OiAnNSdcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW9ja1JhdGluZ1NlcnZpY2UuZ2V0TW9zdEhlbHBmdWxSYXRpbmdzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRpbmdzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCByYXRpbmdDb250cm9sbGVyLmdldE1vc3RIZWxwZnVsUmF0aW5ncyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrUmF0aW5nU2VydmljZS5nZXRNb3N0SGVscGZ1bFJhdGluZ3MpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd1c2VyMTIzJywgJ211c2ljaWFuJywgNSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ1JhdGluZ3MgbcOhcyDDunRpbGVzIG9idGVuaWRvcyBleGl0b3NhbWVudGUnLFxuICAgICAgICByYXRpbmdzOiBtb2NrUmF0aW5ncyxcbiAgICAgICAgY291bnQ6IG1vY2tSYXRpbmdzLmxlbmd0aFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==