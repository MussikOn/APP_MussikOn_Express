0571c1cbd84f2f79a3587e461613680c
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the imagesModel
jest.mock('../models/imagesModel');
const imagesController_1 = require("../controllers/imagesController");
const mockImagesModel = require('../models/imagesModel');
describe('ImagesController', () => {
    let mockRequest;
    let mockResponse;
    let mockStatus;
    let mockJson;
    beforeEach(() => {
        mockStatus = jest.fn().mockReturnThis();
        mockJson = jest.fn().mockReturnThis();
        mockResponse = {
            status: mockStatus,
            json: mockJson
        };
        jest.clearAllMocks();
    });
    describe('uploadImageController', () => {
        it('should upload image successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            const mockFile = {
                fieldname: 'image',
                originalname: 'test.jpg',
                encoding: '7bit',
                mimetype: 'image/jpeg',
                buffer: Buffer.from('test image'),
                size: 1024,
                stream: {},
                destination: '',
                filename: 'test.jpg',
                path: ''
            };
            const mockUploadResult = {
                id: 'image-1',
                userId: 'user123',
                key: 'test-image-key',
                originalName: 'test.jpg',
                fileName: 'test.jpg',
                mimetype: 'image/jpeg',
                size: 1024,
                url: 'https://example.com/test.jpg',
                category: 'profile',
                isPublic: false,
                isActive: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            mockRequest = {
                user: {
                    userId: userId,
                    userEmail: userId,
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                file: mockFile,
                body: { category: 'profile' }
            };
            mockImagesModel.uploadImage.mockResolvedValue(mockUploadResult);
            // Act
            yield (0, imagesController_1.uploadImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.uploadImage).toHaveBeenCalledWith(mockFile, userId, 'profile', {
                description: '',
                tags: [],
                isPublic: true
            });
            expect(mockStatus).toHaveBeenCalledWith(201);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Imagen subida exitosamente',
                image: mockUploadResult
            });
        }));
        it('should return error when no file provided', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            mockRequest = {
                user: {
                    userId: userId,
                    userEmail: userId,
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                file: undefined,
                body: { category: 'profile' }
            };
            // Act
            yield (0, imagesController_1.uploadImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                error: 'No se proporcionó ningún archivo'
            });
        }));
        it('should return error when user is not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            mockRequest = {
                user: undefined,
                file: {
                    fieldname: 'image',
                    originalname: 'test.jpg',
                    encoding: '7bit',
                    mimetype: 'image/jpeg',
                    buffer: Buffer.from('test'),
                    size: 1024,
                    stream: {},
                    destination: '',
                    filename: 'test.jpg',
                    path: ''
                },
                body: { category: 'profile' }
            };
            // Act
            yield (0, imagesController_1.uploadImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(401);
            expect(mockJson).toHaveBeenCalledWith({
                error: 'Usuario no autenticado'
            });
        }));
        it('should handle service errors', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            const mockFile = {
                fieldname: 'image',
                originalname: 'test.jpg',
                encoding: '7bit',
                mimetype: 'image/jpeg',
                buffer: Buffer.from('test image'),
                size: 1024,
                stream: {},
                destination: '',
                filename: 'test.jpg',
                path: ''
            };
            mockRequest = {
                user: {
                    userId: userId,
                    userEmail: userId,
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                },
                file: mockFile,
                body: { category: 'profile' }
            };
            mockImagesModel.uploadImage.mockRejectedValue(new Error('Upload failed'));
            // Act
            yield (0, imagesController_1.uploadImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(500);
            expect(mockJson).toHaveBeenCalledWith({
                error: 'Error al subir imagen',
                details: 'Upload failed'
            });
        }));
    });
    describe('getImageByIdController', () => {
        it('should get image by id successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const imageId = 'image123';
            const mockImage = {
                id: imageId,
                userId: 'user123',
                key: 'test-image-key',
                originalName: 'test.jpg',
                fileName: 'test.jpg',
                mimetype: 'image/jpeg',
                size: 1024,
                url: 'https://example.com/test.jpg',
                category: 'profile',
                isPublic: false,
                isActive: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            mockRequest = {
                params: { imageId },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getImageById.mockResolvedValue(mockImage);
            // Act
            yield (0, imagesController_1.getImageByIdController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.getImageById).toHaveBeenCalledWith(imageId);
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                image: mockImage
            });
        }));
        it('should return 404 when image not found', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const imageId = 'nonexistent';
            mockRequest = {
                params: { imageId },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getImageById.mockResolvedValue(null);
            // Act
            yield (0, imagesController_1.getImageByIdController)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(404);
            expect(mockJson).toHaveBeenCalledWith({
                error: 'Imagen no encontrada'
            });
        }));
    });
    describe('listImagesController', () => {
        it('should list images successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const mockImages = [
                {
                    id: 'image1',
                    userId: 'user123',
                    key: 'image1-key',
                    originalName: 'image1.jpg',
                    fileName: 'image1.jpg',
                    mimetype: 'image/jpeg',
                    size: 1024,
                    url: 'https://example.com/image1.jpg',
                    category: 'profile',
                    isPublic: false,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                },
                {
                    id: 'image2',
                    userId: 'user123',
                    key: 'image2-key',
                    originalName: 'image2.jpg',
                    fileName: 'image2.jpg',
                    mimetype: 'image/jpeg',
                    size: 2048,
                    url: 'https://example.com/image2.jpg',
                    category: 'post',
                    isPublic: true,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            mockRequest = {
                query: { page: '1', limit: '10' },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.listImages.mockResolvedValue({
                images: mockImages,
                total: 2,
                page: 1,
                totalPages: 1,
                hasNext: false,
                hasPrev: false
            });
            // Act
            yield (0, imagesController_1.listImagesController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.listImages).toHaveBeenCalledWith({
                limit: 10
            });
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                images: {
                    images: mockImages,
                    total: 2,
                    page: 1,
                    totalPages: 1,
                    hasNext: false,
                    hasPrev: false
                },
                total: undefined,
                filters: {
                    limit: 10
                }
            });
        }));
    });
    describe('updateImageController', () => {
        it('should update image successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const imageId = 'image123';
            const updateData = {
                description: 'Updated description',
                tags: ['tag1', 'tag2'],
                isPublic: false
            };
            const mockUpdatedImage = Object.assign({ id: imageId, userId: 'user123', key: 'test-image-key', originalName: 'test.jpg', fileName: 'test.jpg', mimetype: 'image/jpeg', size: 1024, url: 'https://example.com/test.jpg', category: 'profile', isActive: true, createdAt: new Date().toISOString(), updatedAt: new Date().toISOString() }, updateData);
            mockRequest = {
                params: { imageId },
                body: updateData,
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getImageById.mockResolvedValue({
                id: imageId,
                userId: 'user123',
                key: 'test-image-key',
                originalName: 'test.jpg',
                fileName: 'test.jpg',
                mimetype: 'image/jpeg',
                size: 1024,
                url: 'https://example.com/test.jpg',
                category: 'profile',
                isActive: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            });
            mockImagesModel.updateImage.mockResolvedValue(mockUpdatedImage);
            // Act
            yield (0, imagesController_1.updateImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.updateImage).toHaveBeenCalledWith(imageId, updateData);
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Imagen actualizada exitosamente',
                image: mockUpdatedImage
            });
        }));
    });
    describe('deleteImageController', () => {
        it('should delete image successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const imageId = 'image123';
            mockRequest = {
                params: { imageId },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.deleteImage.mockResolvedValue(true);
            // Act
            yield (0, imagesController_1.deleteImageController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.deleteImage).toHaveBeenCalledWith(imageId, 'user123');
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                message: 'Imagen eliminada exitosamente'
            });
        }));
    });
    describe('getImageStatsController', () => {
        it('should get image stats successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const mockStats = {
                totalImages: 100,
                totalSize: 1024000,
                averageSize: 10240,
                imagesByCategory: {
                    profile: 20,
                    post: 30,
                    event: 25,
                    gallery: 25
                },
                imagesByUser: { 'user123': 50, 'user456': 50 },
                recentUploads: [{
                        id: 'image1',
                        userId: 'user123',
                        key: 'image1-key',
                        originalName: 'image1.jpg',
                        fileName: 'image1.jpg',
                        mimetype: 'image/jpeg',
                        size: 1024,
                        url: 'https://example.com/image1.jpg',
                        category: 'profile',
                        isPublic: false,
                        isActive: true,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    }]
            };
            mockRequest = {
                user: {
                    userId: 'admin123',
                    userEmail: 'admin123',
                    email: 'admin@example.com',
                    role: 'adminSenior',
                    roll: 'adminSenior',
                    name: 'Admin User'
                }
            };
            mockImagesModel.getImageStats.mockResolvedValue(mockStats);
            // Act
            yield (0, imagesController_1.getImageStatsController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.getImageStats).toHaveBeenCalled();
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                stats: mockStats
            });
        }));
    });
    describe('getUserProfileImagesController', () => {
        it('should get user profile images successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userId = 'user123';
            const mockImages = [
                {
                    id: 'image1',
                    userId: 'user123',
                    key: 'image1-key',
                    originalName: 'image1.jpg',
                    fileName: 'image1.jpg',
                    mimetype: 'image/jpeg',
                    size: 1024,
                    url: 'https://example.com/image1.jpg',
                    category: 'profile',
                    isPublic: false,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            mockRequest = {
                params: { userId },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getUserProfileImages.mockResolvedValue(mockImages);
            // Act
            yield (0, imagesController_1.getUserProfileImagesController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.getUserProfileImages).toHaveBeenCalledWith(userId);
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                images: mockImages
            });
        }));
    });
    describe('getPostImagesController', () => {
        it('should get post images successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const postId = 'post123';
            const mockImages = [
                {
                    id: 'image1',
                    userId: 'user123',
                    key: 'image1-key',
                    originalName: 'image1.jpg',
                    fileName: 'image1.jpg',
                    mimetype: 'image/jpeg',
                    size: 1024,
                    url: 'https://example.com/image1.jpg',
                    category: 'post',
                    isPublic: true,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            mockRequest = {
                query: { userId: 'user123' },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getPostImages.mockResolvedValue(mockImages);
            // Act
            yield (0, imagesController_1.getPostImagesController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.getPostImages).toHaveBeenCalledWith('user123');
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                images: mockImages
            });
        }));
    });
    describe('getEventImagesController', () => {
        it('should get event images successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const eventId = 'event123';
            const mockImages = [
                {
                    id: 'image1',
                    userId: 'user123',
                    key: 'image1-key',
                    originalName: 'image1.jpg',
                    fileName: 'image1.jpg',
                    mimetype: 'image/jpeg',
                    size: 1024,
                    url: 'https://example.com/image1.jpg',
                    category: 'event',
                    isPublic: true,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            mockRequest = {
                query: { eventId },
                user: {
                    userId: 'user123',
                    userEmail: 'user123',
                    email: 'test@example.com',
                    role: 'user',
                    name: 'Test User'
                }
            };
            mockImagesModel.getEventImages.mockResolvedValue(mockImages);
            // Act
            yield (0, imagesController_1.getEventImagesController)(mockRequest, mockResponse);
            // Assert
            expect(mockImagesModel.getEventImages).toHaveBeenCalledWith(eventId);
            expect(mockStatus).toHaveBeenCalledWith(200);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                images: mockImages
            });
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGltYWdlc0NvbnRyb2xsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWNBLHVCQUF1QjtBQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFkbkMsc0VBVXlDO0FBS3pDLE1BQU0sZUFBZSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0FBRXpELFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDaEMsSUFBSSxXQUE2QixDQUFDO0lBQ2xDLElBQUksWUFBK0IsQ0FBQztJQUNwQyxJQUFJLFVBQXFCLENBQUM7SUFDMUIsSUFBSSxRQUFtQixDQUFDO0lBRXhCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3hDLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdEMsWUFBWSxHQUFHO1lBQ2IsTUFBTSxFQUFFLFVBQVU7WUFDbEIsSUFBSSxFQUFFLFFBQVE7U0FDZixDQUFDO1FBQ0YsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtRQUNyQyxFQUFFLENBQUMsa0NBQWtDLEVBQUUsR0FBUyxFQUFFO1lBQ2hELFVBQVU7WUFDVixNQUFNLE1BQU0sR0FBRyxTQUFTLENBQUM7WUFDekIsTUFBTSxRQUFRLEdBQUc7Z0JBQ2YsU0FBUyxFQUFFLE9BQU87Z0JBQ2xCLFlBQVksRUFBRSxVQUFVO2dCQUN4QixRQUFRLEVBQUUsTUFBTTtnQkFDaEIsUUFBUSxFQUFFLFlBQVk7Z0JBQ3RCLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztnQkFDakMsSUFBSSxFQUFFLElBQUk7Z0JBQ1YsTUFBTSxFQUFFLEVBQVM7Z0JBQ2pCLFdBQVcsRUFBRSxFQUFFO2dCQUNmLFFBQVEsRUFBRSxVQUFVO2dCQUNwQixJQUFJLEVBQUUsRUFBRTthQUNULENBQUM7WUFFRixNQUFNLGdCQUFnQixHQUFHO2dCQUN2QixFQUFFLEVBQUUsU0FBUztnQkFDYixNQUFNLEVBQUUsU0FBUztnQkFDakIsR0FBRyxFQUFFLGdCQUFnQjtnQkFDckIsWUFBWSxFQUFFLFVBQVU7Z0JBQ3hCLFFBQVEsRUFBRSxVQUFVO2dCQUNwQixRQUFRLEVBQUUsWUFBWTtnQkFDdEIsSUFBSSxFQUFFLElBQUk7Z0JBQ1YsR0FBRyxFQUFFLDhCQUE4QjtnQkFDbkMsUUFBUSxFQUFFLFNBQWtCO2dCQUM1QixRQUFRLEVBQUUsS0FBSztnQkFDZixRQUFRLEVBQUUsSUFBSTtnQkFDZCxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7Z0JBQ25DLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTthQUNwQyxDQUFDO1lBRUYsV0FBVyxHQUFHO2dCQUNaLElBQUksRUFBRTtvQkFDSixNQUFNLEVBQUUsTUFBTTtvQkFDZCxTQUFTLEVBQUUsTUFBTTtvQkFDakIsS0FBSyxFQUFFLGtCQUFrQjtvQkFDekIsSUFBSSxFQUFFLE1BQU07b0JBQ1osSUFBSSxFQUFFLFdBQVc7aUJBQ2xCO2dCQUNELElBQUksRUFBRSxRQUFRO2dCQUNkLElBQUksRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUU7YUFDOUIsQ0FBQztZQUVGLGVBQWUsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUVoRSxNQUFNO1lBQ04sTUFBTSxJQUFBLHdDQUFxQixFQUFDLFdBQXNCLEVBQUUsWUFBd0IsQ0FBQyxDQUFDO1lBRTlFLFNBQVM7WUFDVCxNQUFNLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFO2dCQUNwRixXQUFXLEVBQUUsRUFBRTtnQkFDZixJQUFJLEVBQUUsRUFBRTtnQkFDUixRQUFRLEVBQUUsSUFBSTthQUNmLENBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BDLE9BQU8sRUFBRSxJQUFJO2dCQUNiLE9BQU8sRUFBRSw0QkFBNEI7Z0JBQ3JDLEtBQUssRUFBRSxnQkFBZ0I7YUFDeEIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxHQUFTLEVBQUU7WUFDekQsVUFBVTtZQUNWLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQztZQUN6QixXQUFXLEdBQUc7Z0JBQ1osSUFBSSxFQUFFO29CQUNKLE1BQU0sRUFBRSxNQUFNO29CQUNkLFNBQVMsRUFBRSxNQUFNO29CQUNqQixLQUFLLEVBQUUsa0JBQWtCO29CQUN6QixJQUFJLEVBQUUsTUFBTTtvQkFDWixJQUFJLEVBQUUsV0FBVztpQkFDbEI7Z0JBQ0QsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsSUFBSSxFQUFFLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRTthQUM5QixDQUFDO1lBRUYsTUFBTTtZQUNOLE1BQU0sSUFBQSx3Q0FBcUIsRUFBQyxXQUFzQixFQUFFLFlBQXdCLENBQUMsQ0FBQztZQUU5RSxTQUFTO1lBQ1QsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDcEMsS0FBSyxFQUFFLGtDQUFrQzthQUMxQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9EQUFvRCxFQUFFLEdBQVMsRUFBRTtZQUNsRSxVQUFVO1lBQ1YsV0FBVyxHQUFHO2dCQUNaLElBQUksRUFBRSxTQUFTO2dCQUNmLElBQUksRUFBRTtvQkFDSixTQUFTLEVBQUUsT0FBTztvQkFDbEIsWUFBWSxFQUFFLFVBQVU7b0JBQ3hCLFFBQVEsRUFBRSxNQUFNO29CQUNoQixRQUFRLEVBQUUsWUFBWTtvQkFDdEIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO29CQUMzQixJQUFJLEVBQUUsSUFBSTtvQkFDVixNQUFNLEVBQUUsRUFBUztvQkFDakIsV0FBVyxFQUFFLEVBQUU7b0JBQ2YsUUFBUSxFQUFFLFVBQVU7b0JBQ3BCLElBQUksRUFBRSxFQUFFO2lCQUNUO2dCQUNELElBQUksRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUU7YUFDOUIsQ0FBQztZQUVGLE1BQU07WUFDTixNQUFNLElBQUEsd0NBQXFCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFOUUsU0FBUztZQUNULE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BDLEtBQUssRUFBRSx3QkFBd0I7YUFDaEMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxHQUFTLEVBQUU7WUFDNUMsVUFBVTtZQUNWLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQztZQUN6QixNQUFNLFFBQVEsR0FBRztnQkFDZixTQUFTLEVBQUUsT0FBTztnQkFDbEIsWUFBWSxFQUFFLFVBQVU7Z0JBQ3hCLFFBQVEsRUFBRSxNQUFNO2dCQUNoQixRQUFRLEVBQUUsWUFBWTtnQkFDdEIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO2dCQUNqQyxJQUFJLEVBQUUsSUFBSTtnQkFDVixNQUFNLEVBQUUsRUFBUztnQkFDakIsV0FBVyxFQUFFLEVBQUU7Z0JBQ2YsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLElBQUksRUFBRSxFQUFFO2FBQ1QsQ0FBQztZQUVGLFdBQVcsR0FBRztnQkFDWixJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLE1BQU07b0JBQ2QsU0FBUyxFQUFFLE1BQU07b0JBQ2pCLEtBQUssRUFBRSxrQkFBa0I7b0JBQ3pCLElBQUksRUFBRSxNQUFNO29CQUNaLElBQUksRUFBRSxXQUFXO2lCQUNsQjtnQkFDRCxJQUFJLEVBQUUsUUFBUTtnQkFDZCxJQUFJLEVBQUUsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFO2FBQzlCLENBQUM7WUFFRixlQUFlLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7WUFFMUUsTUFBTTtZQUNOLE1BQU0sSUFBQSx3Q0FBcUIsRUFBQyxXQUFzQixFQUFFLFlBQXdCLENBQUMsQ0FBQztZQUU5RSxTQUFTO1lBQ1QsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDcEMsS0FBSyxFQUFFLHVCQUF1QjtnQkFDOUIsT0FBTyxFQUFFLGVBQWU7YUFDekIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtRQUN0QyxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBUyxFQUFFO1lBQ25ELFVBQVU7WUFDVixNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUM7WUFDM0IsTUFBTSxTQUFTLEdBQUc7Z0JBQ2hCLEVBQUUsRUFBRSxPQUFPO2dCQUNYLE1BQU0sRUFBRSxTQUFTO2dCQUNqQixHQUFHLEVBQUUsZ0JBQWdCO2dCQUNyQixZQUFZLEVBQUUsVUFBVTtnQkFDeEIsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLFFBQVEsRUFBRSxZQUFZO2dCQUN0QixJQUFJLEVBQUUsSUFBSTtnQkFDVixHQUFHLEVBQUUsOEJBQThCO2dCQUNuQyxRQUFRLEVBQUUsU0FBa0I7Z0JBQzVCLFFBQVEsRUFBRSxLQUFLO2dCQUNmLFFBQVEsRUFBRSxJQUFJO2dCQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtnQkFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2FBQ3BDLENBQUM7WUFFRixXQUFXLEdBQUc7Z0JBQ1osTUFBTSxFQUFFLEVBQUUsT0FBTyxFQUFFO2dCQUNuQixJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLFNBQVMsRUFBRSxTQUFTO29CQUNwQixLQUFLLEVBQUUsa0JBQWtCO29CQUN6QixJQUFJLEVBQUUsTUFBTTtvQkFDWixJQUFJLEVBQUUsV0FBVztpQkFDbEI7YUFDRixDQUFDO1lBRUYsZUFBZSxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUUxRCxNQUFNO1lBQ04sTUFBTSxJQUFBLHlDQUFzQixFQUFDLFdBQXNCLEVBQUUsWUFBd0IsQ0FBQyxDQUFDO1lBRS9FLFNBQVM7WUFDVCxNQUFNLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ25FLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BDLE9BQU8sRUFBRSxJQUFJO2dCQUNiLEtBQUssRUFBRSxTQUFTO2FBQ2pCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQSxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0NBQXdDLEVBQUUsR0FBUyxFQUFFO1lBQ3RELFVBQVU7WUFDVixNQUFNLE9BQU8sR0FBRyxhQUFhLENBQUM7WUFDOUIsV0FBVyxHQUFHO2dCQUNaLE1BQU0sRUFBRSxFQUFFLE9BQU8sRUFBRTtnQkFDbkIsSUFBSSxFQUFFO29CQUNKLE1BQU0sRUFBRSxTQUFTO29CQUNqQixTQUFTLEVBQUUsU0FBUztvQkFDcEIsS0FBSyxFQUFFLGtCQUFrQjtvQkFDekIsSUFBSSxFQUFFLE1BQU07b0JBQ1osSUFBSSxFQUFFLFdBQVc7aUJBQ2xCO2FBQ0YsQ0FBQztZQUVGLGVBQWUsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFckQsTUFBTTtZQUNOLE1BQU0sSUFBQSx5Q0FBc0IsRUFBQyxXQUFzQixFQUFFLFlBQXdCLENBQUMsQ0FBQztZQUUvRSxTQUFTO1lBQ1QsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDcEMsS0FBSyxFQUFFLHNCQUFzQjthQUM5QixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO1FBQ3BDLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFTLEVBQUU7WUFDL0MsVUFBVTtZQUNWLE1BQU0sVUFBVSxHQUFHO2dCQUNqQjtvQkFDRSxFQUFFLEVBQUUsUUFBUTtvQkFDWixNQUFNLEVBQUUsU0FBUztvQkFDakIsR0FBRyxFQUFFLFlBQVk7b0JBQ2pCLFlBQVksRUFBRSxZQUFZO29CQUMxQixRQUFRLEVBQUUsWUFBWTtvQkFDdEIsUUFBUSxFQUFFLFlBQVk7b0JBQ3RCLElBQUksRUFBRSxJQUFJO29CQUNWLEdBQUcsRUFBRSxnQ0FBZ0M7b0JBQ3JDLFFBQVEsRUFBRSxTQUFrQjtvQkFDNUIsUUFBUSxFQUFFLEtBQUs7b0JBQ2YsUUFBUSxFQUFFLElBQUk7b0JBQ2QsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO29CQUNuQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7aUJBQ3BDO2dCQUNEO29CQUNFLEVBQUUsRUFBRSxRQUFRO29CQUNaLE1BQU0sRUFBRSxTQUFTO29CQUNqQixHQUFHLEVBQUUsWUFBWTtvQkFDakIsWUFBWSxFQUFFLFlBQVk7b0JBQzFCLFFBQVEsRUFBRSxZQUFZO29CQUN0QixRQUFRLEVBQUUsWUFBWTtvQkFDdEIsSUFBSSxFQUFFLElBQUk7b0JBQ1YsR0FBRyxFQUFFLGdDQUFnQztvQkFDckMsUUFBUSxFQUFFLE1BQWU7b0JBQ3pCLFFBQVEsRUFBRSxJQUFJO29CQUNkLFFBQVEsRUFBRSxJQUFJO29CQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtvQkFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2lCQUNwQzthQUNGLENBQUM7WUFFRixXQUFXLEdBQUc7Z0JBQ1osS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFO2dCQUNqQyxJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLFNBQVMsRUFBRSxTQUFTO29CQUNwQixLQUFLLEVBQUUsa0JBQWtCO29CQUN6QixJQUFJLEVBQUUsTUFBTTtvQkFDWixJQUFJLEVBQUUsV0FBVztpQkFDbEI7YUFDRixDQUFDO1lBRUYsZUFBZSxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDM0MsTUFBTSxFQUFFLFVBQVU7Z0JBQ2xCLEtBQUssRUFBRSxDQUFDO2dCQUNSLElBQUksRUFBRSxDQUFDO2dCQUNQLFVBQVUsRUFBRSxDQUFDO2dCQUNiLE9BQU8sRUFBRSxLQUFLO2dCQUNkLE9BQU8sRUFBRSxLQUFLO2FBQ2YsQ0FBQyxDQUFDO1lBRUgsTUFBTTtZQUNOLE1BQU0sSUFBQSx1Q0FBb0IsRUFBQyxXQUFzQixFQUFFLFlBQXdCLENBQUMsQ0FBQztZQUU3RSxTQUFTO1lBQ1QsTUFBTSxDQUFDLGVBQWUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDdEQsS0FBSyxFQUFFLEVBQUU7YUFDVixDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNwQyxPQUFPLEVBQUUsSUFBSTtnQkFDYixNQUFNLEVBQUU7b0JBQ04sTUFBTSxFQUFFLFVBQVU7b0JBQ2xCLEtBQUssRUFBRSxDQUFDO29CQUNSLElBQUksRUFBRSxDQUFDO29CQUNQLFVBQVUsRUFBRSxDQUFDO29CQUNiLE9BQU8sRUFBRSxLQUFLO29CQUNkLE9BQU8sRUFBRSxLQUFLO2lCQUNmO2dCQUNELEtBQUssRUFBRSxTQUFTO2dCQUNoQixPQUFPLEVBQUU7b0JBQ1AsS0FBSyxFQUFFLEVBQUU7aUJBQ1Y7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFO1FBQ3JDLEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFTLEVBQUU7WUFDaEQsVUFBVTtZQUNWLE1BQU0sT0FBTyxHQUFHLFVBQVUsQ0FBQztZQUMzQixNQUFNLFVBQVUsR0FBRztnQkFDakIsV0FBVyxFQUFFLHFCQUFxQjtnQkFDbEMsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQztnQkFDdEIsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQztZQUVGLE1BQU0sZ0JBQWdCLG1CQUNwQixFQUFFLEVBQUUsT0FBTyxFQUNYLE1BQU0sRUFBRSxTQUFTLEVBQ2pCLEdBQUcsRUFBRSxnQkFBZ0IsRUFDckIsWUFBWSxFQUFFLFVBQVUsRUFDeEIsUUFBUSxFQUFFLFVBQVUsRUFDcEIsUUFBUSxFQUFFLFlBQVksRUFDdEIsSUFBSSxFQUFFLElBQUksRUFDVixHQUFHLEVBQUUsOEJBQThCLEVBQ25DLFFBQVEsRUFBRSxTQUFrQixFQUM1QixRQUFRLEVBQUUsSUFBSSxFQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUNuQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsSUFDaEMsVUFBVSxDQUNkLENBQUM7WUFFRixXQUFXLEdBQUc7Z0JBQ1osTUFBTSxFQUFFLEVBQUUsT0FBTyxFQUFFO2dCQUNuQixJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFO29CQUNKLE1BQU0sRUFBRSxTQUFTO29CQUNqQixTQUFTLEVBQUUsU0FBUztvQkFDcEIsS0FBSyxFQUFFLGtCQUFrQjtvQkFDekIsSUFBSSxFQUFFLE1BQU07b0JBQ1osSUFBSSxFQUFFLFdBQVc7aUJBQ2xCO2FBQ0YsQ0FBQztZQUVGLGVBQWUsQ0FBQyxZQUFZLENBQUMsaUJBQWlCLENBQUM7Z0JBQzdDLEVBQUUsRUFBRSxPQUFPO2dCQUNYLE1BQU0sRUFBRSxTQUFTO2dCQUNqQixHQUFHLEVBQUUsZ0JBQWdCO2dCQUNyQixZQUFZLEVBQUUsVUFBVTtnQkFDeEIsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLFFBQVEsRUFBRSxZQUFZO2dCQUN0QixJQUFJLEVBQUUsSUFBSTtnQkFDVixHQUFHLEVBQUUsOEJBQThCO2dCQUNuQyxRQUFRLEVBQUUsU0FBa0I7Z0JBQzVCLFFBQVEsRUFBRSxJQUFJO2dCQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtnQkFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2FBQ3BDLENBQUMsQ0FBQztZQUNILGVBQWUsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUVoRSxNQUFNO1lBQ04sTUFBTSxJQUFBLHdDQUFxQixFQUFDLFdBQXNCLEVBQUUsWUFBd0IsQ0FBQyxDQUFDO1lBRTlFLFNBQVM7WUFDVCxNQUFNLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsQ0FBQztZQUM5RSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNwQyxPQUFPLEVBQUUsSUFBSTtnQkFDYixPQUFPLEVBQUUsaUNBQWlDO2dCQUMxQyxLQUFLLEVBQUUsZ0JBQWdCO2FBQ3hCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLEVBQUU7UUFDckMsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLEdBQVMsRUFBRTtZQUNoRCxVQUFVO1lBQ1YsTUFBTSxPQUFPLEdBQUcsVUFBVSxDQUFDO1lBQzNCLFdBQVcsR0FBRztnQkFDWixNQUFNLEVBQUUsRUFBRSxPQUFPLEVBQUU7Z0JBQ25CLElBQUksRUFBRTtvQkFDSixNQUFNLEVBQUUsU0FBUztvQkFDakIsU0FBUyxFQUFFLFNBQVM7b0JBQ3BCLEtBQUssRUFBRSxrQkFBa0I7b0JBQ3pCLElBQUksRUFBRSxNQUFNO29CQUNaLElBQUksRUFBRSxXQUFXO2lCQUNsQjthQUNGLENBQUM7WUFFRixlQUFlLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBRXBELE1BQU07WUFDTixNQUFNLElBQUEsd0NBQXFCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFOUUsU0FBUztZQUNULE1BQU0sQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUMsb0JBQW9CLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQzdFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BDLE9BQU8sRUFBRSxJQUFJO2dCQUNiLE9BQU8sRUFBRSwrQkFBK0I7YUFDekMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBUyxFQUFFO1lBQ25ELFVBQVU7WUFDVixNQUFNLFNBQVMsR0FBRztnQkFDaEIsV0FBVyxFQUFFLEdBQUc7Z0JBQ2hCLFNBQVMsRUFBRSxPQUFPO2dCQUNsQixXQUFXLEVBQUUsS0FBSztnQkFDbEIsZ0JBQWdCLEVBQUU7b0JBQ2hCLE9BQU8sRUFBRSxFQUFFO29CQUNYLElBQUksRUFBRSxFQUFFO29CQUNSLEtBQUssRUFBRSxFQUFFO29CQUNULE9BQU8sRUFBRSxFQUFFO2lCQUNaO2dCQUNELFlBQVksRUFBRSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRTtnQkFDOUMsYUFBYSxFQUFFLENBQUM7d0JBQ2QsRUFBRSxFQUFFLFFBQVE7d0JBQ1osTUFBTSxFQUFFLFNBQVM7d0JBQ2pCLEdBQUcsRUFBRSxZQUFZO3dCQUNqQixZQUFZLEVBQUUsWUFBWTt3QkFDMUIsUUFBUSxFQUFFLFlBQVk7d0JBQ3RCLFFBQVEsRUFBRSxZQUFZO3dCQUN0QixJQUFJLEVBQUUsSUFBSTt3QkFDVixHQUFHLEVBQUUsZ0NBQWdDO3dCQUNyQyxRQUFRLEVBQUUsU0FBa0I7d0JBQzVCLFFBQVEsRUFBRSxLQUFLO3dCQUNmLFFBQVEsRUFBRSxJQUFJO3dCQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTt3QkFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO3FCQUNwQyxDQUFDO2FBQ0gsQ0FBQztZQUVGLFdBQVcsR0FBRztnQkFDWixJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLFVBQVU7b0JBQ2xCLFNBQVMsRUFBRSxVQUFVO29CQUNyQixLQUFLLEVBQUUsbUJBQW1CO29CQUMxQixJQUFJLEVBQUUsYUFBYTtvQkFDbkIsSUFBSSxFQUFFLGFBQWE7b0JBQ25CLElBQUksRUFBRSxZQUFZO2lCQUNuQjthQUNGLENBQUM7WUFFRixlQUFlLENBQUMsYUFBYSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRTNELE1BQU07WUFDTixNQUFNLElBQUEsMENBQXVCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFaEYsU0FBUztZQUNULE1BQU0sQ0FBQyxlQUFlLENBQUMsYUFBYSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUN6RCxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNwQyxPQUFPLEVBQUUsSUFBSTtnQkFDYixLQUFLLEVBQUUsU0FBUzthQUNqQixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1FBQzlDLEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFTLEVBQUU7WUFDM0QsVUFBVTtZQUNWLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQztZQUN6QixNQUFNLFVBQVUsR0FBRztnQkFDakI7b0JBQ0UsRUFBRSxFQUFFLFFBQVE7b0JBQ1osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLEdBQUcsRUFBRSxZQUFZO29CQUNqQixZQUFZLEVBQUUsWUFBWTtvQkFDMUIsUUFBUSxFQUFFLFlBQVk7b0JBQ3RCLFFBQVEsRUFBRSxZQUFZO29CQUN0QixJQUFJLEVBQUUsSUFBSTtvQkFDVixHQUFHLEVBQUUsZ0NBQWdDO29CQUNyQyxRQUFRLEVBQUUsU0FBa0I7b0JBQzVCLFFBQVEsRUFBRSxLQUFLO29CQUNmLFFBQVEsRUFBRSxJQUFJO29CQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtvQkFDbkMsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO2lCQUNwQzthQUNGLENBQUM7WUFFRixXQUFXLEdBQUc7Z0JBQ1osTUFBTSxFQUFFLEVBQUUsTUFBTSxFQUFFO2dCQUNsQixJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLFNBQVMsRUFBRSxTQUFTO29CQUNwQixLQUFLLEVBQUUsa0JBQWtCO29CQUN6QixJQUFJLEVBQUUsTUFBTTtvQkFDWixJQUFJLEVBQUUsV0FBVztpQkFDbEI7YUFDRixDQUFDO1lBRUYsZUFBZSxDQUFDLG9CQUFvQixDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRW5FLE1BQU07WUFDTixNQUFNLElBQUEsaURBQThCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFdkYsU0FBUztZQUNULE1BQU0sQ0FBQyxlQUFlLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMxRSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDO2dCQUNwQyxPQUFPLEVBQUUsSUFBSTtnQkFDYixNQUFNLEVBQUUsVUFBVTthQUNuQixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRSxHQUFTLEVBQUU7WUFDbkQsVUFBVTtZQUNWLE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQztZQUN6QixNQUFNLFVBQVUsR0FBRztnQkFDakI7b0JBQ0UsRUFBRSxFQUFFLFFBQVE7b0JBQ1osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLEdBQUcsRUFBRSxZQUFZO29CQUNqQixZQUFZLEVBQUUsWUFBWTtvQkFDMUIsUUFBUSxFQUFFLFlBQVk7b0JBQ3RCLFFBQVEsRUFBRSxZQUFZO29CQUN0QixJQUFJLEVBQUUsSUFBSTtvQkFDVixHQUFHLEVBQUUsZ0NBQWdDO29CQUNyQyxRQUFRLEVBQUUsTUFBZTtvQkFDekIsUUFBUSxFQUFFLElBQUk7b0JBQ2QsUUFBUSxFQUFFLElBQUk7b0JBQ2QsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO29CQUNuQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7aUJBQ3BDO2FBQ0YsQ0FBQztZQUVGLFdBQVcsR0FBRztnQkFDWixLQUFLLEVBQUUsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFO2dCQUM1QixJQUFJLEVBQUU7b0JBQ0osTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLFNBQVMsRUFBRSxTQUFTO29CQUNwQixLQUFLLEVBQUUsa0JBQWtCO29CQUN6QixJQUFJLEVBQUUsTUFBTTtvQkFDWixJQUFJLEVBQUUsV0FBVztpQkFDbEI7YUFDRixDQUFDO1lBRUYsZUFBZSxDQUFDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUU1RCxNQUFNO1lBQ04sTUFBTSxJQUFBLDBDQUF1QixFQUFDLFdBQXNCLEVBQUUsWUFBd0IsQ0FBQyxDQUFDO1lBRWhGLFNBQVM7WUFDVCxNQUFNLENBQUMsZUFBZSxDQUFDLGFBQWEsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3RFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsb0JBQW9CLENBQUM7Z0JBQ3BDLE9BQU8sRUFBRSxJQUFJO2dCQUNiLE1BQU0sRUFBRSxVQUFVO2FBQ25CLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7UUFDeEMsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEdBQVMsRUFBRTtZQUNwRCxVQUFVO1lBQ1YsTUFBTSxPQUFPLEdBQUcsVUFBVSxDQUFDO1lBQzNCLE1BQU0sVUFBVSxHQUFHO2dCQUNqQjtvQkFDRSxFQUFFLEVBQUUsUUFBUTtvQkFDWixNQUFNLEVBQUUsU0FBUztvQkFDakIsR0FBRyxFQUFFLFlBQVk7b0JBQ2pCLFlBQVksRUFBRSxZQUFZO29CQUMxQixRQUFRLEVBQUUsWUFBWTtvQkFDdEIsUUFBUSxFQUFFLFlBQVk7b0JBQ3RCLElBQUksRUFBRSxJQUFJO29CQUNWLEdBQUcsRUFBRSxnQ0FBZ0M7b0JBQ3JDLFFBQVEsRUFBRSxPQUFnQjtvQkFDMUIsUUFBUSxFQUFFLElBQUk7b0JBQ2QsUUFBUSxFQUFFLElBQUk7b0JBQ2QsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO29CQUNuQyxTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7aUJBQ3BDO2FBQ0YsQ0FBQztZQUVGLFdBQVcsR0FBRztnQkFDWixLQUFLLEVBQUUsRUFBRSxPQUFPLEVBQUU7Z0JBQ2xCLElBQUksRUFBRTtvQkFDSixNQUFNLEVBQUUsU0FBUztvQkFDakIsU0FBUyxFQUFFLFNBQVM7b0JBQ3BCLEtBQUssRUFBRSxrQkFBa0I7b0JBQ3pCLElBQUksRUFBRSxNQUFNO29CQUNaLElBQUksRUFBRSxXQUFXO2lCQUNsQjthQUNGLENBQUM7WUFFRixlQUFlLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRTdELE1BQU07WUFDTixNQUFNLElBQUEsMkNBQXdCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFakYsU0FBUztZQUNULE1BQU0sQ0FBQyxlQUFlLENBQUMsY0FBYyxDQUFDLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzdDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDcEMsT0FBTyxFQUFFLElBQUk7Z0JBQ2IsTUFBTSxFQUFFLFVBQVU7YUFDbkIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBT0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGltYWdlc0NvbnRyb2xsZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgXG4gIHVwbG9hZEltYWdlQ29udHJvbGxlcixcbiAgZ2V0SW1hZ2VCeUlkQ29udHJvbGxlcixcbiAgbGlzdEltYWdlc0NvbnRyb2xsZXIsXG4gIHVwZGF0ZUltYWdlQ29udHJvbGxlcixcbiAgZGVsZXRlSW1hZ2VDb250cm9sbGVyLFxuICBnZXRJbWFnZVN0YXRzQ29udHJvbGxlcixcbiAgZ2V0VXNlclByb2ZpbGVJbWFnZXNDb250cm9sbGVyLFxuICBnZXRQb3N0SW1hZ2VzQ29udHJvbGxlcixcbiAgZ2V0RXZlbnRJbWFnZXNDb250cm9sbGVyXG59IGZyb20gJy4uL2NvbnRyb2xsZXJzL2ltYWdlc0NvbnRyb2xsZXInO1xuaW1wb3J0IHsgSW1hZ2VTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvaW1hZ2VTZXJ2aWNlJztcblxuLy8gTW9jayB0aGUgaW1hZ2VzTW9kZWxcbmplc3QubW9jaygnLi4vbW9kZWxzL2ltYWdlc01vZGVsJyk7XG5jb25zdCBtb2NrSW1hZ2VzTW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvaW1hZ2VzTW9kZWwnKTtcblxuZGVzY3JpYmUoJ0ltYWdlc0NvbnRyb2xsZXInLCAoKSA9PiB7XG4gIGxldCBtb2NrUmVxdWVzdDogUGFydGlhbDxSZXF1ZXN0PjtcbiAgbGV0IG1vY2tSZXNwb25zZTogUGFydGlhbDxSZXNwb25zZT47XG4gIGxldCBtb2NrU3RhdHVzOiBqZXN0Lk1vY2s7XG4gIGxldCBtb2NrSnNvbjogamVzdC5Nb2NrO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tTdGF0dXMgPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICBtb2NrSnNvbiA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgIG1vY2tSZXNwb25zZSA9IHtcbiAgICAgIHN0YXR1czogbW9ja1N0YXR1cyxcbiAgICAgIGpzb246IG1vY2tKc29uXG4gICAgfTtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwbG9hZEltYWdlQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwbG9hZCBpbWFnZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1c2VySWQgPSAndXNlcjEyMyc7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IHtcbiAgICAgICAgZmllbGRuYW1lOiAnaW1hZ2UnLFxuICAgICAgICBvcmlnaW5hbG5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIGVuY29kaW5nOiAnN2JpdCcsXG4gICAgICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgaW1hZ2UnKSxcbiAgICAgICAgc2l6ZTogMTAyNCxcbiAgICAgICAgc3RyZWFtOiB7fSBhcyBhbnksXG4gICAgICAgIGRlc3RpbmF0aW9uOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIHBhdGg6ICcnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrVXBsb2FkUmVzdWx0ID0ge1xuICAgICAgICBpZDogJ2ltYWdlLTEnLFxuICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAga2V5OiAndGVzdC1pbWFnZS1rZXknLFxuICAgICAgICBvcmlnaW5hbE5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC5qcGcnLFxuICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICBzaXplOiAxMDI0LFxuICAgICAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Rlc3QuanBnJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdwcm9maWxlJyBhcyBjb25zdCxcbiAgICAgICAgaXNQdWJsaWM6IGZhbHNlLFxuICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjogeyBcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJJZCxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBmaWxlOiBtb2NrRmlsZSxcbiAgICAgICAgYm9keTogeyBjYXRlZ29yeTogJ3Byb2ZpbGUnIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC51cGxvYWRJbWFnZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXBsb2FkUmVzdWx0KTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCB1cGxvYWRJbWFnZUNvbnRyb2xsZXIobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja0ltYWdlc01vZGVsLnVwbG9hZEltYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrRmlsZSwgdXNlcklkLCAncHJvZmlsZScsIHtcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICB0YWdzOiBbXSxcbiAgICAgICAgaXNQdWJsaWM6IHRydWVcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ0ltYWdlbiBzdWJpZGEgZXhpdG9zYW1lbnRlJyxcbiAgICAgICAgaW1hZ2U6IG1vY2tVcGxvYWRSZXN1bHRcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXJyb3Igd2hlbiBubyBmaWxlIHByb3ZpZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlcklkID0gJ3VzZXIxMjMnO1xuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHsgXG4gICAgICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICAgICAgdXNlckVtYWlsOiB1c2VySWQsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfSxcbiAgICAgICAgZmlsZTogdW5kZWZpbmVkLFxuICAgICAgICBib2R5OiB7IGNhdGVnb3J5OiAncHJvZmlsZScgfVxuICAgICAgfTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCB1cGxvYWRJbWFnZUNvbnRyb2xsZXIobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBlcnJvcjogJ05vIHNlIHByb3BvcmNpb27DsyBuaW5nw7puIGFyY2hpdm8nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB1bmRlZmluZWQsXG4gICAgICAgIGZpbGU6IHsgXG4gICAgICAgICAgZmllbGRuYW1lOiAnaW1hZ2UnLFxuICAgICAgICAgIG9yaWdpbmFsbmFtZTogJ3Rlc3QuanBnJyxcbiAgICAgICAgICBlbmNvZGluZzogJzdiaXQnLFxuICAgICAgICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgICAgYnVmZmVyOiBCdWZmZXIuZnJvbSgndGVzdCcpLFxuICAgICAgICAgIHNpemU6IDEwMjQsXG4gICAgICAgICAgc3RyZWFtOiB7fSBhcyBhbnksXG4gICAgICAgICAgZGVzdGluYXRpb246ICcnLFxuICAgICAgICAgIGZpbGVuYW1lOiAndGVzdC5qcGcnLFxuICAgICAgICAgIHBhdGg6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IHsgY2F0ZWdvcnk6ICdwcm9maWxlJyB9XG4gICAgICB9O1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IHVwbG9hZEltYWdlQ29udHJvbGxlcihtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnVXN1YXJpbyBubyBhdXRlbnRpY2FkbydcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1c2VySWQgPSAndXNlcjEyMyc7XG4gICAgICBjb25zdCBtb2NrRmlsZSA9IHtcbiAgICAgICAgZmllbGRuYW1lOiAnaW1hZ2UnLFxuICAgICAgICBvcmlnaW5hbG5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIGVuY29kaW5nOiAnN2JpdCcsXG4gICAgICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgIGJ1ZmZlcjogQnVmZmVyLmZyb20oJ3Rlc3QgaW1hZ2UnKSxcbiAgICAgICAgc2l6ZTogMTAyNCxcbiAgICAgICAgc3RyZWFtOiB7fSBhcyBhbnksXG4gICAgICAgIGRlc3RpbmF0aW9uOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIHBhdGg6ICcnXG4gICAgICB9O1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjogeyBcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJJZCxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBmaWxlOiBtb2NrRmlsZSxcbiAgICAgICAgYm9keTogeyBjYXRlZ29yeTogJ3Byb2ZpbGUnIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC51cGxvYWRJbWFnZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1VwbG9hZCBmYWlsZWQnKSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgdXBsb2FkSW1hZ2VDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDUwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZXJyb3I6ICdFcnJvciBhbCBzdWJpciBpbWFnZW4nLFxuICAgICAgICBkZXRhaWxzOiAnVXBsb2FkIGZhaWxlZCdcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0SW1hZ2VCeUlkQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCBpbWFnZSBieSBpZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbWFnZUlkID0gJ2ltYWdlMTIzJztcbiAgICAgIGNvbnN0IG1vY2tJbWFnZSA9IHtcbiAgICAgICAgaWQ6IGltYWdlSWQsXG4gICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICBrZXk6ICd0ZXN0LWltYWdlLWtleScsXG4gICAgICAgIG9yaWdpbmFsTmFtZTogJ3Rlc3QuanBnJyxcbiAgICAgICAgZmlsZU5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgIHNpemU6IDEwMjQsXG4gICAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vdGVzdC5qcGcnLFxuICAgICAgICBjYXRlZ29yeTogJ3Byb2ZpbGUnIGFzIGNvbnN0LFxuICAgICAgICBpc1B1YmxpYzogZmFsc2UsXG4gICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHsgaW1hZ2VJZCB9LFxuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC5nZXRJbWFnZUJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ltYWdlKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBnZXRJbWFnZUJ5SWRDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC5nZXRJbWFnZUJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGltYWdlSWQpO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgaW1hZ2U6IG1vY2tJbWFnZVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgd2hlbiBpbWFnZSBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbWFnZUlkID0gJ25vbmV4aXN0ZW50JztcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHsgaW1hZ2VJZCB9LFxuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC5nZXRJbWFnZUJ5SWQubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgZ2V0SW1hZ2VCeUlkQ29udHJvbGxlcihtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGVycm9yOiAnSW1hZ2VuIG5vIGVuY29udHJhZGEnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xpc3RJbWFnZXNDb250cm9sbGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbGlzdCBpbWFnZXMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbW9ja0ltYWdlcyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnaW1hZ2UxJyxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICBrZXk6ICdpbWFnZTEta2V5JyxcbiAgICAgICAgICBvcmlnaW5hbE5hbWU6ICdpbWFnZTEuanBnJyxcbiAgICAgICAgICBmaWxlTmFtZTogJ2ltYWdlMS5qcGcnLFxuICAgICAgICAgIG1pbWV0eXBlOiAnaW1hZ2UvanBlZycsXG4gICAgICAgICAgc2l6ZTogMTAyNCxcbiAgICAgICAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL2ltYWdlMS5qcGcnLFxuICAgICAgICAgIGNhdGVnb3J5OiAncHJvZmlsZScgYXMgY29uc3QsXG4gICAgICAgICAgaXNQdWJsaWM6IGZhbHNlLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2ltYWdlMicsXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAga2V5OiAnaW1hZ2UyLWtleScsXG4gICAgICAgICAgb3JpZ2luYWxOYW1lOiAnaW1hZ2UyLmpwZycsXG4gICAgICAgICAgZmlsZU5hbWU6ICdpbWFnZTIuanBnJyxcbiAgICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICAgIHNpemU6IDIwNDgsXG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZTIuanBnJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ3Bvc3QnIGFzIGNvbnN0LFxuICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBxdWVyeTogeyBwYWdlOiAnMScsIGxpbWl0OiAnMTAnIH0sXG4gICAgICAgIHVzZXI6IHsgXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiAndXNlcjEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW9ja0ltYWdlc01vZGVsLmxpc3RJbWFnZXMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpbWFnZXM6IG1vY2tJbWFnZXMsXG4gICAgICAgIHRvdGFsOiAyLFxuICAgICAgICBwYWdlOiAxLFxuICAgICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgICBoYXNOZXh0OiBmYWxzZSxcbiAgICAgICAgaGFzUHJldjogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGxpc3RJbWFnZXNDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGxpbWl0OiAxMFxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBpbWFnZXM6IHtcbiAgICAgICAgICBpbWFnZXM6IG1vY2tJbWFnZXMsXG4gICAgICAgICAgdG90YWw6IDIsXG4gICAgICAgICAgcGFnZTogMSxcbiAgICAgICAgICB0b3RhbFBhZ2VzOiAxLFxuICAgICAgICAgIGhhc05leHQ6IGZhbHNlLFxuICAgICAgICAgIGhhc1ByZXY6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsOiB1bmRlZmluZWQsXG4gICAgICAgIGZpbHRlcnM6IHtcbiAgICAgICAgICBsaW1pdDogMTBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVJbWFnZUNvbnRyb2xsZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgaW1hZ2Ugc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgaW1hZ2VJZCA9ICdpbWFnZTEyMyc7XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBkZXNjcmlwdGlvbjogJ1VwZGF0ZWQgZGVzY3JpcHRpb24nLFxuICAgICAgICB0YWdzOiBbJ3RhZzEnLCAndGFnMiddLFxuICAgICAgICBpc1B1YmxpYzogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1vY2tVcGRhdGVkSW1hZ2UgPSB7XG4gICAgICAgIGlkOiBpbWFnZUlkLFxuICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAga2V5OiAndGVzdC1pbWFnZS1rZXknLFxuICAgICAgICBvcmlnaW5hbE5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC5qcGcnLFxuICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICBzaXplOiAxMDI0LFxuICAgICAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Rlc3QuanBnJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdwcm9maWxlJyBhcyBjb25zdCxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgLi4udXBkYXRlRGF0YVxuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHBhcmFtczogeyBpbWFnZUlkIH0sXG4gICAgICAgIGJvZHk6IHVwZGF0ZURhdGEsXG4gICAgICAgIHVzZXI6IHsgXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiAndXNlcjEyMycsXG4gICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgbW9ja0ltYWdlc01vZGVsLmdldEltYWdlQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGlkOiBpbWFnZUlkLFxuICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAga2V5OiAndGVzdC1pbWFnZS1rZXknLFxuICAgICAgICBvcmlnaW5hbE5hbWU6ICd0ZXN0LmpwZycsXG4gICAgICAgIGZpbGVOYW1lOiAndGVzdC5qcGcnLFxuICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICBzaXplOiAxMDI0LFxuICAgICAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Rlc3QuanBnJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdwcm9maWxlJyBhcyBjb25zdCxcbiAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgICBtb2NrSW1hZ2VzTW9kZWwudXBkYXRlSW1hZ2UubW9ja1Jlc29sdmVkVmFsdWUobW9ja1VwZGF0ZWRJbWFnZSk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgdXBkYXRlSW1hZ2VDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC51cGRhdGVJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW1hZ2VJZCwgdXBkYXRlRGF0YSk7XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiAnSW1hZ2VuIGFjdHVhbGl6YWRhIGV4aXRvc2FtZW50ZScsXG4gICAgICAgIGltYWdlOiBtb2NrVXBkYXRlZEltYWdlXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2RlbGV0ZUltYWdlQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRlbGV0ZSBpbWFnZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbWFnZUlkID0gJ2ltYWdlMTIzJztcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBwYXJhbXM6IHsgaW1hZ2VJZCB9LFxuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC5kZWxldGVJbWFnZS5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBkZWxldGVJbWFnZUNvbnRyb2xsZXIobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja0ltYWdlc01vZGVsLmRlbGV0ZUltYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChpbWFnZUlkLCAndXNlcjEyMycpO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ0ltYWdlbiBlbGltaW5hZGEgZXhpdG9zYW1lbnRlJ1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRJbWFnZVN0YXRzQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCBpbWFnZSBzdGF0cyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrU3RhdHMgPSB7XG4gICAgICAgIHRvdGFsSW1hZ2VzOiAxMDAsXG4gICAgICAgIHRvdGFsU2l6ZTogMTAyNDAwMCxcbiAgICAgICAgYXZlcmFnZVNpemU6IDEwMjQwLFxuICAgICAgICBpbWFnZXNCeUNhdGVnb3J5OiB7XG4gICAgICAgICAgcHJvZmlsZTogMjAsXG4gICAgICAgICAgcG9zdDogMzAsXG4gICAgICAgICAgZXZlbnQ6IDI1LFxuICAgICAgICAgIGdhbGxlcnk6IDI1XG4gICAgICAgIH0sXG4gICAgICAgIGltYWdlc0J5VXNlcjogeyAndXNlcjEyMyc6IDUwLCAndXNlcjQ1Nic6IDUwIH0sXG4gICAgICAgIHJlY2VudFVwbG9hZHM6IFt7XG4gICAgICAgICAgaWQ6ICdpbWFnZTEnLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGtleTogJ2ltYWdlMS1rZXknLFxuICAgICAgICAgIG9yaWdpbmFsTmFtZTogJ2ltYWdlMS5qcGcnLFxuICAgICAgICAgIGZpbGVOYW1lOiAnaW1hZ2UxLmpwZycsXG4gICAgICAgICAgbWltZXR5cGU6ICdpbWFnZS9qcGVnJyxcbiAgICAgICAgICBzaXplOiAxMDI0LFxuICAgICAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UxLmpwZycsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdwcm9maWxlJyBhcyBjb25zdCxcbiAgICAgICAgICBpc1B1YmxpYzogZmFsc2UsXG4gICAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfV1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ2FkbWluMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6ICdhZG1pbjEyMycsXG4gICAgICAgICAgZW1haWw6ICdhZG1pbkBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ2FkbWluU2VuaW9yJyxcbiAgICAgICAgICByb2xsOiAnYWRtaW5TZW5pb3InLFxuICAgICAgICAgIG5hbWU6ICdBZG1pbiBVc2VyJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBtb2NrSW1hZ2VzTW9kZWwuZ2V0SW1hZ2VTdGF0cy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrU3RhdHMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGdldEltYWdlU3RhdHNDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC5nZXRJbWFnZVN0YXRzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBzdGF0czogbW9ja1N0YXRzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFVzZXJQcm9maWxlSW1hZ2VzQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCB1c2VyIHByb2ZpbGUgaW1hZ2VzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVzZXJJZCA9ICd1c2VyMTIzJztcbiAgICAgIGNvbnN0IG1vY2tJbWFnZXMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2ltYWdlMScsXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAga2V5OiAnaW1hZ2UxLWtleScsXG4gICAgICAgICAgb3JpZ2luYWxOYW1lOiAnaW1hZ2UxLmpwZycsXG4gICAgICAgICAgZmlsZU5hbWU6ICdpbWFnZTEuanBnJyxcbiAgICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICAgIHNpemU6IDEwMjQsXG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZTEuanBnJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ3Byb2ZpbGUnIGFzIGNvbnN0LFxuICAgICAgICAgIGlzUHVibGljOiBmYWxzZSxcbiAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgcGFyYW1zOiB7IHVzZXJJZCB9LFxuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC5nZXRVc2VyUHJvZmlsZUltYWdlcy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrSW1hZ2VzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBnZXRVc2VyUHJvZmlsZUltYWdlc0NvbnRyb2xsZXIobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja0ltYWdlc01vZGVsLmdldFVzZXJQcm9maWxlSW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VySWQpO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgaW1hZ2VzOiBtb2NrSW1hZ2VzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFBvc3RJbWFnZXNDb250cm9sbGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2V0IHBvc3QgaW1hZ2VzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHBvc3RJZCA9ICdwb3N0MTIzJztcbiAgICAgIGNvbnN0IG1vY2tJbWFnZXMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2ltYWdlMScsXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAga2V5OiAnaW1hZ2UxLWtleScsXG4gICAgICAgICAgb3JpZ2luYWxOYW1lOiAnaW1hZ2UxLmpwZycsXG4gICAgICAgICAgZmlsZU5hbWU6ICdpbWFnZTEuanBnJyxcbiAgICAgICAgICBtaW1ldHlwZTogJ2ltYWdlL2pwZWcnLFxuICAgICAgICAgIHNpemU6IDEwMjQsXG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9pbWFnZTEuanBnJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ3Bvc3QnIGFzIGNvbnN0LFxuICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICBxdWVyeTogeyB1c2VySWQ6ICd1c2VyMTIzJyB9LFxuICAgICAgICB1c2VyOiB7IFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIG1vY2tJbWFnZXNNb2RlbC5nZXRQb3N0SW1hZ2VzLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tJbWFnZXMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGdldFBvc3RJbWFnZXNDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC5nZXRQb3N0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndXNlcjEyMycpO1xuICAgICAgZXhwZWN0KG1vY2tTdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgaW1hZ2VzOiBtb2NrSW1hZ2VzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEV2ZW50SW1hZ2VzQ29udHJvbGxlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdldCBldmVudCBpbWFnZXMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgZXZlbnRJZCA9ICdldmVudDEyMyc7XG4gICAgICBjb25zdCBtb2NrSW1hZ2VzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdpbWFnZTEnLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIGtleTogJ2ltYWdlMS1rZXknLFxuICAgICAgICAgIG9yaWdpbmFsTmFtZTogJ2ltYWdlMS5qcGcnLFxuICAgICAgICAgIGZpbGVOYW1lOiAnaW1hZ2UxLmpwZycsXG4gICAgICAgICAgbWltZXR5cGU6ICdpbWFnZS9qcGVnJyxcbiAgICAgICAgICBzaXplOiAxMDI0LFxuICAgICAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vaW1hZ2UxLmpwZycsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdldmVudCcgYXMgY29uc3QsXG4gICAgICAgICAgaXNQdWJsaWM6IHRydWUsXG4gICAgICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHF1ZXJ5OiB7IGV2ZW50SWQgfSxcbiAgICAgICAgdXNlcjogeyBcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6ICd1c2VyMTIzJyxcbiAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBtb2NrSW1hZ2VzTW9kZWwuZ2V0RXZlbnRJbWFnZXMubW9ja1Jlc29sdmVkVmFsdWUobW9ja0ltYWdlcyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgZ2V0RXZlbnRJbWFnZXNDb250cm9sbGVyKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tJbWFnZXNNb2RlbC5nZXRFdmVudEltYWdlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXZlbnRJZCk7XG4gICAgICBleHBlY3QobW9ja1N0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBpbWFnZXM6IG1vY2tJbWFnZXNcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuXG5cblxuXG5cbn0pOyAiXSwidmVyc2lvbiI6M30=