{"file":"C:\\src\\APP_MussikOn\\APP_MussikOn_Express\\src\\__tests__\\imagesController.test.ts","mappings":";;;;;;;;;;;AAcA,uBAAuB;AACvB,IAAI,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;AAdnC,sEAUyC;AAKzC,MAAM,eAAe,GAAG,OAAO,CAAC,uBAAuB,CAAC,CAAC;AAEzD,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAChC,IAAI,WAA6B,CAAC;IAClC,IAAI,YAA+B,CAAC;IACpC,IAAI,UAAqB,CAAC;IAC1B,IAAI,QAAmB,CAAC;IAExB,UAAU,CAAC,GAAG,EAAE;QACd,UAAU,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;QACxC,QAAQ,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,cAAc,EAAE,CAAC;QACtC,YAAY,GAAG;YACb,MAAM,EAAE,UAAU;YAClB,IAAI,EAAE,QAAQ;SACf,CAAC;QACF,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,EAAE,CAAC,kCAAkC,EAAE,GAAS,EAAE;YAChD,UAAU;YACV,MAAM,MAAM,GAAG,SAAS,CAAC;YACzB,MAAM,QAAQ,GAAG;gBACf,SAAS,EAAE,OAAO;gBAClB,YAAY,EAAE,UAAU;gBACxB,QAAQ,EAAE,MAAM;gBAChB,QAAQ,EAAE,YAAY;gBACtB,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;gBACjC,IAAI,EAAE,IAAI;gBACV,MAAM,EAAE,EAAS;gBACjB,WAAW,EAAE,EAAE;gBACf,QAAQ,EAAE,UAAU;gBACpB,IAAI,EAAE,EAAE;aACT,CAAC;YAEF,MAAM,gBAAgB,GAAG;gBACvB,EAAE,EAAE,SAAS;gBACb,MAAM,EAAE,SAAS;gBACjB,GAAG,EAAE,gBAAgB;gBACrB,YAAY,EAAE,UAAU;gBACxB,QAAQ,EAAE,UAAU;gBACpB,QAAQ,EAAE,YAAY;gBACtB,IAAI,EAAE,IAAI;gBACV,GAAG,EAAE,8BAA8B;gBACnC,QAAQ,EAAE,SAAkB;gBAC5B,QAAQ,EAAE,KAAK;gBACf,QAAQ,EAAE,IAAI;gBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;gBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aACpC,CAAC;YAEF,WAAW,GAAG;gBACZ,IAAI,EAAE;oBACJ,MAAM,EAAE,MAAM;oBACd,SAAS,EAAE,MAAM;oBACjB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;gBACD,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE;aAC9B,CAAC;YAEF,eAAe,CAAC,WAAW,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;YAEhE,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,oBAAoB,CAAC,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE;gBACpF,WAAW,EAAE,EAAE;gBACf,IAAI,EAAE,EAAE;gBACR,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YACH,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,4BAA4B;gBACrC,KAAK,EAAE,gBAAgB;aACxB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,GAAS,EAAE;YACzD,UAAU;YACV,MAAM,MAAM,GAAG,SAAS,CAAC;YACzB,WAAW,GAAG;gBACZ,IAAI,EAAE;oBACJ,MAAM,EAAE,MAAM;oBACd,SAAS,EAAE,MAAM;oBACjB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;gBACD,IAAI,EAAE,SAAS;gBACf,IAAI,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE;aAC9B,CAAC;YAEF,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,KAAK,EAAE,kCAAkC;aAC1C,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,GAAS,EAAE;YAClE,UAAU;YACV,WAAW,GAAG;gBACZ,IAAI,EAAE,SAAS;gBACf,IAAI,EAAE;oBACJ,SAAS,EAAE,OAAO;oBAClB,YAAY,EAAE,UAAU;oBACxB,QAAQ,EAAE,MAAM;oBAChB,QAAQ,EAAE,YAAY;oBACtB,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;oBAC3B,IAAI,EAAE,IAAI;oBACV,MAAM,EAAE,EAAS;oBACjB,WAAW,EAAE,EAAE;oBACf,QAAQ,EAAE,UAAU;oBACpB,IAAI,EAAE,EAAE;iBACT;gBACD,IAAI,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE;aAC9B,CAAC;YAEF,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,KAAK,EAAE,wBAAwB;aAChC,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,GAAS,EAAE;YAC5C,UAAU;YACV,MAAM,MAAM,GAAG,SAAS,CAAC;YACzB,MAAM,QAAQ,GAAG;gBACf,SAAS,EAAE,OAAO;gBAClB,YAAY,EAAE,UAAU;gBACxB,QAAQ,EAAE,MAAM;gBAChB,QAAQ,EAAE,YAAY;gBACtB,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;gBACjC,IAAI,EAAE,IAAI;gBACV,MAAM,EAAE,EAAS;gBACjB,WAAW,EAAE,EAAE;gBACf,QAAQ,EAAE,UAAU;gBACpB,IAAI,EAAE,EAAE;aACT,CAAC;YAEF,WAAW,GAAG;gBACZ,IAAI,EAAE;oBACJ,MAAM,EAAE,MAAM;oBACd,SAAS,EAAE,MAAM;oBACjB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;gBACD,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE;aAC9B,CAAC;YAEF,eAAe,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;YAE1E,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,KAAK,EAAE,uBAAuB;gBAC9B,OAAO,EAAE,eAAe;aACzB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE;QACtC,EAAE,CAAC,qCAAqC,EAAE,GAAS,EAAE;YACnD,UAAU;YACV,MAAM,OAAO,GAAG,UAAU,CAAC;YAC3B,MAAM,SAAS,GAAG;gBAChB,EAAE,EAAE,OAAO;gBACX,MAAM,EAAE,SAAS;gBACjB,GAAG,EAAE,gBAAgB;gBACrB,YAAY,EAAE,UAAU;gBACxB,QAAQ,EAAE,UAAU;gBACpB,QAAQ,EAAE,YAAY;gBACtB,IAAI,EAAE,IAAI;gBACV,GAAG,EAAE,8BAA8B;gBACnC,QAAQ,EAAE,SAAkB;gBAC5B,QAAQ,EAAE,KAAK;gBACf,QAAQ,EAAE,IAAI;gBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;gBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aACpC,CAAC;YAEF,WAAW,GAAG;gBACZ,MAAM,EAAE,EAAE,OAAO,EAAE;gBACnB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,YAAY,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;YAE1D,MAAM;YACN,MAAM,IAAA,yCAAsB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE/E,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;YACnE,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,KAAK,EAAE,SAAS;aACjB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;QAEH,EAAE,CAAC,wCAAwC,EAAE,GAAS,EAAE;YACtD,UAAU;YACV,MAAM,OAAO,GAAG,aAAa,CAAC;YAC9B,WAAW,GAAG;gBACZ,MAAM,EAAE,EAAE,OAAO,EAAE;gBACnB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,YAAY,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAErD,MAAM;YACN,MAAM,IAAA,yCAAsB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE/E,SAAS;YACT,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,KAAK,EAAE,sBAAsB;aAC9B,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,EAAE,CAAC,iCAAiC,EAAE,GAAS,EAAE;YAC/C,UAAU;YACV,MAAM,UAAU,GAAG;gBACjB;oBACE,EAAE,EAAE,QAAQ;oBACZ,MAAM,EAAE,SAAS;oBACjB,GAAG,EAAE,YAAY;oBACjB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,YAAY;oBACtB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,gCAAgC;oBACrC,QAAQ,EAAE,SAAkB;oBAC5B,QAAQ,EAAE,KAAK;oBACf,QAAQ,EAAE,IAAI;oBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;oBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;iBACpC;gBACD;oBACE,EAAE,EAAE,QAAQ;oBACZ,MAAM,EAAE,SAAS;oBACjB,GAAG,EAAE,YAAY;oBACjB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,YAAY;oBACtB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,gCAAgC;oBACrC,QAAQ,EAAE,MAAe;oBACzB,QAAQ,EAAE,IAAI;oBACd,QAAQ,EAAE,IAAI;oBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;oBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;iBACpC;aACF,CAAC;YAEF,WAAW,GAAG;gBACZ,KAAK,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE;gBACjC,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,UAAU,CAAC,iBAAiB,CAAC;gBAC3C,MAAM,EAAE,UAAU;gBAClB,KAAK,EAAE,CAAC;gBACR,IAAI,EAAE,CAAC;gBACP,UAAU,EAAE,CAAC;gBACb,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,KAAK;aACf,CAAC,CAAC;YAEH,MAAM;YACN,MAAM,IAAA,uCAAoB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE7E,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC;gBACtD,KAAK,EAAE,EAAE;aACV,CAAC,CAAC;YACH,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE;oBACN,MAAM,EAAE,UAAU;oBAClB,KAAK,EAAE,CAAC;oBACR,IAAI,EAAE,CAAC;oBACP,UAAU,EAAE,CAAC;oBACb,OAAO,EAAE,KAAK;oBACd,OAAO,EAAE,KAAK;iBACf;gBACD,KAAK,EAAE,SAAS;gBAChB,OAAO,EAAE;oBACP,KAAK,EAAE,EAAE;iBACV;aACF,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,EAAE,CAAC,kCAAkC,EAAE,GAAS,EAAE;YAChD,UAAU;YACV,MAAM,OAAO,GAAG,UAAU,CAAC;YAC3B,MAAM,UAAU,GAAG;gBACjB,WAAW,EAAE,qBAAqB;gBAClC,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC;gBACtB,QAAQ,EAAE,KAAK;aAChB,CAAC;YAEF,MAAM,gBAAgB,mBACpB,EAAE,EAAE,OAAO,EACX,MAAM,EAAE,SAAS,EACjB,GAAG,EAAE,gBAAgB,EACrB,YAAY,EAAE,UAAU,EACxB,QAAQ,EAAE,UAAU,EACpB,QAAQ,EAAE,YAAY,EACtB,IAAI,EAAE,IAAI,EACV,GAAG,EAAE,8BAA8B,EACnC,QAAQ,EAAE,SAAkB,EAC5B,QAAQ,EAAE,IAAI,EACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,EACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,IAChC,UAAU,CACd,CAAC;YAEF,WAAW,GAAG;gBACZ,MAAM,EAAE,EAAE,OAAO,EAAE;gBACnB,IAAI,EAAE,UAAU;gBAChB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,YAAY,CAAC,iBAAiB,CAAC;gBAC7C,EAAE,EAAE,OAAO;gBACX,MAAM,EAAE,SAAS;gBACjB,GAAG,EAAE,gBAAgB;gBACrB,YAAY,EAAE,UAAU;gBACxB,QAAQ,EAAE,UAAU;gBACpB,QAAQ,EAAE,YAAY;gBACtB,IAAI,EAAE,IAAI;gBACV,GAAG,EAAE,8BAA8B;gBACnC,QAAQ,EAAE,SAAkB;gBAC5B,QAAQ,EAAE,IAAI;gBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;gBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aACpC,CAAC,CAAC;YACH,eAAe,CAAC,WAAW,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;YAEhE,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,oBAAoB,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;YAC9E,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,iCAAiC;gBAC1C,KAAK,EAAE,gBAAgB;aACxB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE;QACrC,EAAE,CAAC,kCAAkC,EAAE,GAAS,EAAE;YAChD,UAAU;YACV,MAAM,OAAO,GAAG,UAAU,CAAC;YAC3B,WAAW,GAAG;gBACZ,MAAM,EAAE,EAAE,OAAO,EAAE;gBACnB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEpD,MAAM;YACN,MAAM,IAAA,wCAAqB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAE9E,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC,oBAAoB,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;YAC7E,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,+BAA+B;aACzC,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,yBAAyB,EAAE,GAAG,EAAE;QACvC,EAAE,CAAC,qCAAqC,EAAE,GAAS,EAAE;YACnD,UAAU;YACV,MAAM,SAAS,GAAG;gBAChB,WAAW,EAAE,GAAG;gBAChB,SAAS,EAAE,OAAO;gBAClB,WAAW,EAAE,KAAK;gBAClB,gBAAgB,EAAE;oBAChB,OAAO,EAAE,EAAE;oBACX,IAAI,EAAE,EAAE;oBACR,KAAK,EAAE,EAAE;oBACT,OAAO,EAAE,EAAE;iBACZ;gBACD,YAAY,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE;gBAC9C,aAAa,EAAE,CAAC;wBACd,EAAE,EAAE,QAAQ;wBACZ,MAAM,EAAE,SAAS;wBACjB,GAAG,EAAE,YAAY;wBACjB,YAAY,EAAE,YAAY;wBAC1B,QAAQ,EAAE,YAAY;wBACtB,QAAQ,EAAE,YAAY;wBACtB,IAAI,EAAE,IAAI;wBACV,GAAG,EAAE,gCAAgC;wBACrC,QAAQ,EAAE,SAAkB;wBAC5B,QAAQ,EAAE,KAAK;wBACf,QAAQ,EAAE,IAAI;wBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;wBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;qBACpC,CAAC;aACH,CAAC;YAEF,WAAW,GAAG;gBACZ,IAAI,EAAE;oBACJ,MAAM,EAAE,UAAU;oBAClB,SAAS,EAAE,UAAU;oBACrB,KAAK,EAAE,mBAAmB;oBAC1B,IAAI,EAAE,aAAa;oBACnB,IAAI,EAAE,aAAa;oBACnB,IAAI,EAAE,YAAY;iBACnB;aACF,CAAC;YAEF,eAAe,CAAC,aAAa,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;YAE3D,MAAM;YACN,MAAM,IAAA,0CAAuB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAEhF,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,gBAAgB,EAAE,CAAC;YACzD,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,KAAK,EAAE,SAAS;aACjB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,gCAAgC,EAAE,GAAG,EAAE;QAC9C,EAAE,CAAC,6CAA6C,EAAE,GAAS,EAAE;YAC3D,UAAU;YACV,MAAM,MAAM,GAAG,SAAS,CAAC;YACzB,MAAM,UAAU,GAAG;gBACjB;oBACE,EAAE,EAAE,QAAQ;oBACZ,MAAM,EAAE,SAAS;oBACjB,GAAG,EAAE,YAAY;oBACjB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,YAAY;oBACtB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,gCAAgC;oBACrC,QAAQ,EAAE,SAAkB;oBAC5B,QAAQ,EAAE,KAAK;oBACf,QAAQ,EAAE,IAAI;oBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;oBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;iBACpC;aACF,CAAC;YAEF,WAAW,GAAG;gBACZ,MAAM,EAAE,EAAE,MAAM,EAAE;gBAClB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;YAEnE,MAAM;YACN,MAAM,IAAA,iDAA8B,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAEvF,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,oBAAoB,CAAC,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;YAC1E,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,yBAAyB,EAAE,GAAG,EAAE;QACvC,EAAE,CAAC,qCAAqC,EAAE,GAAS,EAAE;YACnD,UAAU;YACV,MAAM,MAAM,GAAG,SAAS,CAAC;YACzB,MAAM,UAAU,GAAG;gBACjB;oBACE,EAAE,EAAE,QAAQ;oBACZ,MAAM,EAAE,SAAS;oBACjB,GAAG,EAAE,YAAY;oBACjB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,YAAY;oBACtB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,gCAAgC;oBACrC,QAAQ,EAAE,MAAe;oBACzB,QAAQ,EAAE,IAAI;oBACd,QAAQ,EAAE,IAAI;oBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;oBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;iBACpC;aACF,CAAC;YAEF,WAAW,GAAG;gBACZ,KAAK,EAAE,EAAE,MAAM,EAAE,SAAS,EAAE;gBAC5B,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,aAAa,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;YAE5D,MAAM;YACN,MAAM,IAAA,0CAAuB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAEhF,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;YACtE,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,0BAA0B,EAAE,GAAG,EAAE;QACxC,EAAE,CAAC,sCAAsC,EAAE,GAAS,EAAE;YACpD,UAAU;YACV,MAAM,OAAO,GAAG,UAAU,CAAC;YAC3B,MAAM,UAAU,GAAG;gBACjB;oBACE,EAAE,EAAE,QAAQ;oBACZ,MAAM,EAAE,SAAS;oBACjB,GAAG,EAAE,YAAY;oBACjB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,YAAY;oBACtB,IAAI,EAAE,IAAI;oBACV,GAAG,EAAE,gCAAgC;oBACrC,QAAQ,EAAE,OAAgB;oBAC1B,QAAQ,EAAE,IAAI;oBACd,QAAQ,EAAE,IAAI;oBACd,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;oBACnC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;iBACpC;aACF,CAAC;YAEF,WAAW,GAAG;gBACZ,KAAK,EAAE,EAAE,OAAO,EAAE;gBAClB,IAAI,EAAE;oBACJ,MAAM,EAAE,SAAS;oBACjB,SAAS,EAAE,SAAS;oBACpB,KAAK,EAAE,kBAAkB;oBACzB,IAAI,EAAE,MAAM;oBACZ,IAAI,EAAE,WAAW;iBAClB;aACF,CAAC;YAEF,eAAe,CAAC,cAAc,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;YAE7D,MAAM;YACN,MAAM,IAAA,2CAAwB,EAAC,WAAsB,EAAE,YAAwB,CAAC,CAAC;YAEjF,SAAS;YACT,MAAM,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC;YACrE,MAAM,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;YAC7C,MAAM,CAAC,QAAQ,CAAC,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,UAAU;aACnB,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AAOL,CAAC,CAAC,CAAC","names":[],"sources":["C:\\src\\APP_MussikOn\\APP_MussikOn_Express\\src\\__tests__\\imagesController.test.ts"],"sourcesContent":["import { Request, Response } from 'express';\r\nimport { \r\n  uploadImageController,\r\n  getImageByIdController,\r\n  listImagesController,\r\n  updateImageController,\r\n  deleteImageController,\r\n  getImageStatsController,\r\n  getUserProfileImagesController,\r\n  getPostImagesController,\r\n  getEventImagesController\r\n} from '../controllers/imagesController';\r\nimport { ImageService } from '../services/imageService';\r\n\r\n// Mock the imagesModel\r\njest.mock('../models/imagesModel');\r\nconst mockImagesModel = require('../models/imagesModel');\r\n\r\ndescribe('ImagesController', () => {\r\n  let mockRequest: Partial<Request>;\r\n  let mockResponse: Partial<Response>;\r\n  let mockStatus: jest.Mock;\r\n  let mockJson: jest.Mock;\r\n\r\n  beforeEach(() => {\r\n    mockStatus = jest.fn().mockReturnThis();\r\n    mockJson = jest.fn().mockReturnThis();\r\n    mockResponse = {\r\n      status: mockStatus,\r\n      json: mockJson\r\n    };\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('uploadImageController', () => {\r\n    it('should upload image successfully', async () => {\r\n      // Arrange\r\n      const userId = 'user123';\r\n      const mockFile = {\r\n        fieldname: 'image',\r\n        originalname: 'test.jpg',\r\n        encoding: '7bit',\r\n        mimetype: 'image/jpeg',\r\n        buffer: Buffer.from('test image'),\r\n        size: 1024,\r\n        stream: {} as any,\r\n        destination: '',\r\n        filename: 'test.jpg',\r\n        path: ''\r\n      };\r\n\r\n      const mockUploadResult = {\r\n        id: 'image-1',\r\n        userId: 'user123',\r\n        key: 'test-image-key',\r\n        originalName: 'test.jpg',\r\n        fileName: 'test.jpg',\r\n        mimetype: 'image/jpeg',\r\n        size: 1024,\r\n        url: 'https://example.com/test.jpg',\r\n        category: 'profile' as const,\r\n        isPublic: false,\r\n        isActive: true,\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n\r\n      mockRequest = {\r\n        user: { \r\n          userId: userId,\r\n          userEmail: userId,\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        },\r\n        file: mockFile,\r\n        body: { category: 'profile' }\r\n      };\r\n\r\n      mockImagesModel.uploadImage.mockResolvedValue(mockUploadResult);\r\n\r\n      // Act\r\n      await uploadImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.uploadImage).toHaveBeenCalledWith(mockFile, userId, 'profile', {\r\n        description: '',\r\n        tags: [],\r\n        isPublic: true\r\n      });\r\n      expect(mockStatus).toHaveBeenCalledWith(201);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        message: 'Imagen subida exitosamente',\r\n        image: mockUploadResult\r\n      });\r\n    });\r\n\r\n    it('should return error when no file provided', async () => {\r\n      // Arrange\r\n      const userId = 'user123';\r\n      mockRequest = {\r\n        user: { \r\n          userId: userId,\r\n          userEmail: userId,\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        },\r\n        file: undefined,\r\n        body: { category: 'profile' }\r\n      };\r\n\r\n      // Act\r\n      await uploadImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockStatus).toHaveBeenCalledWith(400);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        error: 'No se proporcionó ningún archivo'\r\n      });\r\n    });\r\n\r\n    it('should return error when user is not authenticated', async () => {\r\n      // Arrange\r\n      mockRequest = {\r\n        user: undefined,\r\n        file: { \r\n          fieldname: 'image',\r\n          originalname: 'test.jpg',\r\n          encoding: '7bit',\r\n          mimetype: 'image/jpeg',\r\n          buffer: Buffer.from('test'),\r\n          size: 1024,\r\n          stream: {} as any,\r\n          destination: '',\r\n          filename: 'test.jpg',\r\n          path: ''\r\n        },\r\n        body: { category: 'profile' }\r\n      };\r\n\r\n      // Act\r\n      await uploadImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockStatus).toHaveBeenCalledWith(401);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        error: 'Usuario no autenticado'\r\n      });\r\n    });\r\n\r\n    it('should handle service errors', async () => {\r\n      // Arrange\r\n      const userId = 'user123';\r\n      const mockFile = {\r\n        fieldname: 'image',\r\n        originalname: 'test.jpg',\r\n        encoding: '7bit',\r\n        mimetype: 'image/jpeg',\r\n        buffer: Buffer.from('test image'),\r\n        size: 1024,\r\n        stream: {} as any,\r\n        destination: '',\r\n        filename: 'test.jpg',\r\n        path: ''\r\n      };\r\n\r\n      mockRequest = {\r\n        user: { \r\n          userId: userId,\r\n          userEmail: userId,\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        },\r\n        file: mockFile,\r\n        body: { category: 'profile' }\r\n      };\r\n\r\n      mockImagesModel.uploadImage.mockRejectedValue(new Error('Upload failed'));\r\n\r\n      // Act\r\n      await uploadImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockStatus).toHaveBeenCalledWith(500);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        error: 'Error al subir imagen',\r\n        details: 'Upload failed'\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('getImageByIdController', () => {\r\n    it('should get image by id successfully', async () => {\r\n      // Arrange\r\n      const imageId = 'image123';\r\n      const mockImage = {\r\n        id: imageId,\r\n        userId: 'user123',\r\n        key: 'test-image-key',\r\n        originalName: 'test.jpg',\r\n        fileName: 'test.jpg',\r\n        mimetype: 'image/jpeg',\r\n        size: 1024,\r\n        url: 'https://example.com/test.jpg',\r\n        category: 'profile' as const,\r\n        isPublic: false,\r\n        isActive: true,\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString()\r\n      };\r\n\r\n      mockRequest = {\r\n        params: { imageId },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getImageById.mockResolvedValue(mockImage);\r\n\r\n      // Act\r\n      await getImageByIdController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.getImageById).toHaveBeenCalledWith(imageId);\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        image: mockImage\r\n      });\r\n    });\r\n\r\n    it('should return 404 when image not found', async () => {\r\n      // Arrange\r\n      const imageId = 'nonexistent';\r\n      mockRequest = {\r\n        params: { imageId },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getImageById.mockResolvedValue(null);\r\n\r\n      // Act\r\n      await getImageByIdController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockStatus).toHaveBeenCalledWith(404);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        error: 'Imagen no encontrada'\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('listImagesController', () => {\r\n    it('should list images successfully', async () => {\r\n      // Arrange\r\n      const mockImages = [\r\n        {\r\n          id: 'image1',\r\n          userId: 'user123',\r\n          key: 'image1-key',\r\n          originalName: 'image1.jpg',\r\n          fileName: 'image1.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 1024,\r\n          url: 'https://example.com/image1.jpg',\r\n          category: 'profile' as const,\r\n          isPublic: false,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        },\r\n        {\r\n          id: 'image2',\r\n          userId: 'user123',\r\n          key: 'image2-key',\r\n          originalName: 'image2.jpg',\r\n          fileName: 'image2.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 2048,\r\n          url: 'https://example.com/image2.jpg',\r\n          category: 'post' as const,\r\n          isPublic: true,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }\r\n      ];\r\n\r\n      mockRequest = {\r\n        query: { page: '1', limit: '10' },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.listImages.mockResolvedValue({\r\n        images: mockImages,\r\n        total: 2,\r\n        page: 1,\r\n        totalPages: 1,\r\n        hasNext: false,\r\n        hasPrev: false\r\n      });\r\n\r\n      // Act\r\n      await listImagesController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.listImages).toHaveBeenCalledWith({\r\n        limit: 10\r\n      });\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        images: {\r\n          images: mockImages,\r\n          total: 2,\r\n          page: 1,\r\n          totalPages: 1,\r\n          hasNext: false,\r\n          hasPrev: false\r\n        },\r\n        total: undefined,\r\n        filters: {\r\n          limit: 10\r\n        }\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('updateImageController', () => {\r\n    it('should update image successfully', async () => {\r\n      // Arrange\r\n      const imageId = 'image123';\r\n      const updateData = {\r\n        description: 'Updated description',\r\n        tags: ['tag1', 'tag2'],\r\n        isPublic: false\r\n      };\r\n\r\n      const mockUpdatedImage = {\r\n        id: imageId,\r\n        userId: 'user123',\r\n        key: 'test-image-key',\r\n        originalName: 'test.jpg',\r\n        fileName: 'test.jpg',\r\n        mimetype: 'image/jpeg',\r\n        size: 1024,\r\n        url: 'https://example.com/test.jpg',\r\n        category: 'profile' as const,\r\n        isActive: true,\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString(),\r\n        ...updateData\r\n      };\r\n\r\n      mockRequest = {\r\n        params: { imageId },\r\n        body: updateData,\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getImageById.mockResolvedValue({\r\n        id: imageId,\r\n        userId: 'user123',\r\n        key: 'test-image-key',\r\n        originalName: 'test.jpg',\r\n        fileName: 'test.jpg',\r\n        mimetype: 'image/jpeg',\r\n        size: 1024,\r\n        url: 'https://example.com/test.jpg',\r\n        category: 'profile' as const,\r\n        isActive: true,\r\n        createdAt: new Date().toISOString(),\r\n        updatedAt: new Date().toISOString()\r\n      });\r\n      mockImagesModel.updateImage.mockResolvedValue(mockUpdatedImage);\r\n\r\n      // Act\r\n      await updateImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.updateImage).toHaveBeenCalledWith(imageId, updateData);\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        message: 'Imagen actualizada exitosamente',\r\n        image: mockUpdatedImage\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('deleteImageController', () => {\r\n    it('should delete image successfully', async () => {\r\n      // Arrange\r\n      const imageId = 'image123';\r\n      mockRequest = {\r\n        params: { imageId },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.deleteImage.mockResolvedValue(true);\r\n\r\n      // Act\r\n      await deleteImageController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.deleteImage).toHaveBeenCalledWith(imageId, 'user123');\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        message: 'Imagen eliminada exitosamente'\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('getImageStatsController', () => {\r\n    it('should get image stats successfully', async () => {\r\n      // Arrange\r\n      const mockStats = {\r\n        totalImages: 100,\r\n        totalSize: 1024000,\r\n        averageSize: 10240,\r\n        imagesByCategory: {\r\n          profile: 20,\r\n          post: 30,\r\n          event: 25,\r\n          gallery: 25\r\n        },\r\n        imagesByUser: { 'user123': 50, 'user456': 50 },\r\n        recentUploads: [{\r\n          id: 'image1',\r\n          userId: 'user123',\r\n          key: 'image1-key',\r\n          originalName: 'image1.jpg',\r\n          fileName: 'image1.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 1024,\r\n          url: 'https://example.com/image1.jpg',\r\n          category: 'profile' as const,\r\n          isPublic: false,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }]\r\n      };\r\n\r\n      mockRequest = {\r\n        user: { \r\n          userId: 'admin123',\r\n          userEmail: 'admin123',\r\n          email: 'admin@example.com',\r\n          role: 'adminSenior',\r\n          roll: 'adminSenior',\r\n          name: 'Admin User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getImageStats.mockResolvedValue(mockStats);\r\n\r\n      // Act\r\n      await getImageStatsController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.getImageStats).toHaveBeenCalled();\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        stats: mockStats\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('getUserProfileImagesController', () => {\r\n    it('should get user profile images successfully', async () => {\r\n      // Arrange\r\n      const userId = 'user123';\r\n      const mockImages = [\r\n        {\r\n          id: 'image1',\r\n          userId: 'user123',\r\n          key: 'image1-key',\r\n          originalName: 'image1.jpg',\r\n          fileName: 'image1.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 1024,\r\n          url: 'https://example.com/image1.jpg',\r\n          category: 'profile' as const,\r\n          isPublic: false,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }\r\n      ];\r\n\r\n      mockRequest = {\r\n        params: { userId },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getUserProfileImages.mockResolvedValue(mockImages);\r\n\r\n      // Act\r\n      await getUserProfileImagesController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.getUserProfileImages).toHaveBeenCalledWith(userId);\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        images: mockImages\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('getPostImagesController', () => {\r\n    it('should get post images successfully', async () => {\r\n      // Arrange\r\n      const postId = 'post123';\r\n      const mockImages = [\r\n        {\r\n          id: 'image1',\r\n          userId: 'user123',\r\n          key: 'image1-key',\r\n          originalName: 'image1.jpg',\r\n          fileName: 'image1.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 1024,\r\n          url: 'https://example.com/image1.jpg',\r\n          category: 'post' as const,\r\n          isPublic: true,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }\r\n      ];\r\n\r\n      mockRequest = {\r\n        query: { userId: 'user123' },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getPostImages.mockResolvedValue(mockImages);\r\n\r\n      // Act\r\n      await getPostImagesController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.getPostImages).toHaveBeenCalledWith('user123');\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        images: mockImages\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('getEventImagesController', () => {\r\n    it('should get event images successfully', async () => {\r\n      // Arrange\r\n      const eventId = 'event123';\r\n      const mockImages = [\r\n        {\r\n          id: 'image1',\r\n          userId: 'user123',\r\n          key: 'image1-key',\r\n          originalName: 'image1.jpg',\r\n          fileName: 'image1.jpg',\r\n          mimetype: 'image/jpeg',\r\n          size: 1024,\r\n          url: 'https://example.com/image1.jpg',\r\n          category: 'event' as const,\r\n          isPublic: true,\r\n          isActive: true,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }\r\n      ];\r\n\r\n      mockRequest = {\r\n        query: { eventId },\r\n        user: { \r\n          userId: 'user123',\r\n          userEmail: 'user123',\r\n          email: 'test@example.com',\r\n          role: 'user',\r\n          name: 'Test User'\r\n        }\r\n      };\r\n\r\n      mockImagesModel.getEventImages.mockResolvedValue(mockImages);\r\n\r\n      // Act\r\n      await getEventImagesController(mockRequest as Request, mockResponse as Response);\r\n\r\n      // Assert\r\n      expect(mockImagesModel.getEventImages).toHaveBeenCalledWith(eventId);\r\n      expect(mockStatus).toHaveBeenCalledWith(200);\r\n      expect(mockJson).toHaveBeenCalledWith({\r\n        success: true,\r\n        images: mockImages\r\n      });\r\n    });\r\n  });\r\n\r\n\r\n\r\n\r\n\r\n\r\n}); "],"version":3}