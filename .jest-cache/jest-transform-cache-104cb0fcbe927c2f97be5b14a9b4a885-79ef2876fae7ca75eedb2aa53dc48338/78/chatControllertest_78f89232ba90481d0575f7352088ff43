0cc01583f847fa4c85d6c02e3d6108f8
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock the chat models
jest.mock('../models/chatModel');
jest.mock('../services/loggerService', () => ({
    logger: {
        info: jest.fn(),
        error: jest.fn(),
        warn: jest.fn()
    }
}));
const chatController_1 = require("../controllers/chatController");
const chatModel_1 = require("../models/chatModel");
describe('ChatController', () => {
    let mockRequest;
    let mockResponse;
    let mockStatus;
    let mockJson;
    beforeEach(() => {
        mockStatus = jest.fn().mockReturnThis();
        mockJson = jest.fn().mockReturnThis();
        mockResponse = {
            status: mockStatus,
            json: mockJson
        };
        jest.clearAllMocks();
    });
    describe('getConversations', () => {
        it('should return user conversations successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            const mockConversations = [
                {
                    id: 'conv1',
                    participants: ['user@example.com', 'other@example.com'],
                    lastMessage: 'Hello there',
                    lastMessageTime: new Date().toISOString(),
                    unreadCount: 2,
                    isArchived: false,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                }
            };
            chatModel_1.getConversationsByUserModel.mockResolvedValue(mockConversations);
            // Act
            yield (0, chatController_1.getConversations)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getConversationsByUserModel).toHaveBeenCalledWith(userEmail);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockConversations
            });
        }));
        it('should return error when user is not authenticated', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            mockRequest = {
                user: undefined
            };
            // Act
            yield (0, chatController_1.getConversations)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(401);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                error: 'Usuario no autenticado'
            });
        }));
    });
    describe('getMessages', () => {
        it('should return messages successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'conv123';
            const userEmail = 'user@example.com';
            const mockMessages = [
                {
                    id: 'msg1',
                    conversationId,
                    sender: 'user@example.com',
                    content: 'Hello',
                    timestamp: new Date().toISOString(),
                    isRead: false
                }
            ];
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId }
            };
            chatModel_1.getConversationByIdModel.mockResolvedValue({
                id: conversationId,
                participants: [userEmail, 'other@example.com']
            });
            chatModel_1.getMessagesByConversationModel.mockResolvedValue(mockMessages);
            chatModel_1.markConversationAsReadModel.mockResolvedValue(undefined);
            // Act
            yield (0, chatController_1.getMessages)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getConversationByIdModel).toHaveBeenCalledWith(conversationId);
            expect(chatModel_1.getMessagesByConversationModel).toHaveBeenCalledWith(conversationId);
            expect(chatModel_1.markConversationAsReadModel).toHaveBeenCalledWith(conversationId, userEmail);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockMessages
            });
        }));
    });
    describe('sendMessage', () => {
        it('should send message successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'conv123';
            const userEmail = 'user@example.com';
            const messageContent = 'Hello there';
            const mockMessage = {
                id: 'msg123',
                conversationId,
                sender: userEmail,
                content: messageContent,
                timestamp: new Date().toISOString(),
                isRead: false
            };
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId },
                body: { content: messageContent }
            };
            chatModel_1.getConversationByIdModel.mockResolvedValue({
                id: conversationId,
                participants: [userEmail, 'other@example.com']
            });
            chatModel_1.createMessageModel.mockResolvedValue(mockMessage);
            // Act
            yield (0, chatController_1.sendMessage)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getConversationByIdModel).toHaveBeenCalledWith(conversationId);
            expect(chatModel_1.createMessageModel).toHaveBeenCalledWith({
                conversationId,
                senderId: userEmail,
                senderName: 'Test User',
                content: messageContent,
                status: 'sent',
                type: 'text'
            });
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockMessage
            });
        }));
    });
    describe('markAsRead', () => {
        it('should mark message as read successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const messageId = 'msg123';
            const userEmail = 'user@example.com';
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { messageId }
            };
            chatModel_1.markMessageAsReadModel.mockResolvedValue(undefined);
            // Act
            yield (0, chatController_1.markAsRead)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.markMessageAsReadModel).toHaveBeenCalledWith(messageId);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: null
            });
        }));
    });
    describe('createConversation', () => {
        it('should create conversation successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            const participantEmail = 'other@example.com';
            const mockConversation = {
                id: 'conv123',
                participants: [userEmail, participantEmail],
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                body: { participants: [participantEmail] }
            };
            chatModel_1.getConversationBetweenUsersModel.mockResolvedValue(null);
            chatModel_1.createConversationModel.mockResolvedValue(mockConversation);
            // Act
            yield (0, chatController_1.createConversation)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getConversationBetweenUsersModel).toHaveBeenCalledWith(userEmail, participantEmail);
            expect(chatModel_1.createConversationModel).toHaveBeenCalledWith([userEmail, participantEmail]);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockConversation
            });
        }));
        it('should return error when participant email is missing', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                body: { participants: [] }
            };
            // Act
            yield (0, chatController_1.createConversation)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(400);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                error: 'Se requiere al menos un participante'
            });
        }));
    });
    describe('searchConversations', () => {
        it('should search conversations successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            const searchTerm = 'test';
            const mockConversations = [
                {
                    id: 'conv1',
                    participants: [userEmail, 'other@example.com'],
                    lastMessage: 'test message',
                    lastMessageTime: new Date().toISOString(),
                    unreadCount: 0,
                    isArchived: false
                }
            ];
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                query: { search: searchTerm }
            };
            chatModel_1.searchConversationsModel.mockResolvedValue(mockConversations);
            // Act
            yield (0, chatController_1.searchConversations)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.searchConversationsModel).toHaveBeenCalledWith(userEmail, {
                dateFrom: undefined,
                dateTo: undefined,
                search: searchTerm,
                unreadOnly: false
            });
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockConversations
            });
        }));
    });
    describe('deleteConversation', () => {
        it('should delete conversation successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'conv123';
            const userEmail = 'user@example.com';
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId }
            };
            chatModel_1.deleteConversationModel.mockResolvedValue(undefined);
            // Act
            yield (0, chatController_1.deleteConversation)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.deleteConversationModel).toHaveBeenCalledWith(conversationId, userEmail);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: null
            });
        }));
    });
    describe('archiveConversation', () => {
        it('should archive conversation successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'conv123';
            const userEmail = 'user@example.com';
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId }
            };
            chatModel_1.archiveConversationModel.mockResolvedValue(undefined);
            // Act
            yield (0, chatController_1.archiveConversation)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.archiveConversationModel).toHaveBeenCalledWith(conversationId, userEmail);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: null
            });
        }));
    });
    describe('getConversationById', () => {
        it('should return conversation by id successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'conv123';
            const userEmail = 'user@example.com';
            const mockConversation = {
                id: conversationId,
                participants: [userEmail, 'other@example.com'],
                lastMessage: 'Hello there',
                lastMessageTime: new Date().toISOString(),
                unreadCount: 2,
                isArchived: false,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId }
            };
            chatModel_1.getConversationByIdModel.mockResolvedValue(mockConversation);
            // Act
            yield (0, chatController_1.getConversationById)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getConversationByIdModel).toHaveBeenCalledWith(conversationId);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockConversation
            });
        }));
        it('should return 404 when conversation not found', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const conversationId = 'nonexistent';
            const userEmail = 'user@example.com';
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                },
                params: { conversationId }
            };
            chatModel_1.getConversationByIdModel.mockResolvedValue(null);
            // Act
            yield (0, chatController_1.getConversationById)(mockRequest, mockResponse);
            // Assert
            expect(mockStatus).toHaveBeenCalledWith(404);
            expect(mockJson).toHaveBeenCalledWith({
                success: false,
                error: 'Conversación no encontrada'
            });
        }));
    });
    describe('getChatStats', () => {
        it('should return chat stats successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            const mockStats = {
                totalConversations: 10,
                unreadMessages: 5,
                archivedConversations: 2,
                totalMessages: 150
            };
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                }
            };
            chatModel_1.getChatStatsModel.mockResolvedValue(mockStats);
            // Act
            yield (0, chatController_1.getChatStats)(mockRequest, mockResponse);
            // Assert
            expect(chatModel_1.getChatStatsModel).toHaveBeenCalledWith(userEmail);
            expect(mockJson).toHaveBeenCalledWith({
                success: true,
                data: mockStats
            });
        }));
    });
    describe('getAvailableUsers', () => {
        it('should return available users successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const userEmail = 'user@example.com';
            const mockUsers = [
                {
                    email: 'other@example.com',
                    name: 'Other User',
                    role: 'musician',
                    isOnline: true
                }
            ];
            mockRequest = {
                user: {
                    userId: 'user123',
                    userEmail: userEmail,
                    email: userEmail,
                    role: 'user',
                    name: 'Test User'
                }
            };
            // Mock the function that gets available users (this would need to be implemented)
            // For now, we'll just test the basic structure
            mockResponse.json = jest.fn();
            // Act
            yield (0, chatController_1.getAvailableUsers)(mockRequest, mockResponse);
            // Assert
            expect(mockResponse.json).toHaveBeenCalled();
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGNoYXRDb250cm9sbGVyLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUE2QkEsdUJBQXVCO0FBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDNUMsTUFBTSxFQUFFO1FBQ04sSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUNoQjtDQUNGLENBQUMsQ0FBQyxDQUFDO0FBcENKLGtFQVl1QztBQUN2QyxtREFhNkI7QUFZN0IsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM5QixJQUFJLFdBQTZCLENBQUM7SUFDbEMsSUFBSSxZQUErQixDQUFDO0lBQ3BDLElBQUksVUFBcUIsQ0FBQztJQUMxQixJQUFJLFFBQW1CLENBQUM7SUFFeEIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDeEMsUUFBUSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUN0QyxZQUFZLEdBQUc7WUFDYixNQUFNLEVBQUUsVUFBVTtZQUNsQixJQUFJLEVBQUUsUUFBUTtTQUNmLENBQUM7UUFDRixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLEVBQUUsQ0FBQywrQ0FBK0MsRUFBRSxHQUFTLEVBQUU7WUFDN0QsVUFBVTtZQUNWLE1BQU0sU0FBUyxHQUFHLGtCQUFrQixD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O1lBQy9DLFlBQVksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTlCLE1BQU07WUFDTixNQUFNLElBQUEsa0NBQWlCLEVBQUMsV0FBc0IsRUFBRSxZQUF3QixDQUFDLENBQUM7WUFFMUUsU0FBUztZQUNULE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUMvQyxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcc3JjXFxBUFBfTXVzc2lrT25cXEFQUF9NdXNzaWtPbl9FeHByZXNzXFxzcmNcXF9fdGVzdHNfX1xcY2hhdENvbnRyb2xsZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHtcbiAgZ2V0Q29udmVyc2F0aW9ucyxcbiAgZ2V0TWVzc2FnZXMsXG4gIHNlbmRNZXNzYWdlLFxuICBtYXJrQXNSZWFkLFxuICBjcmVhdGVDb252ZXJzYXRpb24sXG4gIHNlYXJjaENvbnZlcnNhdGlvbnMsXG4gIGRlbGV0ZUNvbnZlcnNhdGlvbixcbiAgYXJjaGl2ZUNvbnZlcnNhdGlvbixcbiAgZ2V0Q29udmVyc2F0aW9uQnlJZCxcbiAgZ2V0Q2hhdFN0YXRzLFxuICBnZXRBdmFpbGFibGVVc2Vyc1xufSBmcm9tICcuLi9jb250cm9sbGVycy9jaGF0Q29udHJvbGxlcic7XG5pbXBvcnQge1xuICBjcmVhdGVDb252ZXJzYXRpb25Nb2RlbCxcbiAgZ2V0Q29udmVyc2F0aW9uc0J5VXNlck1vZGVsLFxuICBnZXRDb252ZXJzYXRpb25CeUlkTW9kZWwsXG4gIGdldE1lc3NhZ2VzQnlDb252ZXJzYXRpb25Nb2RlbCxcbiAgY3JlYXRlTWVzc2FnZU1vZGVsLFxuICBtYXJrTWVzc2FnZUFzUmVhZE1vZGVsLFxuICBtYXJrQ29udmVyc2F0aW9uQXNSZWFkTW9kZWwsXG4gIHNlYXJjaENvbnZlcnNhdGlvbnNNb2RlbCxcbiAgZGVsZXRlQ29udmVyc2F0aW9uTW9kZWwsXG4gIGFyY2hpdmVDb252ZXJzYXRpb25Nb2RlbCxcbiAgZ2V0Q2hhdFN0YXRzTW9kZWwsXG4gIGdldENvbnZlcnNhdGlvbkJldHdlZW5Vc2Vyc01vZGVsLFxufSBmcm9tICcuLi9tb2RlbHMvY2hhdE1vZGVsJztcblxuLy8gTW9jayB0aGUgY2hhdCBtb2RlbHNcbmplc3QubW9jaygnLi4vbW9kZWxzL2NoYXRNb2RlbCcpO1xuamVzdC5tb2NrKCcuLi9zZXJ2aWNlcy9sb2dnZXJTZXJ2aWNlJywgKCkgPT4gKHtcbiAgbG9nZ2VyOiB7XG4gICAgaW5mbzogamVzdC5mbigpLFxuICAgIGVycm9yOiBqZXN0LmZuKCksXG4gICAgd2FybjogamVzdC5mbigpXG4gIH1cbn0pKTtcblxuZGVzY3JpYmUoJ0NoYXRDb250cm9sbGVyJywgKCkgPT4ge1xuICBsZXQgbW9ja1JlcXVlc3Q6IFBhcnRpYWw8UmVxdWVzdD47XG4gIGxldCBtb2NrUmVzcG9uc2U6IFBhcnRpYWw8UmVzcG9uc2U+O1xuICBsZXQgbW9ja1N0YXR1czogamVzdC5Nb2NrO1xuICBsZXQgbW9ja0pzb246IGplc3QuTW9jaztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrU3RhdHVzID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgbW9ja0pzb24gPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICBtb2NrUmVzcG9uc2UgPSB7XG4gICAgICBzdGF0dXM6IG1vY2tTdGF0dXMsXG4gICAgICBqc29uOiBtb2NrSnNvblxuICAgIH07XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRDb252ZXJzYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHVzZXIgY29udmVyc2F0aW9ucyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1c2VyRW1haWwgPSAndXNlckBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBtb2NrQ29udmVyc2F0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnY29udjEnLFxuICAgICAgICAgIHBhcnRpY2lwYW50czogWyd1c2VyQGV4YW1wbGUuY29tJywgJ290aGVyQGV4YW1wbGUuY29tJ10sXG4gICAgICAgICAgbGFzdE1lc3NhZ2U6ICdIZWxsbyB0aGVyZScsXG4gICAgICAgICAgbGFzdE1lc3NhZ2VUaW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdW5yZWFkQ291bnQ6IDIsXG4gICAgICAgICAgaXNBcmNoaXZlZDogZmFsc2UsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICBlbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAoZ2V0Q29udmVyc2F0aW9uc0J5VXNlck1vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0NvbnZlcnNhdGlvbnMpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGdldENvbnZlcnNhdGlvbnMobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoZ2V0Q29udmVyc2F0aW9uc0J5VXNlck1vZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh1c2VyRW1haWwpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IG1vY2tDb252ZXJzYXRpb25zXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIHdoZW4gdXNlciBpcyBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB1bmRlZmluZWRcbiAgICAgIH07XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgZ2V0Q29udmVyc2F0aW9ucyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDEpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1VzdWFyaW8gbm8gYXV0ZW50aWNhZG8nXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldE1lc3NhZ2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIG1lc3NhZ2VzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbklkID0gJ2NvbnYxMjMnO1xuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgbW9ja01lc3NhZ2VzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdtc2cxJyxcbiAgICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICBzZW5kZXI6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBjb250ZW50OiAnSGVsbG8nLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGlzUmVhZDogZmFsc2VcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICBlbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBwYXJhbXM6IHsgY29udmVyc2F0aW9uSWQgfVxuICAgICAgfTtcblxuICAgICAgKGdldENvbnZlcnNhdGlvbkJ5SWRNb2RlbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgaWQ6IGNvbnZlcnNhdGlvbklkLFxuICAgICAgICBwYXJ0aWNpcGFudHM6IFt1c2VyRW1haWwsICdvdGhlckBleGFtcGxlLmNvbSddXG4gICAgICB9KTtcbiAgICAgIChnZXRNZXNzYWdlc0J5Q29udmVyc2F0aW9uTW9kZWwgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrTWVzc2FnZXMpO1xuICAgICAgKG1hcmtDb252ZXJzYXRpb25Bc1JlYWRNb2RlbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgZ2V0TWVzc2FnZXMobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoZ2V0Q29udmVyc2F0aW9uQnlJZE1vZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb252ZXJzYXRpb25JZCk7XG4gICAgICBleHBlY3QoZ2V0TWVzc2FnZXNCeUNvbnZlcnNhdGlvbk1vZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb252ZXJzYXRpb25JZCk7XG4gICAgICBleHBlY3QobWFya0NvbnZlcnNhdGlvbkFzUmVhZE1vZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb252ZXJzYXRpb25JZCwgdXNlckVtYWlsKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBtb2NrTWVzc2FnZXNcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc2VuZE1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzZW5kIG1lc3NhZ2Ugc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY29udmVyc2F0aW9uSWQgPSAnY29udjEyMyc7XG4gICAgICBjb25zdCB1c2VyRW1haWwgPSAndXNlckBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBtZXNzYWdlQ29udGVudCA9ICdIZWxsbyB0aGVyZSc7XG4gICAgICBjb25zdCBtb2NrTWVzc2FnZSA9IHtcbiAgICAgICAgaWQ6ICdtc2cxMjMnLFxuICAgICAgICBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgc2VuZGVyOiB1c2VyRW1haWwsXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2VDb250ZW50LFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgaXNSZWFkOiBmYWxzZVxuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICBlbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBwYXJhbXM6IHsgY29udmVyc2F0aW9uSWQgfSxcbiAgICAgICAgYm9keTogeyBjb250ZW50OiBtZXNzYWdlQ29udGVudCB9XG4gICAgICB9O1xuXG4gICAgICAoZ2V0Q29udmVyc2F0aW9uQnlJZE1vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBpZDogY29udmVyc2F0aW9uSWQsXG4gICAgICAgIHBhcnRpY2lwYW50czogW3VzZXJFbWFpbCwgJ290aGVyQGV4YW1wbGUuY29tJ11cbiAgICAgIH0pO1xuICAgICAgKGNyZWF0ZU1lc3NhZ2VNb2RlbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tNZXNzYWdlKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBzZW5kTWVzc2FnZShtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChnZXRDb252ZXJzYXRpb25CeUlkTW9kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNvbnZlcnNhdGlvbklkKTtcbiAgICAgIGV4cGVjdChjcmVhdGVNZXNzYWdlTW9kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgIHNlbmRlcklkOiB1c2VyRW1haWwsXG4gICAgICAgIHNlbmRlck5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlQ29udGVudCxcbiAgICAgICAgc3RhdHVzOiAnc2VudCcsXG4gICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbW9ja01lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbWFya0FzUmVhZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG1hcmsgbWVzc2FnZSBhcyByZWFkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1lc3NhZ2VJZCA9ICdtc2cxMjMnO1xuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyBtZXNzYWdlSWQgfVxuICAgICAgfTtcblxuICAgICAgKG1hcmtNZXNzYWdlQXNSZWFkTW9kZWwgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IG1hcmtBc1JlYWQobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobWFya01lc3NhZ2VBc1JlYWRNb2RlbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobWVzc2FnZUlkKTtcbiAgICAgIGV4cGVjdChtb2NrSnNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBudWxsXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NyZWF0ZUNvbnZlcnNhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBjb252ZXJzYXRpb24gc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgcGFydGljaXBhbnRFbWFpbCA9ICdvdGhlckBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBtb2NrQ29udmVyc2F0aW9uID0ge1xuICAgICAgICBpZDogJ2NvbnYxMjMnLFxuICAgICAgICBwYXJ0aWNpcGFudHM6IFt1c2VyRW1haWwsIHBhcnRpY2lwYW50RW1haWxdLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgZW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogeyBwYXJ0aWNpcGFudHM6IFtwYXJ0aWNpcGFudEVtYWlsXSB9XG4gICAgICB9O1xuXG4gICAgICAoZ2V0Q29udmVyc2F0aW9uQmV0d2VlblVzZXJzTW9kZWwgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcbiAgICAgIChjcmVhdGVDb252ZXJzYXRpb25Nb2RlbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb252ZXJzYXRpb24pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNyZWF0ZUNvbnZlcnNhdGlvbihtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChnZXRDb252ZXJzYXRpb25CZXR3ZWVuVXNlcnNNb2RlbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgodXNlckVtYWlsLCBwYXJ0aWNpcGFudEVtYWlsKTtcbiAgICAgIGV4cGVjdChjcmVhdGVDb252ZXJzYXRpb25Nb2RlbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoW3VzZXJFbWFpbCwgcGFydGljaXBhbnRFbWFpbF0pO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IG1vY2tDb252ZXJzYXRpb25cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXJyb3Igd2hlbiBwYXJ0aWNpcGFudCBlbWFpbCBpcyBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IHsgcGFydGljaXBhbnRzOiBbXSB9XG4gICAgICB9O1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGNyZWF0ZUNvbnZlcnNhdGlvbihtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ1NlIHJlcXVpZXJlIGFsIG1lbm9zIHVuIHBhcnRpY2lwYW50ZSdcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc2VhcmNoQ29udmVyc2F0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNlYXJjaCBjb252ZXJzYXRpb25zIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9ICd1c2VyQGV4YW1wbGUuY29tJztcbiAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSAndGVzdCc7XG4gICAgICBjb25zdCBtb2NrQ29udmVyc2F0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnY29udjEnLFxuICAgICAgICAgIHBhcnRpY2lwYW50czogW3VzZXJFbWFpbCwgJ290aGVyQGV4YW1wbGUuY29tJ10sXG4gICAgICAgICAgbGFzdE1lc3NhZ2U6ICd0ZXN0IG1lc3NhZ2UnLFxuICAgICAgICAgIGxhc3RNZXNzYWdlVGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVucmVhZENvdW50OiAwLFxuICAgICAgICAgIGlzQXJjaGl2ZWQ6IGZhbHNlXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgZW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfSxcbiAgICAgICAgcXVlcnk6IHsgc2VhcmNoOiBzZWFyY2hUZXJtIH1cbiAgICAgIH07XG5cbiAgICAgIChzZWFyY2hDb252ZXJzYXRpb25zTW9kZWwgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29udmVyc2F0aW9ucyk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgc2VhcmNoQ29udmVyc2F0aW9ucyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChzZWFyY2hDb252ZXJzYXRpb25zTW9kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHVzZXJFbWFpbCwge1xuICAgICAgICBkYXRlRnJvbTogdW5kZWZpbmVkLFxuICAgICAgICBkYXRlVG86IHVuZGVmaW5lZCxcbiAgICAgICAgc2VhcmNoOiBzZWFyY2hUZXJtLFxuICAgICAgICB1bnJlYWRPbmx5OiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbW9ja0NvbnZlcnNhdGlvbnNcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVsZXRlQ29udmVyc2F0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIGNvbnZlcnNhdGlvbiBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25JZCA9ICdjb252MTIzJztcbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9ICd1c2VyQGV4YW1wbGUuY29tJztcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICBlbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBwYXJhbXM6IHsgY29udmVyc2F0aW9uSWQgfVxuICAgICAgfTtcblxuICAgICAgKGRlbGV0ZUNvbnZlcnNhdGlvbk1vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBkZWxldGVDb252ZXJzYXRpb24obW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoZGVsZXRlQ29udmVyc2F0aW9uTW9kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNvbnZlcnNhdGlvbklkLCB1c2VyRW1haWwpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IG51bGxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYXJjaGl2ZUNvbnZlcnNhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFyY2hpdmUgY29udmVyc2F0aW9uIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbklkID0gJ2NvbnYxMjMnO1xuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyBjb252ZXJzYXRpb25JZCB9XG4gICAgICB9O1xuXG4gICAgICAoYXJjaGl2ZUNvbnZlcnNhdGlvbk1vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBhcmNoaXZlQ29udmVyc2F0aW9uKG1vY2tSZXF1ZXN0IGFzIFJlcXVlc3QsIG1vY2tSZXNwb25zZSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KGFyY2hpdmVDb252ZXJzYXRpb25Nb2RlbCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoY29udmVyc2F0aW9uSWQsIHVzZXJFbWFpbCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbnVsbFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRDb252ZXJzYXRpb25CeUlkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbnZlcnNhdGlvbiBieSBpZCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBjb252ZXJzYXRpb25JZCA9ICdjb252MTIzJztcbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9ICd1c2VyQGV4YW1wbGUuY29tJztcbiAgICAgIGNvbnN0IG1vY2tDb252ZXJzYXRpb24gPSB7XG4gICAgICAgIGlkOiBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgcGFydGljaXBhbnRzOiBbdXNlckVtYWlsLCAnb3RoZXJAZXhhbXBsZS5jb20nXSxcbiAgICAgICAgbGFzdE1lc3NhZ2U6ICdIZWxsbyB0aGVyZScsXG4gICAgICAgIGxhc3RNZXNzYWdlVGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1bnJlYWRDb3VudDogMixcbiAgICAgICAgaXNBcmNoaXZlZDogZmFsc2UsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcblxuICAgICAgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMTIzJyxcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICBlbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJ1xuICAgICAgICB9LFxuICAgICAgICBwYXJhbXM6IHsgY29udmVyc2F0aW9uSWQgfVxuICAgICAgfTtcblxuICAgICAgKGdldENvbnZlcnNhdGlvbkJ5SWRNb2RlbCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDb252ZXJzYXRpb24pO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGF3YWl0IGdldENvbnZlcnNhdGlvbkJ5SWQobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoZ2V0Q29udmVyc2F0aW9uQnlJZE1vZGVsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb252ZXJzYXRpb25JZCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbW9ja0NvbnZlcnNhdGlvblxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgd2hlbiBjb252ZXJzYXRpb24gbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgY29udmVyc2F0aW9uSWQgPSAnbm9uZXhpc3RlbnQnO1xuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH0sXG4gICAgICAgIHBhcmFtczogeyBjb252ZXJzYXRpb25JZCB9XG4gICAgICB9O1xuXG4gICAgICAoZ2V0Q29udmVyc2F0aW9uQnlJZE1vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgYXdhaXQgZ2V0Q29udmVyc2F0aW9uQnlJZChtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrU3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDQpO1xuICAgICAgZXhwZWN0KG1vY2tKc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0NvbnZlcnNhY2nDs24gbm8gZW5jb250cmFkYSdcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0Q2hhdFN0YXRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNoYXQgc3RhdHMgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgdXNlckVtYWlsID0gJ3VzZXJAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgbW9ja1N0YXRzID0ge1xuICAgICAgICB0b3RhbENvbnZlcnNhdGlvbnM6IDEwLFxuICAgICAgICB1bnJlYWRNZXNzYWdlczogNSxcbiAgICAgICAgYXJjaGl2ZWRDb252ZXJzYXRpb25zOiAyLFxuICAgICAgICB0b3RhbE1lc3NhZ2VzOiAxNTBcbiAgICAgIH07XG5cbiAgICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgdXNlcklkOiAndXNlcjEyMycsXG4gICAgICAgICAgdXNlckVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgZW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgKGdldENoYXRTdGF0c01vZGVsIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N0YXRzKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBnZXRDaGF0U3RhdHMobW9ja1JlcXVlc3QgYXMgUmVxdWVzdCwgbW9ja1Jlc3BvbnNlIGFzIFJlc3BvbnNlKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QoZ2V0Q2hhdFN0YXRzTW9kZWwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHVzZXJFbWFpbCk7XG4gICAgICBleHBlY3QobW9ja0pzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbW9ja1N0YXRzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldEF2YWlsYWJsZVVzZXJzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGF2YWlsYWJsZSB1c2VycyBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCB1c2VyRW1haWwgPSAndXNlckBleGFtcGxlLmNvbSc7XG4gICAgICBjb25zdCBtb2NrVXNlcnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogJ290aGVyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICBuYW1lOiAnT3RoZXIgVXNlcicsXG4gICAgICAgICAgcm9sZTogJ211c2ljaWFuJyxcbiAgICAgICAgICBpc09ubGluZTogdHJ1ZVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBtb2NrUmVxdWVzdCA9IHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICAgIHVzZXJFbWFpbDogdXNlckVtYWlsLFxuICAgICAgICAgIGVtYWlsOiB1c2VyRW1haWwsXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vIE1vY2sgdGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBhdmFpbGFibGUgdXNlcnMgKHRoaXMgd291bGQgbmVlZCB0byBiZSBpbXBsZW1lbnRlZClcbiAgICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgdGVzdCB0aGUgYmFzaWMgc3RydWN0dXJlXG4gICAgICBtb2NrUmVzcG9uc2UuanNvbiA9IGplc3QuZm4oKTtcblxuICAgICAgLy8gQWN0XG4gICAgICBhd2FpdCBnZXRBdmFpbGFibGVVc2Vycyhtb2NrUmVxdWVzdCBhcyBSZXF1ZXN0LCBtb2NrUmVzcG9uc2UgYXMgUmVzcG9uc2UpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pOyAiXSwidmVyc2lvbiI6M30=