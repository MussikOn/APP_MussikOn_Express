{"file":"C:\\src\\APP_MussikOn\\APP_MussikOn_Express\\src\\__tests__\\ratingController.test.ts","mappings":"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","names":[],"sources":["C:\\src\\APP_MussikOn\\APP_MussikOn_Express\\src\\__tests__\\ratingController.test.ts"],"sourcesContent":["import { Request, Response } from 'express';\nimport { RatingController } from '../controllers/ratingController';\nimport { ratingService } from '../services/ratingService';\n\n// Mock the rating service\njest.mock('../services/ratingService');\njest.mock('../services/loggerService', () => ({\n  logger: {\n    info: jest.fn(),\n    error: jest.fn(),\n    warn: jest.fn()\n  }\n}));\n\ndescribe('RatingController', () => {\n  let ratingController: RatingController;\n  let mockRequest: Partial<Request>;\n  let mockResponse: Partial<Response>;\n  let mockStatus: jest.Mock;\n  let mockJson: jest.Mock;\n  let mockRatingService: jest.Mocked<typeof ratingService>;\n\n  beforeEach(() => {\n    mockStatus = jest.fn().mockReturnThis();\n    mockJson = jest.fn().mockReturnThis();\n    mockResponse = {\n      status: mockStatus,\n      json: mockJson\n    };\n\n    ratingController = new RatingController();\n    mockRatingService = ratingService as jest.Mocked<typeof ratingService>;\n\n    jest.clearAllMocks();\n  });\n\n  // Helper function para crear usuario mock válido\n  const createValidUser = (overrides = {}) => ({\n    id: 'user123',\n    userId: 'user123',\n    userEmail: 'user@example.com',\n    email: 'user@example.com',\n    role: 'user',\n    name: 'Test User',\n    ...overrides\n  });\n\n  // Helper function para crear rating data válido\n  const createValidRatingData = (overrides = {}) => ({\n    eventId: 'event123',\n    musicianId: 'musician123',\n    rating: 5,\n    review: 'Excellent performance!',\n    category: 'musician' as const,\n    ...overrides\n  });\n\n  describe('createRating', () => {\n    it('should create rating successfully', async () => {\n      // Arrange\n      const ratingData = createValidRatingData();\n      const mockRating = {\n        id: 'rating123',\n        eventId: 'event123',\n        musicianId: 'musician123',\n        eventCreatorId: 'user123',\n        rating: 5,\n        review: 'Excellent performance!',\n        category: 'musician' as const,\n        isVerified: false,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        helpfulCount: 0,\n        reportedCount: 0,\n        isActive: true\n      };\n\n      mockRequest = {\n        user: createValidUser(),\n        body: ratingData\n      };\n\n      mockRatingService.createRating.mockResolvedValue(mockRating);\n\n      // Act\n      await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.createRating).toHaveBeenCalledWith({\n        eventId: 'event123',\n        musicianId: 'musician123',\n        eventCreatorId: 'user123',\n        rating: 5,\n        review: 'Excellent performance!',\n        category: 'musician',\n        isVerified: false\n      });\n      expect(mockStatus).toHaveBeenCalledWith(201);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Rating creado exitosamente',\n        rating: mockRating\n      });\n    });\n\n    it('should return error when user is not authenticated', async () => {\n      // Arrange\n      const ratingData = createValidRatingData();\n      mockRequest = {\n        user: undefined,\n        body: ratingData\n      };\n\n      // Act\n      await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockStatus).toHaveBeenCalledWith(401);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: false,\n        message: 'Usuario no autenticado'\n      });\n    });\n\n    it('should return error when required fields are missing', async () => {\n      // Arrange\n      const ratingData = {\n        eventId: 'event123',\n        // Missing musicianId, rating, category\n        review: 'Excellent performance!'\n      };\n\n      mockRequest = {\n        user: createValidUser(),\n        body: ratingData\n      };\n\n      // Act\n      await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockStatus).toHaveBeenCalledWith(400);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: false,\n        message: 'Faltan campos requeridos: eventId, musicianId, rating, category'\n      });\n    });\n\n    // 🆕 TESTS MEJORADOS: Casos edge para rating\n    describe('rating validation edge cases', () => {\n      it.each([\n        { rating: 0, description: 'rating cero' },\n        { rating: -1, description: 'rating negativo' },\n        { rating: 6, description: 'rating mayor a 5' },\n        { rating: 5.5, description: 'rating decimal' },\n        { rating: NaN, description: 'rating NaN' },\n        { rating: Infinity, description: 'rating infinito' },\n        { rating: -Infinity, description: 'rating infinito negativo' }\n      ])('should return error for $description', async ({ rating }) => {\n        // Arrange\n        const ratingData = {\n          eventId: 'event123',\n          musicianId: 'musician123',\n          rating: rating,\n          review: 'Excellent performance!',\n          category: 'musician' as const\n        };\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockStatus).toHaveBeenCalledWith(400);\n        // Para rating 0 y NaN, el controlador devuelve \"Faltan campos requeridos\"\n        // Para otros valores, devuelve el mensaje específico\n        if (rating === 0 || isNaN(rating)) {\n          expect(mockJson).toHaveBeenCalledWith({\n            success: false,\n            message: 'Faltan campos requeridos: eventId, musicianId, rating, category'\n          });\n        } else {\n          expect(mockJson).toHaveBeenCalledWith({\n            success: false,\n            message: 'El rating debe estar entre 1 y 5 estrellas'\n          });\n        }\n      });\n\n      it.each([\n        { rating: 1, description: 'rating mínimo válido' },\n        { rating: 2, description: 'rating válido' },\n        { rating: 3, description: 'rating válido' },\n        { rating: 4, description: 'rating válido' },\n        { rating: 5, description: 'rating máximo válido' }\n      ])('should accept $description', async ({ rating }) => {\n        // Arrange\n        const ratingData = createValidRatingData({ rating });\n        const mockRating = {\n          id: 'rating123',\n          eventId: 'event123',\n          musicianId: 'musician123',\n          eventCreatorId: 'user123',\n          rating,\n          review: 'Excellent performance!',\n          category: 'musician' as const,\n          isVerified: false,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        };\n\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockResolvedValue(mockRating);\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockRatingService.createRating).toHaveBeenCalledWith(\n          expect.objectContaining({ rating })\n        );\n        expect(mockStatus).toHaveBeenCalledWith(201);\n      });\n    });\n\n    // 🆕 TESTS MEJORADOS: Validación de categorías\n    describe('category validation', () => {\n      it.each([\n        'invalid',\n        'musician_',\n        '_musician',\n        'MUSICIAN',\n        'Musician',\n        '',\n        null,\n        undefined\n      ])('should return error for invalid category: %s', async (category) => {\n        // Arrange\n        const ratingData = {\n          eventId: 'event123',\n          musicianId: 'musician123',\n          rating: 5,\n          review: 'Excellent performance!',\n          category: category\n        };\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockStatus).toHaveBeenCalledWith(400);\n        // Para categorías null, undefined o vacías, el controlador devuelve \"Faltan campos requeridos\"\n        // Para otros valores, devuelve el mensaje específico\n        if (category === null || category === undefined || category === '') {\n          expect(mockJson).toHaveBeenCalledWith({\n            success: false,\n            message: 'Faltan campos requeridos: eventId, musicianId, rating, category'\n          });\n        } else {\n          expect(mockJson).toHaveBeenCalledWith({\n            success: false,\n            message: 'Categoría debe ser \"musician\" o \"event_creator\"'\n          });\n        }\n      });\n\n      it.each(['musician', 'event_creator'])('should accept valid category: %s', async (category) => {\n        // Arrange\n        const ratingData = createValidRatingData({ category });\n        const mockRating = {\n          id: 'rating123',\n          eventId: 'event123',\n          musicianId: 'musician123',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review: 'Excellent performance!',\n          category: category as 'musician' | 'event_creator',\n          isVerified: false,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        };\n\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockResolvedValue(mockRating);\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockRatingService.createRating).toHaveBeenCalledWith(\n          expect.objectContaining({ category })\n        );\n        expect(mockStatus).toHaveBeenCalledWith(201);\n      });\n    });\n\n    // 🆕 TESTS MEJORADOS: Validación de IDs\n    describe('ID validation', () => {\n      it.each([\n        { field: 'eventId', value: '', description: 'eventId vacío' },\n        { field: 'eventId', value: null, description: 'eventId null' },\n        { field: 'eventId', value: undefined, description: 'eventId undefined' },\n        { field: 'musicianId', value: '', description: 'musicianId vacío' },\n        { field: 'musicianId', value: null, description: 'musicianId null' },\n        { field: 'musicianId', value: undefined, description: 'musicianId undefined' }\n      ])('should return error for $description', async ({ field, value }) => {\n        // Arrange\n        const ratingData = createValidRatingData({ [field]: value });\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockStatus).toHaveBeenCalledWith(400);\n        expect(mockJson).toHaveBeenCalledWith({\n          success: false,\n          message: 'Faltan campos requeridos: eventId, musicianId, rating, category'\n        });\n      });\n    });\n\n    // 🆕 TESTS MEJORADOS: Casos de error del servicio\n    describe('service error handling', () => {\n      it('should handle service throwing error', async () => {\n        // Arrange\n        const ratingData = createValidRatingData();\n        const serviceError = new Error('Database connection failed');\n        \n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockRejectedValue(serviceError);\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockStatus).toHaveBeenCalledWith(500);\n        expect(mockJson).toHaveBeenCalledWith({\n          success: false,\n          message: 'Database connection failed'\n        });\n      });\n\n      it('should handle unknown error type', async () => {\n        // Arrange\n        const ratingData = createValidRatingData();\n        \n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockRejectedValue('String error');\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockStatus).toHaveBeenCalledWith(500);\n        expect(mockJson).toHaveBeenCalledWith({\n          success: false,\n          message: 'Error interno del servidor'\n        });\n      });\n    });\n\n    // 🆕 TESTS MEJORADOS: Validación de review\n    describe('review validation', () => {\n      it('should accept review with special characters', async () => {\n        // Arrange\n        const review = '¡Excelente presentación! 🎵🎶 Muy profesional.';\n        const ratingData = createValidRatingData({ review });\n        const mockRating = {\n          id: 'rating123',\n          eventId: 'event123',\n          musicianId: 'musician123',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review,\n          category: 'musician' as const,\n          isVerified: false,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        };\n\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockResolvedValue(mockRating);\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockRatingService.createRating).toHaveBeenCalledWith(\n          expect.objectContaining({ review })\n        );\n        expect(mockStatus).toHaveBeenCalledWith(201);\n      });\n\n      it('should accept empty review', async () => {\n        // Arrange\n        const ratingData = createValidRatingData({ review: '' });\n        const mockRating = {\n          id: 'rating123',\n          eventId: 'event123',\n          musicianId: 'musician123',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review: '',\n          category: 'musician' as const,\n          isVerified: false,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        };\n\n        mockRequest = {\n          user: createValidUser(),\n          body: ratingData\n        };\n\n        mockRatingService.createRating.mockResolvedValue(mockRating);\n\n        // Act\n        await ratingController.createRating(mockRequest as Request, mockResponse as Response);\n\n        // Assert\n        expect(mockRatingService.createRating).toHaveBeenCalledWith(\n          expect.objectContaining({ review: '' })\n        );\n        expect(mockStatus).toHaveBeenCalledWith(201);\n      });\n    });\n  });\n\n  describe('getUserRatings', () => {\n    it('should return user ratings successfully', async () => {\n      // Arrange\n      const userId = 'user123';\n      const category = 'musician';\n      const mockRatings = [\n        {\n          id: 'rating1',\n          eventId: 'event1',\n          musicianId: 'musician1',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review: 'Great performance',\n          category: 'musician' as const,\n          isVerified: true,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        }\n      ];\n\n      mockRequest = {\n        params: { userId, category },\n        query: {\n          minRating: '4',\n          maxRating: '5',\n          isVerified: 'true'\n        }\n      };\n\n      mockRatingService.getUserRatings.mockResolvedValue(mockRatings);\n\n      // Act\n      await ratingController.getUserRatings(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getUserRatings).toHaveBeenCalledWith(userId, category, {\n        minRating: 4,\n        maxRating: 5,\n        isVerified: true,\n        dateFrom: undefined,\n        dateTo: undefined\n      });\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Ratings obtenidos exitosamente',\n        ratings: mockRatings,\n        count: mockRatings.length\n      });\n    });\n\n    it('should return error when required parameters are missing', async () => {\n      // Arrange\n      mockRequest = {\n        params: { userId: 'user123' }, // Missing category\n        query: {}\n      };\n\n      // Act\n      await ratingController.getUserRatings(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockStatus).toHaveBeenCalledWith(400);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: false,\n        message: 'Faltan parámetros requeridos: userId, category'\n      });\n    });\n  });\n\n  describe('getUserRatingStats', () => {\n    it('should return user rating stats successfully', async () => {\n      // Arrange\n      const userId = 'user123';\n      const category = 'musician';\n      const mockStats = {\n        totalRatings: 10,\n        averageRating: 4.5,\n        ratingDistribution: {\n          1: 0,\n          2: 1,\n          3: 2,\n          4: 4,\n          5: 3\n        },\n        verifiedRatings: 8,\n        totalReviews: 7,\n        recentRatings: [],\n        responseRate: 85.5\n      };\n\n      mockRequest = {\n        params: { userId, category }\n      };\n\n      mockRatingService.getUserRatingStats.mockResolvedValue(mockStats);\n\n      // Act\n      await ratingController.getUserRatingStats(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getUserRatingStats).toHaveBeenCalledWith(userId, category);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Estadísticas obtenidas exitosamente',\n        stats: mockStats\n      });\n    });\n  });\n\n  describe('updateRating', () => {\n    it('should update rating successfully', async () => {\n      // Arrange\n      const ratingId = 'rating123';\n      const updateData = {\n        rating: 4,\n        review: 'Updated review'\n      };\n\n      const mockUpdatedRating = {\n        id: ratingId,\n        eventId: 'event123',\n        musicianId: 'musician123',\n        eventCreatorId: 'user123',\n        rating: 4,\n        review: 'Updated review',\n        category: 'musician' as const,\n        isVerified: false,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        helpfulCount: 0,\n        reportedCount: 0,\n        isActive: true\n      };\n\n      mockRequest = {\n        user: {\n          id: 'user123',\n          userId: 'user123',\n          userEmail: 'user@example.com',\n          email: 'user@example.com',\n          role: 'user',\n          name: 'Test User'\n        },\n        params: { ratingId },\n        body: updateData\n      };\n\n      mockRatingService.getRatingById.mockResolvedValue({\n        id: ratingId,\n        eventId: 'event123',\n        musicianId: 'musician123',\n        eventCreatorId: 'user123',\n        rating: 3,\n        review: 'Original review',\n        category: 'musician',\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        isVerified: false,\n        helpfulCount: 0,\n        reportedCount: 0\n      });\n      mockRatingService.updateRating.mockResolvedValue(mockUpdatedRating);\n\n      // Act\n      await ratingController.updateRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.updateRating).toHaveBeenCalledWith(ratingId, updateData);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Rating actualizado exitosamente',\n        rating: mockUpdatedRating\n      });\n    });\n\n    it('should return error when rating is out of range', async () => {\n      // Arrange\n      const ratingId = 'rating123';\n      const updateData = {\n        rating: 6, // Invalid rating\n        review: 'Updated review'\n      };\n\n      const existingRating = {\n        id: ratingId,\n        eventId: 'event123',\n        musicianId: 'musician123',\n        eventCreatorId: 'user123',\n        rating: 4,\n        review: 'Original review',\n        category: 'musician' as const,\n        isVerified: false,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        helpfulCount: 0,\n        reportedCount: 0,\n        isActive: true\n      };\n\n      mockRequest = {\n        user: {\n          id: 'user123',\n          userId: 'user123',\n          userEmail: 'user@example.com',\n          email: 'user@example.com',\n          role: 'user',\n          name: 'Test User'\n        },\n        params: { ratingId },\n        body: updateData\n      };\n\n      mockRatingService.getRatingById.mockResolvedValue(existingRating);\n\n      // Act\n      await ratingController.updateRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockStatus).toHaveBeenCalledWith(400);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: false,\n        message: 'El rating debe estar entre 1 y 5 estrellas'\n      });\n    });\n  });\n\n  describe('markRatingAsHelpful', () => {\n    it('should mark rating as helpful successfully', async () => {\n      // Arrange\n      const ratingId = 'rating123';\n      const mockUpdatedRating = {\n        id: ratingId,\n        helpfulCount: 5,\n        isHelpful: true\n      };\n\n      mockRequest = {\n        user: {\n          id: 'user123',\n          userId: 'user123',\n          userEmail: 'user@example.com',\n          email: 'user@example.com',\n          role: 'user',\n          name: 'Test User'\n        },\n        params: { ratingId }\n      };\n\n      mockRatingService.markRatingAsHelpful.mockResolvedValue();\n\n      // Act\n      await ratingController.markRatingAsHelpful(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.markRatingAsHelpful).toHaveBeenCalledWith(ratingId);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Rating marcado como útil exitosamente'\n      });\n    });\n  });\n\n  describe('reportRating', () => {\n    it('should report rating successfully', async () => {\n      // Arrange\n      const ratingId = 'rating123';\n      const reportData = {\n        reason: 'inappropriate_content',\n        description: 'This rating contains inappropriate content'\n      };\n\n      mockRequest = {\n        user: {\n          id: 'user123',\n          userId: 'user123',\n          userEmail: 'user@example.com',\n          email: 'user@example.com',\n          role: 'user',\n          name: 'Test User'\n        },\n        params: { ratingId },\n        body: reportData\n      };\n\n      mockRatingService.reportRating.mockResolvedValue(undefined);\n\n      // Act\n      await ratingController.reportRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.reportRating).toHaveBeenCalledWith(ratingId, 'inappropriate_content');\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Rating reportado exitosamente'\n      });\n    });\n\n    it('should return error when reason is missing', async () => {\n      // Arrange\n      const ratingId = 'rating123';\n      const reportData = {\n        description: 'This rating contains inappropriate content'\n        // Missing reason\n      };\n\n      mockRequest = {\n        user: {\n          id: 'user123',\n          userId: 'user123',\n          userEmail: 'user@example.com',\n          email: 'user@example.com',\n          role: 'user',\n          name: 'Test User'\n        },\n        params: { ratingId },\n        body: reportData\n      };\n\n      // Act\n      await ratingController.reportRating(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockStatus).toHaveBeenCalledWith(400);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: false,\n        message: 'ID de rating y razón requeridos'\n      });\n    });\n  });\n\n  describe('getEventRatings', () => {\n    it('should return event ratings successfully', async () => {\n      // Arrange\n      const eventId = 'event123';\n      const mockRatings = [\n        {\n          id: 'rating1',\n          eventId: 'event123',\n          musicianId: 'musician1',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review: 'Great performance',\n          category: 'musician' as const,\n          isVerified: true,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          helpfulCount: 0,\n          reportedCount: 0,\n          isActive: true\n        }\n      ];\n\n      mockRequest = {\n        params: { eventId },\n        query: {\n          category: 'musician',\n          minRating: '4'\n        }\n      };\n\n      mockRatingService.getEventRatings.mockResolvedValue(mockRatings);\n\n      // Act\n      await ratingController.getEventRatings(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getEventRatings).toHaveBeenCalledWith(eventId);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Ratings del evento obtenidos exitosamente',\n        ratings: mockRatings,\n        count: mockRatings.length\n      });\n    });\n  });\n\n  describe('getTopRatedMusicians', () => {\n    it('should return top rated musicians successfully', async () => {\n      // Arrange\n      const mockMusicians = [\n        {\n          userId: 'musician1',\n          stats: {\n            averageRating: 4.8,\n            totalRatings: 50,\n            ratingDistribution: { 1: 0, 2: 1, 3: 2, 4: 15, 5: 32 },\n            recentRatings: [],\n            verifiedRatings: 45,\n            responseRate: 90.0\n          }\n        }\n      ];\n\n      mockRequest = {\n        query: {\n          limit: '10',\n          minRatings: '5'\n        }\n      };\n\n      mockRatingService.getTopRatedMusicians.mockResolvedValue(mockMusicians);\n\n      // Act\n      await ratingController.getTopRatedMusicians(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getTopRatedMusicians).toHaveBeenCalledWith(10, 5);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Top músicos obtenidos exitosamente',\n        musicians: mockMusicians,\n        count: mockMusicians.length\n      });\n    });\n  });\n\n  describe('getRatingTrends', () => {\n    it('should return rating trends successfully', async () => {\n      // Arrange\n      const mockTrends = {\n        averageRatingByDay: {\n          '2024-01-01': 4.2,\n          '2024-01-02': 4.5\n        },\n        totalRatingsByDay: {\n          '2024-01-01': 25,\n          '2024-01-02': 30\n        },\n        categoryDistribution: {\n          'musician': 60,\n          'event_creator': 40\n        }\n      };\n\n      mockRequest = {\n        query: {\n          period: 'monthly',\n          userId: 'user123'\n        }\n      };\n\n      mockRatingService.getRatingTrends.mockResolvedValue(mockTrends);\n\n      // Act\n      await ratingController.getRatingTrends(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getRatingTrends).toHaveBeenCalledWith(30);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Tendencias de rating obtenidas exitosamente',\n        trends: mockTrends\n      });\n    });\n  });\n\n  describe('getMostHelpfulRatings', () => {\n    it('should return most helpful ratings successfully', async () => {\n      // Arrange\n      const mockRatings = [\n        {\n          id: 'rating1',\n          eventId: 'event1',\n          musicianId: 'musician1',\n          eventCreatorId: 'user123',\n          rating: 5,\n          review: 'Very helpful review',\n          category: 'musician' as const,\n          helpfulCount: 10,\n          isVerified: true,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          reportedCount: 0,\n          isActive: true\n        }\n      ];\n\n      mockRequest = {\n        params: {\n          userId: 'user123',\n          category: 'musician'\n        },\n        query: {\n          limit: '5'\n        }\n      };\n\n      mockRatingService.getMostHelpfulRatings.mockResolvedValue(mockRatings);\n\n      // Act\n      await ratingController.getMostHelpfulRatings(mockRequest as Request, mockResponse as Response);\n\n      // Assert\n      expect(mockRatingService.getMostHelpfulRatings).toHaveBeenCalledWith('user123', 'musician', 5);\n      expect(mockJson).toHaveBeenCalledWith({\n        success: true,\n        message: 'Ratings más útiles obtenidos exitosamente',\n        ratings: mockRatings,\n        count: mockRatings.length\n      });\n    });\n  });\n}); "],"version":3}