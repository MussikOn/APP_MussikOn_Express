36117dbc258ec0c79d555b28a5418daf
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateIdFormat = exports.validateEmailFormat = exports.validateSafeString = exports.delay = exports.createTestData = exports.validateApiResponse = exports.createFirebaseMock = exports.cleanupMocks = exports.mockErrorHandler = exports.mockAuthMiddleware = exports.createMockResponse = exports.createMockRequest = void 0;
// Mock Firebase Admin
jest.mock('firebase-admin', () => ({
    initializeApp: jest.fn(),
    getApps: jest.fn(() => []),
    getApp: jest.fn(),
    apps: [], // Agregar esta propiedad
    credential: {
        cert: jest.fn()
    },
    auth: jest.fn(() => ({
        verifyIdToken: jest.fn(),
        createCustomToken: jest.fn(),
        getUser: jest.fn(),
        getUserByEmail: jest.fn(),
        listUsers: jest.fn(),
        createUser: jest.fn(),
        updateUser: jest.fn(),
        deleteUser: jest.fn(),
        setCustomUserClaims: jest.fn()
    })),
    firestore: jest.fn(() => ({
        collection: jest.fn(() => ({
            doc: jest.fn(() => ({
                get: jest.fn(),
                set: jest.fn(),
                update: jest.fn(),
                delete: jest.fn()
            })),
            where: jest.fn(() => ({
                get: jest.fn(),
                orderBy: jest.fn(() => ({
                    get: jest.fn(),
                    limit: jest.fn(() => ({
                        get: jest.fn()
                    }))
                }))
            })),
            orderBy: jest.fn(() => ({
                get: jest.fn(),
                limit: jest.fn(() => ({
                    get: jest.fn()
                }))
            })),
            limit: jest.fn(() => ({
                get: jest.fn()
            })),
            get: jest.fn()
        }))
    })),
    getFirestore: jest.fn(() => ({
        collection: jest.fn(() => ({
            doc: jest.fn(() => ({
                get: jest.fn(),
                set: jest.fn(),
                update: jest.fn(),
                delete: jest.fn()
            })),
            where: jest.fn(() => ({
                get: jest.fn(),
                orderBy: jest.fn(() => ({
                    get: jest.fn(),
                    limit: jest.fn(() => ({
                        get: jest.fn()
                    }))
                }))
            })),
            orderBy: jest.fn(() => ({
                get: jest.fn(),
                limit: jest.fn(() => ({
                    get: jest.fn()
                }))
            })),
            limit: jest.fn(() => ({
                get: jest.fn()
            })),
            get: jest.fn()
        }))
    }))
}));
// Jest setup file for MussikOn API tests
const dotenv_1 = __importDefault(require("dotenv"));
const loggerService_1 = require("../services/loggerService");
// Load environment variables for testing
dotenv_1.default.config({ path: '.env.test' });
// 🆕 CONFIGURACIÓN MEJORADA DEL SETUP
// Setup any global test configuration
loggerService_1.logger.info('Setting up test environment...', { context: 'TestSetup' });
// Mock console methods to reduce noise in tests
jest.spyOn(console, 'log').mockImplementation(() => { });
jest.spyOn(console, 'info').mockImplementation(() => { });
jest.spyOn(console, 'warn').mockImplementation(() => { });
jest.spyOn(console, 'error').mockImplementation(() => { });
// Global test utilities
const createMockRequest = (overrides = {}) => (Object.assign({ body: {}, params: {}, query: {}, headers: {}, user: null }, overrides));
exports.createMockRequest = createMockRequest;
const createMockResponse = () => {
    const res = {};
    res.status = jest.fn().mockReturnValue(res);
    res.json = jest.fn().mockReturnValue(res);
    res.send = jest.fn().mockReturnValue(res);
    res.end = jest.fn().mockReturnValue(res);
    return res;
};
exports.createMockResponse = createMockResponse;
// Mock middleware
const mockAuthMiddleware = (req, res, next) => {
    req.user = {
        id: 'test-user-id',
        email: 'test@example.com',
        role: 'usuario'
    };
    next();
};
exports.mockAuthMiddleware = mockAuthMiddleware;
// Mock error handler
const mockErrorHandler = (err, req, res, next) => {
    res.status(500).json({
        success: false,
        message: err.message || 'Internal server error'
    });
};
exports.mockErrorHandler = mockErrorHandler;
// 🆕 UTILIDADES ADICIONALES PARA TESTS MEJORADOS
// Función para limpiar mocks después de cada test
const cleanupMocks = () => {
    jest.clearAllMocks();
    jest.resetAllMocks();
};
exports.cleanupMocks = cleanupMocks;
// Función para crear un mock de Firebase más realista
const createFirebaseMock = () => ({
    collection: jest.fn().mockReturnValue({
        doc: jest.fn().mockReturnValue({
            get: jest.fn().mockResolvedValue({
                exists: true,
                data: jest.fn().mockReturnValue({})
            }),
            set: jest.fn().mockResolvedValue({}),
            update: jest.fn().mockResolvedValue({}),
            delete: jest.fn().mockResolvedValue({})
        }),
        where: jest.fn().mockReturnThis(),
        orderBy: jest.fn().mockReturnThis(),
        limit: jest.fn().mockReturnThis(),
        get: jest.fn().mockResolvedValue({
            docs: [],
            size: 0
        }),
        add: jest.fn().mockResolvedValue({
            id: 'generated-id'
        })
    })
});
exports.createFirebaseMock = createFirebaseMock;
// Función para validar respuestas de API
const validateApiResponse = (response, expectedSuccess, expectedMessage) => {
    expect(response).toHaveProperty('success', expectedSuccess);
    if (expectedMessage) {
        expect(response).toHaveProperty('message', expectedMessage);
    }
};
exports.validateApiResponse = validateApiResponse;
// Función para crear datos de prueba válidos
exports.createTestData = {
    user: {
        id: 'test-user-id',
        email: 'test@example.com',
        role: 'usuario',
        name: 'Test User'
    },
    rating: {
        eventId: 'event123',
        musicianId: 'musician123',
        rating: 5,
        review: 'Excellent performance!',
        category: 'musician'
    },
    payment: {
        amount: 1000,
        currency: 'RD$',
        description: 'Test payment'
    }
};
// Función para simular delays en tests
const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));
exports.delay = delay;
// Función para validar que un string no contenga caracteres peligrosos
const validateSafeString = (str) => {
    const dangerousPatterns = [
        /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, // XSS scripts
        /javascript:/gi, // JavaScript protocol
        /on\w+\s*=/gi, // Event handlers
        /data:text\/html/gi, // Data URLs
        /vbscript:/gi, // VBScript
        /expression\s*\(/gi, // CSS expressions
    ];
    return !dangerousPatterns.some(pattern => pattern.test(str));
};
exports.validateSafeString = validateSafeString;
// Función para validar formato de email
const validateEmailFormat = (email) => {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
};
exports.validateEmailFormat = validateEmailFormat;
// Función para validar formato de ID
const validateIdFormat = (id) => {
    const idRegex = /^[a-zA-Z0-9_-]{3,50}$/;
    return idRegex.test(id);
};
exports.validateIdFormat = validateIdFormat;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXHNldHVwLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQU9BLHNCQUFzQjtBQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDakMsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDeEIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDO0lBQzFCLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2pCLElBQUksRUFBRSxFQUFFLEVBQUUseUJBQXlCO0lBQ25DLFVBQVUsRUFBRTtRQUNWLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0tBQ2hCO0lBQ0QsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNuQixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUN4QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzVCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3pCLFNBQVMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3BCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3JCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3JCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3JCLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDL0IsQ0FBQyxDQUFDO0lBQ0gsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUN4QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFD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IjpbIkM6XFxzcmNcXEFQUF9NdXNzaWtPblxcQVBQX011c3Npa09uX0V4cHJlc3NcXHNyY1xcX190ZXN0c19fXFxzZXR1cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBKZXN0IHNldHVwIGZpbGUgZm9yIE11c3Npa09uIEFQSSB0ZXN0c1xyXG5pbXBvcnQgZG90ZW52IGZyb20gJ2RvdGVudic7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uL3NlcnZpY2VzL2xvZ2dlclNlcnZpY2UnO1xyXG5cclxuLy8gTG9hZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZm9yIHRlc3RpbmdcclxuZG90ZW52LmNvbmZpZyh7IHBhdGg6ICcuZW52LnRlc3QnIH0pO1xyXG5cclxuLy8gTW9jayBGaXJlYmFzZSBBZG1pblxyXG5qZXN0Lm1vY2soJ2ZpcmViYXNlLWFkbWluJywgKCkgPT4gKHtcclxuICBpbml0aWFsaXplQXBwOiBqZXN0LmZuKCksXHJcbiAgZ2V0QXBwczogamVzdC5mbigoKSA9PiBbXSksXHJcbiAgZ2V0QXBwOiBqZXN0LmZuKCksXHJcbiAgYXBwczogW10sIC8vIEFncmVnYXIgZXN0YSBwcm9waWVkYWRcclxuICBjcmVkZW50aWFsOiB7XHJcbiAgICBjZXJ0OiBqZXN0LmZuKClcclxuICB9LFxyXG4gIGF1dGg6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgIHZlcmlmeUlkVG9rZW46IGplc3QuZm4oKSxcclxuICAgIGNyZWF0ZUN1c3RvbVRva2VuOiBqZXN0LmZuKCksXHJcbiAgICBnZXRVc2VyOiBqZXN0LmZuKCksXHJcbiAgICBnZXRVc2VyQnlFbWFpbDogamVzdC5mbigpLFxyXG4gICAgbGlzdFVzZXJzOiBqZXN0LmZuKCksXHJcbiAgICBjcmVhdGVVc2VyOiBqZXN0LmZuKCksXHJcbiAgICB1cGRhdGVVc2VyOiBqZXN0LmZuKCksXHJcbiAgICBkZWxldGVVc2VyOiBqZXN0LmZuKCksXHJcbiAgICBzZXRDdXN0b21Vc2VyQ2xhaW1zOiBqZXN0LmZuKClcclxuICB9KSksXHJcbiAgZmlyZXN0b3JlOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICBjb2xsZWN0aW9uOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgIGRvYzogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgIGdldDogamVzdC5mbigpLFxyXG4gICAgICAgIHNldDogamVzdC5mbigpLFxyXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxyXG4gICAgICAgIGRlbGV0ZTogamVzdC5mbigpXHJcbiAgICAgIH0pKSxcclxuICAgICAgd2hlcmU6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgICBvcmRlckJ5OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgICAgIGxpbWl0OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICB9KSlcclxuICAgICAgfSkpLFxyXG4gICAgICBvcmRlckJ5OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgICAgICAgbGltaXQ6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICAgICAgfSkpXHJcbiAgICAgIH0pKSxcclxuICAgICAgbGltaXQ6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKVxyXG4gICAgICB9KSksXHJcbiAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICB9KSlcclxuICB9KSksXHJcbiAgZ2V0RmlyZXN0b3JlOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICBjb2xsZWN0aW9uOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgIGRvYzogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgIGdldDogamVzdC5mbigpLFxyXG4gICAgICAgIHNldDogamVzdC5mbigpLFxyXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLFxyXG4gICAgICAgIGRlbGV0ZTogamVzdC5mbigpXHJcbiAgICAgIH0pKSxcclxuICAgICAgd2hlcmU6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgICBvcmRlckJ5OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBnZXQ6IGplc3QuZm4oKSxcclxuICAgICAgICAgIGxpbWl0OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICB9KSlcclxuICAgICAgfSkpLFxyXG4gICAgICBvcmRlckJ5OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgICAgICAgbGltaXQ6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICAgICAgfSkpXHJcbiAgICAgIH0pKSxcclxuICAgICAgbGltaXQ6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICBnZXQ6IGplc3QuZm4oKVxyXG4gICAgICB9KSksXHJcbiAgICAgIGdldDogamVzdC5mbigpXHJcbiAgICB9KSlcclxuICB9KSlcclxufSkpO1xyXG5cclxuLy8g8J+GlSBDT05GSUdVUkFDScOTTiBNRUpPUkFEQSBERUwgU0VUVVBcclxuLy8gU2V0dXAgYW55IGdsb2JhbCB0ZXN0IGNvbmZpZ3VyYXRpb25cclxubG9nZ2VyLmluZm8oJ1NldHRpbmcgdXAgdGVzdCBlbnZpcm9ubWVudC4uLicsIHsgY29udGV4dDogJ1Rlc3RTZXR1cCcgfSk7XHJcblxyXG4vLyBNb2NrIGNvbnNvbGUgbWV0aG9kcyB0byByZWR1Y2Ugbm9pc2UgaW4gdGVzdHNcclxuamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcclxuamVzdC5zcHlPbihjb25zb2xlLCAnaW5mbycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XHJcbmplc3Quc3B5T24oY29uc29sZSwgJ3dhcm4nKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xyXG5qZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XHJcblxyXG4vLyBHbG9iYWwgdGVzdCB1dGlsaXRpZXNcclxuZXhwb3J0IGNvbnN0IGNyZWF0ZU1vY2tSZXF1ZXN0ID0gKG92ZXJyaWRlczogYW55ID0ge30pID0+ICh7XHJcbiAgYm9keToge30sXHJcbiAgcGFyYW1zOiB7fSxcclxuICBxdWVyeToge30sXHJcbiAgaGVhZGVyczoge30sXHJcbiAgdXNlcjogbnVsbCxcclxuICAuLi5vdmVycmlkZXNcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1Jlc3BvbnNlID0gKCkgPT4ge1xyXG4gIGNvbnN0IHJlczogYW55ID0ge307XHJcbiAgcmVzLnN0YXR1cyA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUocmVzKTtcclxuICByZXMuanNvbiA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUocmVzKTtcclxuICByZXMuc2VuZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUocmVzKTtcclxuICByZXMuZW5kID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShyZXMpO1xyXG4gIHJldHVybiByZXM7XHJcbn07XHJcblxyXG4vLyBNb2NrIG1pZGRsZXdhcmVcclxuZXhwb3J0IGNvbnN0IG1vY2tBdXRoTWlkZGxld2FyZSA9IChyZXE6IGFueSwgcmVzOiBhbnksIG5leHQ6IGFueSkgPT4ge1xyXG4gIHJlcS51c2VyID0ge1xyXG4gICAgaWQ6ICd0ZXN0LXVzZXItaWQnLFxyXG4gICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcclxuICAgIHJvbGU6ICd1c3VhcmlvJ1xyXG4gIH07XHJcbiAgbmV4dCgpO1xyXG59O1xyXG5cclxuLy8gTW9jayBlcnJvciBoYW5kbGVyXHJcbmV4cG9ydCBjb25zdCBtb2NrRXJyb3JIYW5kbGVyID0gKGVycjogYW55LCByZXE6IGFueSwgcmVzOiBhbnksIG5leHQ6IGFueSkgPT4ge1xyXG4gIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UgfHwgJ0ludGVybmFsIHNlcnZlciBlcnJvcidcclxuICB9KTtcclxufTtcclxuXHJcbi8vIPCfhpUgVVRJTElEQURFUyBBRElDSU9OQUxFUyBQQVJBIFRFU1RTIE1FSk9SQURPU1xyXG5cclxuLy8gRnVuY2nDs24gcGFyYSBsaW1waWFyIG1vY2tzIGRlc3B1w6lzIGRlIGNhZGEgdGVzdFxyXG5leHBvcnQgY29uc3QgY2xlYW51cE1vY2tzID0gKCkgPT4ge1xyXG4gIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gIGplc3QucmVzZXRBbGxNb2NrcygpO1xyXG59O1xyXG5cclxuLy8gRnVuY2nDs24gcGFyYSBjcmVhciB1biBtb2NrIGRlIEZpcmViYXNlIG3DoXMgcmVhbGlzdGFcclxuZXhwb3J0IGNvbnN0IGNyZWF0ZUZpcmViYXNlTW9jayA9ICgpID0+ICh7XHJcbiAgY29sbGVjdGlvbjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XHJcbiAgICBkb2M6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xyXG4gICAgICBnZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgICAgZXhpc3RzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe30pXHJcbiAgICAgIH0pLFxyXG4gICAgICBzZXQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7fSksXHJcbiAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHt9KSxcclxuICAgICAgZGVsZXRlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe30pXHJcbiAgICB9KSxcclxuICAgIHdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcclxuICAgIG9yZGVyQnk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgbGltaXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgZ2V0OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICBkb2NzOiBbXSxcclxuICAgICAgc2l6ZTogMFxyXG4gICAgfSksXHJcbiAgICBhZGQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgIGlkOiAnZ2VuZXJhdGVkLWlkJ1xyXG4gICAgfSlcclxuICB9KVxyXG59KTtcclxuXHJcbi8vIEZ1bmNpw7NuIHBhcmEgdmFsaWRhciByZXNwdWVzdGFzIGRlIEFQSVxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGVBcGlSZXNwb25zZSA9IChyZXNwb25zZTogYW55LCBleHBlY3RlZFN1Y2Nlc3M6IGJvb2xlYW4sIGV4cGVjdGVkTWVzc2FnZT86IHN0cmluZykgPT4ge1xyXG4gIGV4cGVjdChyZXNwb25zZSkudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3MnLCBleHBlY3RlZFN1Y2Nlc3MpO1xyXG4gIGlmIChleHBlY3RlZE1lc3NhZ2UpIHtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9IYXZlUHJvcGVydHkoJ21lc3NhZ2UnLCBleHBlY3RlZE1lc3NhZ2UpO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEZ1bmNpw7NuIHBhcmEgY3JlYXIgZGF0b3MgZGUgcHJ1ZWJhIHbDoWxpZG9zXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVUZXN0RGF0YSA9IHtcclxuICB1c2VyOiB7XHJcbiAgICBpZDogJ3Rlc3QtdXNlci1pZCcsXHJcbiAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxyXG4gICAgcm9sZTogJ3VzdWFyaW8nLFxyXG4gICAgbmFtZTogJ1Rlc3QgVXNlcidcclxuICB9LFxyXG4gIHJhdGluZzoge1xyXG4gICAgZXZlbnRJZDogJ2V2ZW50MTIzJyxcclxuICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEyMycsXHJcbiAgICByYXRpbmc6IDUsXHJcbiAgICByZXZpZXc6ICdFeGNlbGxlbnQgcGVyZm9ybWFuY2UhJyxcclxuICAgIGNhdGVnb3J5OiAnbXVzaWNpYW4nXHJcbiAgfSxcclxuICBwYXltZW50OiB7XHJcbiAgICBhbW91bnQ6IDEwMDAsXHJcbiAgICBjdXJyZW5jeTogJ1JEJCcsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgcGF5bWVudCdcclxuICB9XHJcbn07XHJcblxyXG4vLyBGdW5jacOzbiBwYXJhIHNpbXVsYXIgZGVsYXlzIGVuIHRlc3RzXHJcbmV4cG9ydCBjb25zdCBkZWxheSA9IChtczogbnVtYmVyKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcclxuXHJcbi8vIEZ1bmNpw7NuIHBhcmEgdmFsaWRhciBxdWUgdW4gc3RyaW5nIG5vIGNvbnRlbmdhIGNhcmFjdGVyZXMgcGVsaWdyb3Nvc1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGVTYWZlU3RyaW5nID0gKHN0cjogc3RyaW5nKSA9PiB7XHJcbiAgY29uc3QgZGFuZ2Vyb3VzUGF0dGVybnMgPSBbXHJcbiAgICAvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSwgLy8gWFNTIHNjcmlwdHNcclxuICAgIC9qYXZhc2NyaXB0Oi9naSwgLy8gSmF2YVNjcmlwdCBwcm90b2NvbFxyXG4gICAgL29uXFx3K1xccyo9L2dpLCAvLyBFdmVudCBoYW5kbGVyc1xyXG4gICAgL2RhdGE6dGV4dFxcL2h0bWwvZ2ksIC8vIERhdGEgVVJMc1xyXG4gICAgL3Zic2NyaXB0Oi9naSwgLy8gVkJTY3JpcHRcclxuICAgIC9leHByZXNzaW9uXFxzKlxcKC9naSwgLy8gQ1NTIGV4cHJlc3Npb25zXHJcbiAgXTtcclxuICBcclxuICByZXR1cm4gIWRhbmdlcm91c1BhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3Qoc3RyKSk7XHJcbn07XHJcblxyXG4vLyBGdW5jacOzbiBwYXJhIHZhbGlkYXIgZm9ybWF0byBkZSBlbWFpbFxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGVFbWFpbEZvcm1hdCA9IChlbWFpbDogc3RyaW5nKSA9PiB7XHJcbiAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xyXG4gIHJldHVybiBlbWFpbFJlZ2V4LnRlc3QoZW1haWwpO1xyXG59O1xyXG5cclxuLy8gRnVuY2nDs24gcGFyYSB2YWxpZGFyIGZvcm1hdG8gZGUgSURcclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlSWRGb3JtYXQgPSAoaWQ6IHN0cmluZykgPT4ge1xyXG4gIGNvbnN0IGlkUmVnZXggPSAvXlthLXpBLVowLTlfLV17Myw1MH0kLztcclxuICByZXR1cm4gaWRSZWdleC50ZXN0KGlkKTtcclxufTsgIl0sInZlcnNpb24iOjN9