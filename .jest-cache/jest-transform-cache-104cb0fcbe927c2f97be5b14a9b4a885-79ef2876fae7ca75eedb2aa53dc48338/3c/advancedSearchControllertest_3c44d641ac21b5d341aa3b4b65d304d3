2f5c3981dde276ff92715101d404ca70
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
// Mock de los servicios
jest.mock('../services/musicianStatusService');
jest.mock('../services/calendarConflictService');
jest.mock('../services/rateCalculationService');
const advancedSearchController_1 = require("../controllers/advancedSearchController");
const musicianStatusService_1 = require("../services/musicianStatusService");
describe('AdvancedSearchController', () => {
    let controller;
    let mockRequest;
    let mockResponse;
    beforeEach(() => {
        controller = new advancedSearchController_1.AdvancedSearchController();
        mockRequest = {
            body: {},
            params: {},
            query: {}
        };
        mockResponse = {
            status: jest.fn().mockReturnThis(),
            json: jest.fn().mockReturnThis()
        };
        // Limpiar todos los mocks
        jest.clearAllMocks();
    });
    describe('searchAvailableMusicians', () => {
        it('should return error when required parameters are missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {};
            yield controller.searchAvailableMusicians(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'Faltan parámetros requeridos: eventType, instrument, location, eventDate, duration'
            });
        }));
        it('should return empty results when no musicians are available', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {
                eventType: 'wedding',
                instrument: 'guitarra',
                location: 'Madrid',
                eventDate: '2024-12-25T20:00:00Z',
                duration: 120
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['musicianStatusService'], 'getOnlineMusicians').mockResolvedValue([]);
            yield controller.searchAvailableMusicians(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: {
                    availableMusicians: [],
                    unavailableMusicians: [],
                    conflicts: {},
                    message: 'No hay músicos disponibles en este momento'
                }
            });
        }));
        it('should return available musicians with rates', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {
                eventType: 'wedding',
                instrument: 'guitarra',
                location: 'Madrid',
                eventDate: '2024-12-25T20:00:00Z',
                duration: 120
            };
            const mockMusicians = [
                {
                    id: 'musician1',
                    musicianId: 'musician1',
                    isOnline: true,
                    lastSeen: new Date().toISOString(),
                    availability: { isAvailable: true },
                    preferences: {
                        eventTypes: ['wedding'],
                        instruments: ['guitarra'],
                        minBudget: 100,
                        maxBudget: 1000
                    },
                    performance: { rating: 4.5, responseTime: 30, totalEvents: 50, completedEvents: 45 },
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                }
            ];
            const mockRateResult = {
                baseRate: 50,
                finalRate: 150,
                breakdown: [],
                factors: {
                    baseRate: 50,
                    experienceMultiplier: 1.2,
                    demandMultiplier: 1.1,
                    locationMultiplier: 1.3,
                    eventTypeMultiplier: 1.5,
                    durationMultiplier: 1.0,
                    urgencyMultiplier: 1.0,
                    seasonalityMultiplier: 1.0
                },
                recommendations: { suggestedRate: 150, marketAverage: 120, competitorRates: [140, 160] }
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['musicianStatusService'], 'getOnlineMusicians').mockResolvedValue(mockMusicians);
            jest.spyOn(controller['calendarConflictService'], 'checkMultipleMusiciansAvailability').mockResolvedValue({
                availableMusicians: ['musician1'],
                unavailableMusicians: [],
                conflicts: {}
            });
            jest.spyOn(controller['rateCalculationService'], 'calculateRate').mockResolvedValue(mockRateResult);
            yield controller.searchAvailableMusicians(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: expect.objectContaining({
                    availableMusicians: expect.arrayContaining([
                        expect.objectContaining({
                            musicianId: 'musician1',
                            rate: 150,
                        }),
                    ]),
                }),
            });
        }));
    });
    describe('checkMusicianAvailability', () => {
        it('should return error when required parameters are missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {};
            yield controller.checkMusicianAvailability(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'Faltan parámetros requeridos: musicianId, eventDate, duration'
            });
        }));
        it('should return not found when musician does not exist', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {
                musicianId: 'nonexistent',
                eventDate: '2024-12-25T20:00:00Z',
                duration: 120
            };
            const mockMusicianStatusService = musicianStatusService_1.MusicianStatusService;
            mockMusicianStatusService.prototype.getStatus = jest.fn().mockResolvedValue(null);
            yield controller.checkMusicianAvailability(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(404);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'Músico no encontrado'
            });
        }));
        it('should return unavailable when musician is offline', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {
                musicianId: 'musician1',
                eventDate: '2024-12-25T20:00:00Z',
                duration: 120
            };
            const mockStatus = {
                id: 'musician1',
                musicianId: 'musician1',
                isOnline: false,
                lastSeen: new Date().toISOString(),
                availability: { isAvailable: false },
                preferences: {
                    eventTypes: [],
                    instruments: [],
                    minBudget: 0,
                    maxBudget: 10000
                },
                performance: {
                    rating: 0,
                    totalEvents: 0,
                    completedEvents: 0,
                    responseTime: 0
                },
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['musicianStatusService'], 'getStatus').mockResolvedValue(mockStatus);
            yield controller.checkMusicianAvailability(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: {
                    isAvailable: false,
                    reason: 'Músico no está online o no disponible',
                    status: mockStatus
                }
            });
        }));
    });
    describe('updateMusicianStatus', () => {
        it('should return error when musicianId is missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = {};
            yield controller.updateMusicianStatus(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'ID del músico requerido'
            });
        }));
        it('should update musician status successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = { musicianId: 'musician1' };
            mockRequest.body = {
                isOnline: true,
                currentLocation: { latitude: 40.4168, longitude: -3.7038 }
            };
            const mockUpdatedStatus = {
                id: 'musician1',
                musicianId: 'musician1',
                isOnline: true,
                lastSeen: new Date().toISOString(),
                currentLocation: { latitude: 40.4168, longitude: -3.7038 },
                availability: {
                    isAvailable: true,
                    maxDistance: 50
                },
                preferences: {
                    eventTypes: [],
                    instruments: [],
                    minBudget: 0,
                    maxBudget: 10000
                },
                performance: {
                    rating: 0,
                    totalEvents: 0,
                    completedEvents: 0,
                    responseTime: 0
                },
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['musicianStatusService'], 'updateStatus').mockResolvedValue(mockUpdatedStatus);
            yield controller.updateMusicianStatus(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: mockUpdatedStatus
            });
        }));
    });
    describe('musicianHeartbeat', () => {
        it('should return error when musicianId is missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = {};
            yield controller.musicianHeartbeat(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'ID del músico requerido'
            });
        }));
        it('should register heartbeat successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = { musicianId: 'musician1' };
            mockRequest.body = {
                location: { latitude: 40.4168, longitude: -3.7038 }
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['musicianStatusService'], 'heartbeat').mockResolvedValue(undefined);
            yield controller.musicianHeartbeat(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                message: 'Heartbeat registrado correctamente'
            });
        }));
    });
    describe('getDailyAvailability', () => {
        it('should return error when musicianId is missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = {};
            yield controller.getDailyAvailability(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'ID del músico requerido'
            });
        }));
        it('should return daily availability', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.params = { musicianId: 'musician1' };
            mockRequest.query = { date: '2024-12-25' };
            const mockAvailability = {
                date: new Date('2024-12-25'),
                busySlots: [],
                availableSlots: [
                    { startTime: new Date('2024-12-25T10:00:00'), endTime: new Date('2024-12-25T12:00:00'), duration: 120 }
                ]
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['calendarConflictService'], 'getDailyAvailability').mockResolvedValue(mockAvailability);
            yield controller.getDailyAvailability(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: mockAvailability
            });
        }));
    });
    describe('calculateMusicianRate', () => {
        it('should return error when required parameters are missing', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {};
            yield controller.calculateMusicianRate(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(400);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                message: 'Faltan parámetros requeridos'
            });
        }));
        it('should calculate rate successfully', () => __awaiter(void 0, void 0, void 0, function* () {
            mockRequest.body = {
                musicianId: 'musician1',
                eventType: 'wedding',
                duration: 120,
                location: 'Madrid',
                eventDate: '2024-12-25T20:00:00Z',
                instrument: 'guitarra'
            };
            const mockRateResult = {
                baseRate: 50,
                finalRate: 150,
                breakdown: [],
                factors: {
                    baseRate: 50,
                    experienceMultiplier: 1.2,
                    demandMultiplier: 1.1,
                    locationMultiplier: 1.3,
                    eventTypeMultiplier: 1.5,
                    durationMultiplier: 1.0,
                    urgencyMultiplier: 1.0,
                    seasonalityMultiplier: 1.0
                },
                recommendations: {
                    suggestedRate: 150,
                    marketAverage: 120,
                    competitorRates: [140, 160]
                }
            };
            // Mock de servicios usando la instancia del controlador
            jest.spyOn(controller['rateCalculationService'], 'calculateRate').mockResolvedValue(mockRateResult);
            yield controller.calculateMusicianRate(mockRequest, mockResponse);
            expect(mockResponse.status).toHaveBeenCalledWith(200);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: true,
                data: mockRateResult
            });
        }));
    });
    describe('calculateRelevanceScore', () => {
        it('should calculate relevance score correctly', () => {
            const musician = {
                status: {
                    performance: {
                        rating: 4.5,
                        responseTime: 30,
                        totalEvents: 50
                    }
                },
                rate: 150
            };
            const score = controller.calculateRelevanceScore(musician);
            // Score esperado: rating(36) + response(22.5) + price(5) + experience(10) = 73.5
            expect(score).toBeGreaterThan(0);
            expect(score).toBeLessThanOrEqual(100);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGFkdmFuY2VkU2VhcmNoQ29udHJvbGxlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBS0Esd0JBQXdCO0FBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsbUNBQW1DLENBQUMsQ0FBQztBQUMvQyxJQUFJLENBQUMsSUFBSSxDQUFDLHFDQUFxQyxDQUFDLENBQUM7QUFDakQsSUFBSSxDQUFDLElBQUksQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0FBUmhELHNGQUFtRjtBQUNuRiw2RUFBMEU7QUFTMUUsUUFBUSxDQUFDLDBCQUEwQixFQUFFLEdBQUcsRUFBRTtJQUN4QyxJQUFJLFVBQW9DLENBQUM7SUFDekMsSUFBSSxXQUFnQixDQUFDO0lBQ3JCLElBQUksWUFBaUIsQ0FBQztJQUV0QixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsVUFBVSxHQUFHLElBQUksbURBQXdCLEVBQUUsQ0FBQztRQUM1QyxXQUFXLEdBQUc7WUFDWixJQUFJLEVBQUUsRUFBRTtZQUNSLE1BQU0sRUFBRSxFQUFFO1lBQ1YsS0FBSyxFQUFFLEVBQUU7U0FDVixDQUFDO1FBQ0YsWUFBWSxHQUFHO1lBQ2IsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7WUFDbEMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7U0FDakMsQ0FBQztRQUVGLDBCQUEwQjtRQUMxQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxFQUFFO1FBQ3hDLEVBQUUsQ0FBQywwREFBMEQsRUFBRSxHQUFTLEVBQUU7WUFDeEUsV0FBVyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUM7WUFFdEIsTUFBTSxVQUFVLENBQUMsd0JBQXdCLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FB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QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU0sUUFBUSxHQUFHO2dCQUNmLE1BQU0sRUFBRTtvQkFDTixXQUFXLEVBQUU7d0JBQ1gsTUFBTSxFQUFFLEdBQUc7d0JBQ1gsWUFBWSxFQUFFLEVBQUU7d0JBQ2hCLFdBQVcsRUFBRSxFQUFFO3FCQUNoQjtpQkFDRjtnQkFDRCxJQUFJLEVBQUUsR0FBRzthQUNWLENBQUM7WUFFRixNQUFNLEtBQUssR0FBSSxVQUFrQixDQUFDLHVCQUF1QixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRXBFLGlGQUFpRjtZQUNqRixNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGFkdmFuY2VkU2VhcmNoQ29udHJvbGxlci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFkdmFuY2VkU2VhcmNoQ29udHJvbGxlciB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL2FkdmFuY2VkU2VhcmNoQ29udHJvbGxlcic7XHJcbmltcG9ydCB7IE11c2ljaWFuU3RhdHVzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL211c2ljaWFuU3RhdHVzU2VydmljZSc7XHJcbmltcG9ydCB7IENhbGVuZGFyQ29uZmxpY3RTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvY2FsZW5kYXJDb25mbGljdFNlcnZpY2UnO1xyXG5pbXBvcnQgeyBSYXRlQ2FsY3VsYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcmF0ZUNhbGN1bGF0aW9uU2VydmljZSc7XHJcblxyXG4vLyBNb2NrIGRlIGxvcyBzZXJ2aWNpb3NcclxuamVzdC5tb2NrKCcuLi9zZXJ2aWNlcy9tdXNpY2lhblN0YXR1c1NlcnZpY2UnKTtcclxuamVzdC5tb2NrKCcuLi9zZXJ2aWNlcy9jYWxlbmRhckNvbmZsaWN0U2VydmljZScpO1xyXG5qZXN0Lm1vY2soJy4uL3NlcnZpY2VzL3JhdGVDYWxjdWxhdGlvblNlcnZpY2UnKTtcclxuXHJcbmRlc2NyaWJlKCdBZHZhbmNlZFNlYXJjaENvbnRyb2xsZXInLCAoKSA9PiB7XHJcbiAgbGV0IGNvbnRyb2xsZXI6IEFkdmFuY2VkU2VhcmNoQ29udHJvbGxlcjtcclxuICBsZXQgbW9ja1JlcXVlc3Q6IGFueTtcclxuICBsZXQgbW9ja1Jlc3BvbnNlOiBhbnk7XHJcblxyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgY29udHJvbGxlciA9IG5ldyBBZHZhbmNlZFNlYXJjaENvbnRyb2xsZXIoKTtcclxuICAgIG1vY2tSZXF1ZXN0ID0ge1xyXG4gICAgICBib2R5OiB7fSxcclxuICAgICAgcGFyYW1zOiB7fSxcclxuICAgICAgcXVlcnk6IHt9XHJcbiAgICB9O1xyXG4gICAgbW9ja1Jlc3BvbnNlID0ge1xyXG4gICAgICBzdGF0dXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxyXG4gICAgICBqc29uOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBMaW1waWFyIHRvZG9zIGxvcyBtb2Nrc1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdzZWFyY2hBdmFpbGFibGVNdXNpY2lhbnMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlcnJvciB3aGVuIHJlcXVpcmVkIHBhcmFtZXRlcnMgYXJlIG1pc3NpbmcnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7fTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuc2VhcmNoQXZhaWxhYmxlTXVzaWNpYW5zKG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdGYWx0YW4gcGFyw6FtZXRyb3MgcmVxdWVyaWRvczogZXZlbnRUeXBlLCBpbnN0cnVtZW50LCBsb2NhdGlvbiwgZXZlbnREYXRlLCBkdXJhdGlvbidcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSByZXN1bHRzIHdoZW4gbm8gbXVzaWNpYW5zIGFyZSBhdmFpbGFibGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiAnd2VkZGluZycsXHJcbiAgICAgICAgaW5zdHJ1bWVudDogJ2d1aXRhcnJhJyxcclxuICAgICAgICBsb2NhdGlvbjogJ01hZHJpZCcsXHJcbiAgICAgICAgZXZlbnREYXRlOiAnMjAyNC0xMi0yNVQyMDowMDowMFonLFxyXG4gICAgICAgIGR1cmF0aW9uOiAxMjBcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgZGUgc2VydmljaW9zIHVzYW5kbyBsYSBpbnN0YW5jaWEgZGVsIGNvbnRyb2xhZG9yXHJcbiAgICAgIGplc3Quc3B5T24oY29udHJvbGxlclsnbXVzaWNpYW5TdGF0dXNTZXJ2aWNlJ10sICdnZXRPbmxpbmVNdXNpY2lhbnMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnNlYXJjaEF2YWlsYWJsZU11c2ljaWFucyhtb2NrUmVxdWVzdCwgbW9ja1Jlc3BvbnNlKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGF2YWlsYWJsZU11c2ljaWFuczogW10sXHJcbiAgICAgICAgICB1bmF2YWlsYWJsZU11c2ljaWFuczogW10sXHJcbiAgICAgICAgICBjb25mbGljdHM6IHt9LFxyXG4gICAgICAgICAgbWVzc2FnZTogJ05vIGhheSBtw7pzaWNvcyBkaXNwb25pYmxlcyBlbiBlc3RlIG1vbWVudG8nXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGF2YWlsYWJsZSBtdXNpY2lhbnMgd2l0aCByYXRlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QuYm9keSA9IHtcclxuICAgICAgICBldmVudFR5cGU6ICd3ZWRkaW5nJyxcclxuICAgICAgICBpbnN0cnVtZW50OiAnZ3VpdGFycmEnLFxyXG4gICAgICAgIGxvY2F0aW9uOiAnTWFkcmlkJyxcclxuICAgICAgICBldmVudERhdGU6ICcyMDI0LTEyLTI1VDIwOjAwOjAwWicsXHJcbiAgICAgICAgZHVyYXRpb246IDEyMFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbW9ja011c2ljaWFucyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogJ211c2ljaWFuMScsXHJcbiAgICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyxcclxuICAgICAgICAgIGlzT25saW5lOiB0cnVlLFxyXG4gICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIGF2YWlsYWJpbGl0eTogeyBpc0F2YWlsYWJsZTogdHJ1ZSB9LFxyXG4gICAgICAgICAgcHJlZmVyZW5jZXM6IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlczogWyd3ZWRkaW5nJ10sXHJcbiAgICAgICAgICAgIGluc3RydW1lbnRzOiBbJ2d1aXRhcnJhJ10sXHJcbiAgICAgICAgICAgIG1pbkJ1ZGdldDogMTAwLFxyXG4gICAgICAgICAgICBtYXhCdWRnZXQ6IDEwMDBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBwZXJmb3JtYW5jZTogeyByYXRpbmc6IDQuNSwgcmVzcG9uc2VUaW1lOiAzMCwgdG90YWxFdmVudHM6IDUwLCBjb21wbGV0ZWRFdmVudHM6IDQ1IH0sXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfVxyXG4gICAgICBdO1xyXG5cclxuICAgICAgY29uc3QgbW9ja1JhdGVSZXN1bHQgPSB7XHJcbiAgICAgICAgYmFzZVJhdGU6IDUwLFxyXG4gICAgICAgIGZpbmFsUmF0ZTogMTUwLFxyXG4gICAgICAgIGJyZWFrZG93bjogW10sXHJcbiAgICAgICAgZmFjdG9yczoge1xyXG4gICAgICAgICAgYmFzZVJhdGU6IDUwLFxyXG4gICAgICAgICAgZXhwZXJpZW5jZU11bHRpcGxpZXI6IDEuMixcclxuICAgICAgICAgIGRlbWFuZE11bHRpcGxpZXI6IDEuMSxcclxuICAgICAgICAgIGxvY2F0aW9uTXVsdGlwbGllcjogMS4zLFxyXG4gICAgICAgICAgZXZlbnRUeXBlTXVsdGlwbGllcjogMS41LFxyXG4gICAgICAgICAgZHVyYXRpb25NdWx0aXBsaWVyOiAxLjAsXHJcbiAgICAgICAgICB1cmdlbmN5TXVsdGlwbGllcjogMS4wLFxyXG4gICAgICAgICAgc2Vhc29uYWxpdHlNdWx0aXBsaWVyOiAxLjBcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlY29tbWVuZGF0aW9uczogeyBzdWdnZXN0ZWRSYXRlOiAxNTAsIG1hcmtldEF2ZXJhZ2U6IDEyMCwgY29tcGV0aXRvclJhdGVzOiBbMTQwLCAxNjBdIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgZGUgc2VydmljaW9zIHVzYW5kbyBsYSBpbnN0YW5jaWEgZGVsIGNvbnRyb2xhZG9yXHJcbiAgICAgIGplc3Quc3B5T24oY29udHJvbGxlclsnbXVzaWNpYW5TdGF0dXNTZXJ2aWNlJ10sICdnZXRPbmxpbmVNdXNpY2lhbnMnKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrTXVzaWNpYW5zKTtcclxuICAgICAgamVzdC5zcHlPbihjb250cm9sbGVyWydjYWxlbmRhckNvbmZsaWN0U2VydmljZSddLCAnY2hlY2tNdWx0aXBsZU11c2ljaWFuc0F2YWlsYWJpbGl0eScpLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBhdmFpbGFibGVNdXNpY2lhbnM6IFsnbXVzaWNpYW4xJ10sXHJcbiAgICAgICAgdW5hdmFpbGFibGVNdXNpY2lhbnM6IFtdLFxyXG4gICAgICAgIGNvbmZsaWN0czoge31cclxuICAgICAgfSk7XHJcbiAgICAgIGplc3Quc3B5T24oY29udHJvbGxlclsncmF0ZUNhbGN1bGF0aW9uU2VydmljZSddLCAnY2FsY3VsYXRlUmF0ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRlUmVzdWx0KTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuc2VhcmNoQXZhaWxhYmxlTXVzaWNpYW5zKG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgYXZhaWxhYmxlTXVzaWNpYW5zOiBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcclxuICAgICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEnLFxyXG4gICAgICAgICAgICAgIHJhdGU6IDE1MCxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICBdKSxcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NoZWNrTXVzaWNpYW5BdmFpbGFiaWxpdHknLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlcnJvciB3aGVuIHJlcXVpcmVkIHBhcmFtZXRlcnMgYXJlIG1pc3NpbmcnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7fTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuY2hlY2tNdXNpY2lhbkF2YWlsYWJpbGl0eShtb2NrUmVxdWVzdCwgbW9ja1Jlc3BvbnNlKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRmFsdGFuIHBhcsOhbWV0cm9zIHJlcXVlcmlkb3M6IG11c2ljaWFuSWQsIGV2ZW50RGF0ZSwgZHVyYXRpb24nXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbm90IGZvdW5kIHdoZW4gbXVzaWNpYW4gZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7XHJcbiAgICAgICAgbXVzaWNpYW5JZDogJ25vbmV4aXN0ZW50JyxcclxuICAgICAgICBldmVudERhdGU6ICcyMDI0LTEyLTI1VDIwOjAwOjAwWicsXHJcbiAgICAgICAgZHVyYXRpb246IDEyMFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbW9ja011c2ljaWFuU3RhdHVzU2VydmljZSA9IE11c2ljaWFuU3RhdHVzU2VydmljZSBhcyBqZXN0Lk1vY2tlZENsYXNzPHR5cGVvZiBNdXNpY2lhblN0YXR1c1NlcnZpY2U+O1xyXG4gICAgICBtb2NrTXVzaWNpYW5TdGF0dXNTZXJ2aWNlLnByb3RvdHlwZS5nZXRTdGF0dXMgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLmNoZWNrTXVzaWNpYW5BdmFpbGFiaWxpdHkobW9ja1JlcXVlc3QsIG1vY2tSZXNwb25zZSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDA0KTtcclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ03DunNpY28gbm8gZW5jb250cmFkbydcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiB1bmF2YWlsYWJsZSB3aGVuIG11c2ljaWFuIGlzIG9mZmxpbmUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7XHJcbiAgICAgICAgbXVzaWNpYW5JZDogJ211c2ljaWFuMScsXHJcbiAgICAgICAgZXZlbnREYXRlOiAnMjAyNC0xMi0yNVQyMDowMDowMFonLFxyXG4gICAgICAgIGR1cmF0aW9uOiAxMjBcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG1vY2tTdGF0dXMgPSB7XHJcbiAgICAgICAgaWQ6ICdtdXNpY2lhbjEnLFxyXG4gICAgICAgIG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEnLFxyXG4gICAgICAgIGlzT25saW5lOiBmYWxzZSxcclxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGF2YWlsYWJpbGl0eTogeyBpc0F2YWlsYWJsZTogZmFsc2UgfSxcclxuICAgICAgICBwcmVmZXJlbmNlczoge1xyXG4gICAgICAgICAgZXZlbnRUeXBlczogW10sXHJcbiAgICAgICAgICBpbnN0cnVtZW50czogW10sXHJcbiAgICAgICAgICBtaW5CdWRnZXQ6IDAsXHJcbiAgICAgICAgICBtYXhCdWRnZXQ6IDEwMDAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgcmF0aW5nOiAwLFxyXG4gICAgICAgICAgdG90YWxFdmVudHM6IDAsXHJcbiAgICAgICAgICBjb21wbGV0ZWRFdmVudHM6IDAsXHJcbiAgICAgICAgICByZXNwb25zZVRpbWU6IDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBNb2NrIGRlIHNlcnZpY2lvcyB1c2FuZG8gbGEgaW5zdGFuY2lhIGRlbCBjb250cm9sYWRvclxyXG4gICAgICBqZXN0LnNweU9uKGNvbnRyb2xsZXJbJ211c2ljaWFuU3RhdHVzU2VydmljZSddLCAnZ2V0U3RhdHVzJykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1N0YXR1cyk7XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLmNoZWNrTXVzaWNpYW5BdmFpbGFiaWxpdHkobW9ja1JlcXVlc3QsIG1vY2tSZXNwb25zZSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBpc0F2YWlsYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICByZWFzb246ICdNw7pzaWNvIG5vIGVzdMOhIG9ubGluZSBvIG5vIGRpc3BvbmlibGUnLFxyXG4gICAgICAgICAgc3RhdHVzOiBtb2NrU3RhdHVzXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgndXBkYXRlTXVzaWNpYW5TdGF0dXMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlcnJvciB3aGVuIG11c2ljaWFuSWQgaXMgbWlzc2luZycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QucGFyYW1zID0ge307XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLnVwZGF0ZU11c2ljaWFuU3RhdHVzKG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdJRCBkZWwgbcO6c2ljbyByZXF1ZXJpZG8nXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgbXVzaWNpYW4gc3RhdHVzIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QucGFyYW1zID0geyBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyB9O1xyXG4gICAgICBtb2NrUmVxdWVzdC5ib2R5ID0ge1xyXG4gICAgICAgIGlzT25saW5lOiB0cnVlLFxyXG4gICAgICAgIGN1cnJlbnRMb2NhdGlvbjogeyBsYXRpdHVkZTogNDAuNDE2OCwgbG9uZ2l0dWRlOiAtMy43MDM4IH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG1vY2tVcGRhdGVkU3RhdHVzID0ge1xyXG4gICAgICAgIGlkOiAnbXVzaWNpYW4xJyxcclxuICAgICAgICBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyxcclxuICAgICAgICBpc09ubGluZTogdHJ1ZSxcclxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGN1cnJlbnRMb2NhdGlvbjogeyBsYXRpdHVkZTogNDAuNDE2OCwgbG9uZ2l0dWRlOiAtMy43MDM4IH0sXHJcbiAgICAgICAgYXZhaWxhYmlsaXR5OiB7XHJcbiAgICAgICAgICBpc0F2YWlsYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIG1heERpc3RhbmNlOiA1MFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJlZmVyZW5jZXM6IHtcclxuICAgICAgICAgIGV2ZW50VHlwZXM6IFtdLFxyXG4gICAgICAgICAgaW5zdHJ1bWVudHM6IFtdLFxyXG4gICAgICAgICAgbWluQnVkZ2V0OiAwLFxyXG4gICAgICAgICAgbWF4QnVkZ2V0OiAxMDAwMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGVyZm9ybWFuY2U6IHtcclxuICAgICAgICAgIHJhdGluZzogMCxcclxuICAgICAgICAgIHRvdGFsRXZlbnRzOiAwLFxyXG4gICAgICAgICAgY29tcGxldGVkRXZlbnRzOiAwLFxyXG4gICAgICAgICAgcmVzcG9uc2VUaW1lOiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gTW9jayBkZSBzZXJ2aWNpb3MgdXNhbmRvIGxhIGluc3RhbmNpYSBkZWwgY29udHJvbGFkb3JcclxuICAgICAgamVzdC5zcHlPbihjb250cm9sbGVyWydtdXNpY2lhblN0YXR1c1NlcnZpY2UnXSwgJ3VwZGF0ZVN0YXR1cycpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVcGRhdGVkU3RhdHVzKTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlTXVzaWNpYW5TdGF0dXMobW9ja1JlcXVlc3QsIG1vY2tSZXNwb25zZSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBkYXRhOiBtb2NrVXBkYXRlZFN0YXR1c1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnbXVzaWNpYW5IZWFydGJlYXQnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlcnJvciB3aGVuIG11c2ljaWFuSWQgaXMgbWlzc2luZycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QucGFyYW1zID0ge307XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLm11c2ljaWFuSGVhcnRiZWF0KG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdJRCBkZWwgbcO6c2ljbyByZXF1ZXJpZG8nXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciBoZWFydGJlYXQgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxdWVzdC5wYXJhbXMgPSB7IG11c2ljaWFuSWQ6ICdtdXNpY2lhbjEnIH07XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7XHJcbiAgICAgICAgbG9jYXRpb246IHsgbGF0aXR1ZGU6IDQwLjQxNjgsIGxvbmdpdHVkZTogLTMuNzAzOCB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBNb2NrIGRlIHNlcnZpY2lvcyB1c2FuZG8gbGEgaW5zdGFuY2lhIGRlbCBjb250cm9sYWRvclxyXG4gICAgICBqZXN0LnNweU9uKGNvbnRyb2xsZXJbJ211c2ljaWFuU3RhdHVzU2VydmljZSddLCAnaGVhcnRiZWF0JykubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIubXVzaWNpYW5IZWFydGJlYXQobW9ja1JlcXVlc3QsIG1vY2tSZXNwb25zZSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoMjAwKTtcclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5qc29uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBtZXNzYWdlOiAnSGVhcnRiZWF0IHJlZ2lzdHJhZG8gY29ycmVjdGFtZW50ZSdcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2dldERhaWx5QXZhaWxhYmlsaXR5JywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXJyb3Igd2hlbiBtdXNpY2lhbklkIGlzIG1pc3NpbmcnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LnBhcmFtcyA9IHt9O1xyXG5cclxuICAgICAgYXdhaXQgY29udHJvbGxlci5nZXREYWlseUF2YWlsYWJpbGl0eShtb2NrUmVxdWVzdCwgbW9ja1Jlc3BvbnNlKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnSUQgZGVsIG3DunNpY28gcmVxdWVyaWRvJ1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGRhaWx5IGF2YWlsYWJpbGl0eScsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QucGFyYW1zID0geyBtdXNpY2lhbklkOiAnbXVzaWNpYW4xJyB9O1xyXG4gICAgICBtb2NrUmVxdWVzdC5xdWVyeSA9IHsgZGF0ZTogJzIwMjQtMTItMjUnIH07XHJcblxyXG4gICAgICBjb25zdCBtb2NrQXZhaWxhYmlsaXR5ID0ge1xyXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKCcyMDI0LTEyLTI1JyksXHJcbiAgICAgICAgYnVzeVNsb3RzOiBbXSxcclxuICAgICAgICBhdmFpbGFibGVTbG90czogW1xyXG4gICAgICAgICAgeyBzdGFydFRpbWU6IG5ldyBEYXRlKCcyMDI0LTEyLTI1VDEwOjAwOjAwJyksIGVuZFRpbWU6IG5ldyBEYXRlKCcyMDI0LTEyLTI1VDEyOjAwOjAwJyksIGR1cmF0aW9uOiAxMjAgfVxyXG4gICAgICAgIF1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgZGUgc2VydmljaW9zIHVzYW5kbyBsYSBpbnN0YW5jaWEgZGVsIGNvbnRyb2xhZG9yXHJcbiAgICAgIGplc3Quc3B5T24oY29udHJvbGxlclsnY2FsZW5kYXJDb25mbGljdFNlcnZpY2UnXSwgJ2dldERhaWx5QXZhaWxhYmlsaXR5JykubW9ja1Jlc29sdmVkVmFsdWUobW9ja0F2YWlsYWJpbGl0eSk7XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLmdldERhaWx5QXZhaWxhYmlsaXR5KG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YTogbW9ja0F2YWlsYWJpbGl0eVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnY2FsY3VsYXRlTXVzaWNpYW5SYXRlJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZXJyb3Igd2hlbiByZXF1aXJlZCBwYXJhbWV0ZXJzIGFyZSBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrUmVxdWVzdC5ib2R5ID0ge307XHJcblxyXG4gICAgICBhd2FpdCBjb250cm9sbGVyLmNhbGN1bGF0ZU11c2ljaWFuUmF0ZShtb2NrUmVxdWVzdCwgbW9ja1Jlc3BvbnNlKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0MDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRmFsdGFuIHBhcsOhbWV0cm9zIHJlcXVlcmlkb3MnXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcmF0ZSBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tSZXF1ZXN0LmJvZHkgPSB7XHJcbiAgICAgICAgbXVzaWNpYW5JZDogJ211c2ljaWFuMScsXHJcbiAgICAgICAgZXZlbnRUeXBlOiAnd2VkZGluZycsXHJcbiAgICAgICAgZHVyYXRpb246IDEyMCxcclxuICAgICAgICBsb2NhdGlvbjogJ01hZHJpZCcsXHJcbiAgICAgICAgZXZlbnREYXRlOiAnMjAyNC0xMi0yNVQyMDowMDowMFonLFxyXG4gICAgICAgIGluc3RydW1lbnQ6ICdndWl0YXJyYSdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IG1vY2tSYXRlUmVzdWx0ID0ge1xyXG4gICAgICAgIGJhc2VSYXRlOiA1MCxcclxuICAgICAgICBmaW5hbFJhdGU6IDE1MCxcclxuICAgICAgICBicmVha2Rvd246IFtdLFxyXG4gICAgICAgIGZhY3RvcnM6IHtcclxuICAgICAgICAgIGJhc2VSYXRlOiA1MCxcclxuICAgICAgICAgIGV4cGVyaWVuY2VNdWx0aXBsaWVyOiAxLjIsXHJcbiAgICAgICAgICBkZW1hbmRNdWx0aXBsaWVyOiAxLjEsXHJcbiAgICAgICAgICBsb2NhdGlvbk11bHRpcGxpZXI6IDEuMyxcclxuICAgICAgICAgIGV2ZW50VHlwZU11bHRpcGxpZXI6IDEuNSxcclxuICAgICAgICAgIGR1cmF0aW9uTXVsdGlwbGllcjogMS4wLFxyXG4gICAgICAgICAgdXJnZW5jeU11bHRpcGxpZXI6IDEuMCxcclxuICAgICAgICAgIHNlYXNvbmFsaXR5TXVsdGlwbGllcjogMS4wXHJcbiAgICAgICAgfSxcclxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IHtcclxuICAgICAgICAgIHN1Z2dlc3RlZFJhdGU6IDE1MCxcclxuICAgICAgICAgIG1hcmtldEF2ZXJhZ2U6IDEyMCxcclxuICAgICAgICAgIGNvbXBldGl0b3JSYXRlczogWzE0MCwgMTYwXVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgZGUgc2VydmljaW9zIHVzYW5kbyBsYSBpbnN0YW5jaWEgZGVsIGNvbnRyb2xhZG9yXHJcbiAgICAgIGplc3Quc3B5T24oY29udHJvbGxlclsncmF0ZUNhbGN1bGF0aW9uU2VydmljZSddLCAnY2FsY3VsYXRlUmF0ZScpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXRlUmVzdWx0KTtcclxuXHJcbiAgICAgIGF3YWl0IGNvbnRyb2xsZXIuY2FsY3VsYXRlTXVzaWNpYW5SYXRlKG1vY2tSZXF1ZXN0LCBtb2NrUmVzcG9uc2UpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwMCk7XHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2UuanNvbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YTogbW9ja1JhdGVSZXN1bHRcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcmVsZXZhbmNlIHNjb3JlIGNvcnJlY3RseScsICgpID0+IHtcclxuICAgICAgY29uc3QgbXVzaWNpYW4gPSB7XHJcbiAgICAgICAgc3RhdHVzOiB7XHJcbiAgICAgICAgICBwZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgICByYXRpbmc6IDQuNSxcclxuICAgICAgICAgICAgcmVzcG9uc2VUaW1lOiAzMCxcclxuICAgICAgICAgICAgdG90YWxFdmVudHM6IDUwXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICByYXRlOiAxNTBcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHNjb3JlID0gKGNvbnRyb2xsZXIgYXMgYW55KS5jYWxjdWxhdGVSZWxldmFuY2VTY29yZShtdXNpY2lhbik7XHJcblxyXG4gICAgICAvLyBTY29yZSBlc3BlcmFkbzogcmF0aW5nKDM2KSArIHJlc3BvbnNlKDIyLjUpICsgcHJpY2UoNSkgKyBleHBlcmllbmNlKDEwKSA9IDczLjVcclxuICAgICAgZXhwZWN0KHNjb3JlKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdChzY29yZSkudG9CZUxlc3NUaGFuT3JFcXVhbCgxMDApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pOyAiXSwidmVyc2lvbiI6M30=