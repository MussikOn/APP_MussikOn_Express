cdbf4e32d8762d93890618aab758aee4
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const firestoreIndexes_1 = require("../utils/firestoreIndexes");
describe('FirestoreIndexManager', () => {
    beforeEach(() => {
        // Limpiar mocks
        jest.clearAllMocks();
    });
    describe('initializeIndexes', () => {
        it('should log required indexes information', () => __awaiter(void 0, void 0, void 0, function* () {
            // Arrange
            const consoleSpy = jest.spyOn(console, 'info').mockImplementation();
            // Act
            yield firestoreIndexes_1.FirestoreIndexManager.initializeIndexes();
            // Assert
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('🔧 Verificando configuración de índices de Firestore...'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('📋 Índice requerido: bank_accounts - bank_accounts_user_default_created'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('   Campos: userId(ASCENDING), isDefault(DESCENDING), createdAt(DESCENDING)'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('📋 Índice requerido: user_deposits - user_deposits_status_created'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('   Campos: status(ASCENDING), createdAt(DESCENDING)'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('📋 Índice requerido: withdrawal_requests - withdrawal_requests_status_created'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('   Campos: status(ASCENDING), createdAt(DESCENDING)'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('📋 Índice requerido: musician_earnings - musician_earnings_musician_created'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('   Campos: musicianId(ASCENDING), createdAt(DESCENDING)'));
            expect(consoleSpy).toHaveBeenCalledWith(expect.stringContaining('✅ Verificación de índices completada. Los índices deben crearse manualmente en Firebase Console.'));
            // Cleanup
            consoleSpy.mockRestore();
        }));
    });
    describe('getRequiredIndexes', () => {
        it('should return all required indexes configuration', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            // Assert
            expect(indexes).toHaveProperty('bank_accounts');
            expect(indexes).toHaveProperty('user_deposits');
            expect(indexes).toHaveProperty('withdrawal_requests');
            expect(indexes).toHaveProperty('musician_earnings');
            // Verify bank_accounts index
            expect(indexes.bank_accounts).toHaveLength(1);
            expect(indexes.bank_accounts[0]).toEqual({
                name: 'bank_accounts_user_default_created',
                fields: [
                    { fieldPath: 'userId', order: 'ASCENDING' },
                    { fieldPath: 'isDefault', order: 'DESCENDING' },
                    { fieldPath: 'createdAt', order: 'DESCENDING' }
                ]
            });
            // Verify user_deposits index
            expect(indexes.user_deposits).toHaveLength(1);
            expect(indexes.user_deposits[0]).toEqual({
                name: 'user_deposits_status_created',
                fields: [
                    { fieldPath: 'status', order: 'ASCENDING' },
                    { fieldPath: 'createdAt', order: 'DESCENDING' }
                ]
            });
            // Verify withdrawal_requests index
            expect(indexes.withdrawal_requests).toHaveLength(1);
            expect(indexes.withdrawal_requests[0]).toEqual({
                name: 'withdrawal_requests_status_created',
                fields: [
                    { fieldPath: 'status', order: 'ASCENDING' },
                    { fieldPath: 'createdAt', order: 'DESCENDING' }
                ]
            });
            // Verify musician_earnings index
            expect(indexes.musician_earnings).toHaveLength(1);
            expect(indexes.musician_earnings[0]).toEqual({
                name: 'musician_earnings_musician_created',
                fields: [
                    { fieldPath: 'musicianId', order: 'ASCENDING' },
                    { fieldPath: 'createdAt', order: 'DESCENDING' }
                ]
            });
        });
    });
    describe('isIndexConfigured', () => {
        it('should return true for configured indexes', () => {
            // Act & Assert
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('bank_accounts', 'bank_accounts_user_default_created')).toBe(true);
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('user_deposits', 'user_deposits_status_created')).toBe(true);
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('withdrawal_requests', 'withdrawal_requests_status_created')).toBe(true);
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('musician_earnings', 'musician_earnings_musician_created')).toBe(true);
        });
        it('should return false for non-configured indexes', () => {
            // Act & Assert
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('bank_accounts', 'non_existent_index')).toBe(false);
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('non_existent_collection', 'some_index')).toBe(false);
        });
        it('should return false for non-existent collections', () => {
            // Act & Assert
            expect(firestoreIndexes_1.FirestoreIndexManager.isIndexConfigured('non_existent_collection', 'bank_accounts_user_default_created')).toBe(false);
        });
    });
    describe('getIndexesForCollection', () => {
        it('should return indexes for existing collections', () => {
            // Act
            const bankAccountsIndexes = firestoreIndexes_1.FirestoreIndexManager.getIndexesForCollection('bank_accounts');
            const userDepositsIndexes = firestoreIndexes_1.FirestoreIndexManager.getIndexesForCollection('user_deposits');
            const withdrawalRequestsIndexes = firestoreIndexes_1.FirestoreIndexManager.getIndexesForCollection('withdrawal_requests');
            const musicianEarningsIndexes = firestoreIndexes_1.FirestoreIndexManager.getIndexesForCollection('musician_earnings');
            // Assert
            expect(bankAccountsIndexes).toHaveLength(1);
            expect(bankAccountsIndexes[0].name).toBe('bank_accounts_user_default_created');
            expect(userDepositsIndexes).toHaveLength(1);
            expect(userDepositsIndexes[0].name).toBe('user_deposits_status_created');
            expect(withdrawalRequestsIndexes).toHaveLength(1);
            expect(withdrawalRequestsIndexes[0].name).toBe('withdrawal_requests_status_created');
            expect(musicianEarningsIndexes).toHaveLength(1);
            expect(musicianEarningsIndexes[0].name).toBe('musician_earnings_musician_created');
        });
        it('should return empty array for non-existent collections', () => {
            // Act
            const nonExistentIndexes = firestoreIndexes_1.FirestoreIndexManager.getIndexesForCollection('non_existent_collection');
            // Assert
            expect(nonExistentIndexes).toEqual([]);
        });
    });
    describe('checkIndexStatus', () => {
        it('should return simulated index status', () => __awaiter(void 0, void 0, void 0, function* () {
            // Act
            const status = yield firestoreIndexes_1.FirestoreIndexManager.checkIndexStatus();
            // Assert
            expect(status).toEqual({
                'bank_accounts_bank_accounts_user_default_created': true,
                'user_deposits_user_deposits_status_created': true,
                'withdrawal_requests_withdrawal_requests_status_created': true,
                'musician_earnings_musician_earnings_musician_created': true
            });
        }));
    });
    describe('generateIndexCreationUrl', () => {
        it('should generate URL for bank_accounts index', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('bank_accounts', 'bank_accounts_user_default_created');
            // Assert
            expect(url).toContain('https://console.firebase.google.com/project/_/firestore/indexes');
            expect(url).toContain('create_composite=bank_accounts');
            expect(url).toContain('query_mode=COLLECTION');
            expect(url).toContain('fields=userId:ascending,isDefault:descending,createdAt:descending');
        });
        it('should generate URL for user_deposits index', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('user_deposits', 'user_deposits_status_created');
            // Assert
            expect(url).toContain('create_composite=user_deposits');
            expect(url).toContain('fields=status:ascending,createdAt:descending');
        });
        it('should generate URL for withdrawal_requests index', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('withdrawal_requests', 'withdrawal_requests_status_created');
            // Assert
            expect(url).toContain('create_composite=withdrawal_requests');
            expect(url).toContain('fields=status:ascending,createdAt:descending');
        });
        it('should generate URL for musician_earnings index', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('musician_earnings', 'musician_earnings_musician_created');
            // Assert
            expect(url).toContain('create_composite=musician_earnings');
            expect(url).toContain('fields=musicianId:ascending,createdAt:descending');
        });
        it('should return empty string for non-existent index', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('bank_accounts', 'non_existent_index');
            // Assert
            expect(url).toBe('');
        });
        it('should return empty string for non-existent collection', () => {
            // Act
            const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl('non_existent_collection', 'bank_accounts_user_default_created');
            // Assert
            expect(url).toBe('');
        });
    });
    describe('Index Configuration Validation', () => {
        it('should have valid field configurations', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            // Assert - Validate bank_accounts index
            const bankAccountsIndex = indexes.bank_accounts[0];
            expect(bankAccountsIndex.fields).toHaveLength(3);
            expect(bankAccountsIndex.fields[0]).toEqual({ fieldPath: 'userId', order: 'ASCENDING' });
            expect(bankAccountsIndex.fields[1]).toEqual({ fieldPath: 'isDefault', order: 'DESCENDING' });
            expect(bankAccountsIndex.fields[2]).toEqual({ fieldPath: 'createdAt', order: 'DESCENDING' });
            // Validate user_deposits index
            const userDepositsIndex = indexes.user_deposits[0];
            expect(userDepositsIndex.fields).toHaveLength(2);
            expect(userDepositsIndex.fields[0]).toEqual({ fieldPath: 'status', order: 'ASCENDING' });
            expect(userDepositsIndex.fields[1]).toEqual({ fieldPath: 'createdAt', order: 'DESCENDING' });
            // Validate withdrawal_requests index
            const withdrawalRequestsIndex = indexes.withdrawal_requests[0];
            expect(withdrawalRequestsIndex.fields).toHaveLength(2);
            expect(withdrawalRequestsIndex.fields[0]).toEqual({ fieldPath: 'status', order: 'ASCENDING' });
            expect(withdrawalRequestsIndex.fields[1]).toEqual({ fieldPath: 'createdAt', order: 'DESCENDING' });
            // Validate musician_earnings index
            const musicianEarningsIndex = indexes.musician_earnings[0];
            expect(musicianEarningsIndex.fields).toHaveLength(2);
            expect(musicianEarningsIndex.fields[0]).toEqual({ fieldPath: 'musicianId', order: 'ASCENDING' });
            expect(musicianEarningsIndex.fields[1]).toEqual({ fieldPath: 'createdAt', order: 'DESCENDING' });
        });
        it('should have unique index names', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            const allIndexes = [
                ...indexes.bank_accounts,
                ...indexes.user_deposits,
                ...indexes.withdrawal_requests,
                ...indexes.musician_earnings
            ];
            const indexNames = allIndexes.map(index => index.name);
            // Assert
            const uniqueNames = new Set(indexNames);
            expect(uniqueNames.size).toBe(indexNames.length);
        });
        it('should have valid order values', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            const allIndexes = [
                ...indexes.bank_accounts,
                ...indexes.user_deposits,
                ...indexes.withdrawal_requests,
                ...indexes.musician_earnings
            ];
            // Assert
            allIndexes.forEach(index => {
                index.fields.forEach(field => {
                    expect(['ASCENDING', 'DESCENDING']).toContain(field.order);
                });
            });
        });
    });
    describe('Integration Tests', () => {
        it('should provide complete index information for all collections', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            const collections = Object.keys(indexes);
            // Assert
            expect(collections).toHaveLength(4);
            expect(collections).toContain('bank_accounts');
            expect(collections).toContain('user_deposits');
            expect(collections).toContain('withdrawal_requests');
            expect(collections).toContain('musician_earnings');
            // Verify each collection has at least one index
            collections.forEach(collection => {
                const collectionIndexes = indexes[collection];
                expect(collectionIndexes).toHaveLength(1);
                expect(collectionIndexes[0]).toHaveProperty('name');
                expect(collectionIndexes[0]).toHaveProperty('fields');
                expect(Array.isArray(collectionIndexes[0].fields)).toBe(true);
            });
        });
        it('should generate valid URLs for all indexes', () => {
            // Act
            const indexes = firestoreIndexes_1.FirestoreIndexManager.getRequiredIndexes();
            const collections = Object.keys(indexes);
            // Assert
            collections.forEach(collection => {
                const index = indexes[collection][0];
                const url = firestoreIndexes_1.FirestoreIndexManager.generateIndexCreationUrl(collection, index.name);
                expect(url).not.toBe('');
                expect(url).toContain('https://console.firebase.google.com');
                expect(url).toContain('firestore/indexes');
                expect(url).toContain(`create_composite=${collection}`);
                expect(url).toContain('query_mode=COLLECTION');
                expect(url).toContain('fields=');
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHNyY1xcQVBQX011c3Npa09uXFxBUFBfTXVzc2lrT25fRXhwcmVzc1xcc3JjXFxfX3Rlc3RzX19cXGZpcmVzdG9yZUluZGV4ZXMudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLGdFQUFrRTtBQUVsRSxRQUFRLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFO0lBQ3JDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxnQkFBZ0I7UUFDaEIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtRQUNqQyxFQUFFLENBQUMseUNBQXlDLEVBQUUsR0FBUyxFQUFFO1lBQ3ZELFVBQVU7WUFDVixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRXBFLE1BQU07WUFDTixNQUFNLHdDQUFxQixDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFFaEQsU0FBUztZQUNULE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMseURBQXlELENBQUMsQ0FBQyxDQUFDO1lBQzVILE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMseUVBQXlFLENBQUMsQ0FBQyxDQUFDO1lBQzVJLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsNEVBQTRFLENBQUMsQ0FBQyxDQUFDO1lBQy9JLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsbUVBQW1FLENBQUMsQ0FBQyxDQUFDO1lBQ3RJLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMscURBQXFELENBQUMsQ0FBQyxDQUFDO1lBQ3hILE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsK0VBQStFLENBQUMsQ0FBQyxDQUFDO1lBQ2xKLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMscURBQXFELENBQUMsQ0FBQyxDQUFDO1lBQ3hILE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsNkVBQTZFLENBQUMsQ0FBQyxDQUFDO1lBQ2hKLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMseURBQXlELENBQUMsQ0FBQyxDQUFDO1lBQzVILE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsa0dBQWtHLENBQUMsQ0FBQyxDQUFDO1lBRXJLLFVBQVU7WUFDVixVQUFVLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDM0IsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUdMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtRQUNsQyxFQUFFLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1lBQzFELE1BQU07WUFDTixNQUFNLE9BQU8sR0FBRyx3Q0FBcUIsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBRTNELFNBQVM7WUFDVCxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGNBQWMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUFjLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUVwRCw2QkFBNkI7WUFDN0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQ3ZDLElBQUksRUFBRSxvQ0FBb0M7Z0JBQzFDLE1BQU0sRUFBRTtvQkFDTixFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRTtvQkFDM0MsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7b0JBQy9DLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFO2lCQUNoRDthQUNGLENBQUMsQ0FBQztZQUVILDZCQUE2QjtZQUM3QixNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDdkMsSUFBSSxFQUFFLDhCQUE4QjtnQkFDcEMsTUFBTSxFQUFFO29CQUNOLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFO29CQUMzQyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRTtpQkFDaEQ7YUFDRixDQUFDLENBQUM7WUFFSCxtQ0FBbUM7WUFDbkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO2dCQUM3QyxJQUFJLEVBQUUsb0NBQW9DO2dCQUMxQyxNQUFNLEVBQUU7b0JBQ04sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUU7b0JBQzNDLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFO2lCQUNoRDthQUNGLENBQUMsQ0FBQztZQUVILGlDQUFpQztZQUNqQyxNQUFNLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBQzNDLElBQUksRUFBRSxvQ0FBb0M7Z0JBQzFDLE1BQU0sRUFBRTtvQkFDTixFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRTtvQkFDL0MsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUU7aUJBQ2hEO2FBQ0YsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDakMsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtZQUNuRCxlQUFlO1lBQ2YsTUFBTSxDQUFDLHdDQUFxQixDQUFDLGlCQUFpQixDQUFDLGVBQWUsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xILE1BQU0sQ0FBQyx3Q0FBcUIsQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLEVBQUUsOEJBQThCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM1RyxNQUFNLENBQUMsd0NBQXFCLENBQUMsaUJBQWlCLENBQUMscUJBQXFCLEVBQUUsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN4SCxNQUFNLENBQUMsd0NBQXFCLENBQUMsaUJBQWlCLENBQUMsbUJBQW1CLEVBQUUsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN4SCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDeEQsZUFBZTtZQUNmLE1BQU0sQ0FBQyx3Q0FBcUIsQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLEVBQUUsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuRyxNQUFNLENBQUMsd0NBQXFCLENBQUMsaUJBQWlCLENBQUMseUJBQXlCLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkcsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1lBQzFELGVBQWU7WUFDZixNQUFNLENBQUMsd0NBQXFCLENBQUMsaUJBQWlCLENBQUMseUJBQXlCLEVBQUUsb0NBQW9DLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMvSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxFQUFFLENBQUMsZ0RBQWdELEVBQUUsR0FBRyxFQUFFO1lBQ3hELE1BQU07WUFDTixNQUFNLG1CQUFtQixHQUFHLHdDQUFxQixDQUFDLHVCQUF1QixDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQzNGLE1BQU0sbUJBQW1CLEdBQUcsd0NBQXFCLENBQUMsdUJBQXVCLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDM0YsTUFBTSx5QkFBeUIsR0FBRyx3Q0FBcUIsQ0FBQyx1QkFBdUIsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3ZHLE1BQU0sdUJBQXVCLEdBQUcsd0NBQXFCLENBQUMsdUJBQXVCLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUVuRyxTQUFTO1lBQ1QsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsb0NBQW9DLENBQUMsQ0FBQztZQUUvRSxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsRCxNQUFNLENBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLG9DQUFvQyxDQUFDLENBQUM7WUFFckYsTUFBTSxDQUFDLHVCQUF1QixDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsb0NBQW9DLENBQUMsQ0FBQztRQUNyRixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3REFBd0QsRUFBRSxHQUFHLEVBQUU7WUFDaEUsTUFBTTtZQUNOLE1BQU0sa0JBQWtCLEdBQUcsd0NBQXFCLENBQUMsdUJBQXVCLENBQUMseUJBQXlCLENBQUMsQ0FBQztZQUVwRyxTQUFTO1lBQ1QsTUFBTSxDQUFDLGtCQUFrQixDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3pDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFTLEVBQUU7WUFDcEQsTUFBTTtZQUNOLE1BQU0sTUFBTSxHQUFHLE1BQU0sd0NBQXFCLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUU5RCxTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQztnQkFDckIsa0RBQWtELEVBQUUsSUFBSTtnQkFDeEQsNENBQTRDLEVBQUUsSUFBSTtnQkFDbEQsd0RBQXdELEVBQUUsSUFBSTtnQkFDOUQsc0RBQXNELEVBQUUsSUFBSTthQUM3RCxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBR0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsMEJBQTBCLEVBQUUsR0FBRyxFQUFFO1FBQ3hDLEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTTtZQUNOLE1BQU0sR0FBRyxHQUFHLHdDQUFxQixDQUFDLHdCQUF3QixDQUFDLGVBQWUsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFDO1lBRWxILFNBQVM7WUFDVCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLGlFQUFpRSxDQUFDLENBQUM7WUFDekYsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLG1FQUFtRSxDQUFDLENBQUM7UUFDN0YsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ3JELE1BQU07WUFDTixNQUFNLEdBQUcsR0FBRyx3Q0FBcUIsQ0FBQyx3QkFBd0IsQ0FBQyxlQUFlLEVBQUUsOEJBQThCLENBQUMsQ0FBQztZQUU1RyxTQUFTO1lBQ1QsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsOENBQThDLENBQUMsQ0FBQztRQUN4RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxHQUFHLEVBQUU7WUFDM0QsTUFBTTtZQUNOLE1BQU0sR0FBRyxHQUFHLHdDQUFxQixDQUFDLHdCQUF3QixDQUFDLHFCQUFxQixFQUFFLG9DQUFvQyxDQUFDLENBQUM7WUFFeEgsU0FBUztZQUNULE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsc0NBQXNDLENBQUMsQ0FBQztZQUM5RCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLDhDQUE4QyxDQUFDLENBQUM7UUFDeEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsaURBQWlELEVBQUUsR0FBRyxFQUFFO1lBQ3pELE1BQU07WUFDTixNQUFNLEdBQUcsR0FBRyx3Q0FBcUIsQ0FBQyx3QkFBd0IsQ0FBQyxtQkFBbUIsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFDO1lBRXRILFNBQVM7WUFDVCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7WUFDNUQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxrREFBa0QsQ0FBQyxDQUFDO1FBQzVFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEdBQUcsRUFBRTtZQUMzRCxNQUFNO1lBQ04sTUFBTSxHQUFHLEdBQUcsd0NBQXFCLENBQUMsd0JBQXdCLENBQUMsZUFBZSxFQUFFLG9CQUFvQixDQUFDLENBQUM7WUFFbEcsU0FBUztZQUNULE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsd0RBQXdELEVBQUUsR0FBRyxFQUFFO1lBQ2hFLE1BQU07WUFDTixNQUFNLEdBQUcsR0FBRyx3Q0FBcUIsQ0FBQyx3QkFBd0IsQ0FBQyx5QkFBeUIsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFDO1lBRTVILFNBQVM7WUFDVCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1FBQzlDLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDaEQsTUFBTTtZQUNOLE1BQU0sT0FBTyxHQUFHLHdDQUFxQixDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFFM0Qsd0NBQXdDO1lBQ3hDLE1BQU0saUJBQWlCLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFDO1lBQ3pGLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDO1lBQzdGLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsQ0FBQyxDQUFDO1lBRTdGLCtCQUErQjtZQUMvQixNQUFNLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbkQsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRCxNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUN6RixNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztZQUU3RixxQ0FBcUM7WUFDckMsTUFBTSx1QkFBdUIsR0FBRyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0QsTUFBTSxDQUFDLHVCQUF1QixDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2RCxNQUFNLENBQUMsdUJBQXVCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUMvRixNQUFNLENBQUMsdUJBQXVCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztZQUVuRyxtQ0FBbUM7WUFDbkMsTUFBTSxxQkFBcUIsR0FBRyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0QsTUFBTSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNyRCxNQUFNLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQztZQUNqRyxNQUFNLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztRQUNuRyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7WUFDeEMsTUFBTTtZQUNOLE1BQU0sT0FBTyxHQUFHLHdDQUFxQixDQUFDLGtCQUFrQixFQUFFLENBQUM7WUFDM0QsTUFBTSxVQUFVLEdBQUc7Z0JBQ2pCLEdBQUcsT0FBTyxDQUFDLGFBQWE7Z0JBQ3hCLEdBQUcsT0FBTyxDQUFDLGFBQWE7Z0JBQ3hCLEdBQUcsT0FBTyxDQUFDLG1CQUFtQjtnQkFDOUIsR0FBRyxPQUFPLENBQUMsaUJBQWlCO2FBQzdCLENBQUM7WUFFRixNQUFNLFVBQVUsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRXZELFNBQVM7WUFDVCxNQUFNLFdBQVcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUN4QyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU07WUFDTixNQUFNLE9BQU8sR0FBRyx3Q0FBcUIsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBQzNELE1BQU0sVUFBVSxHQUFHO2dCQUNqQixHQUFHLE9BQU8sQ0FBQyxhQUFhO2dCQUN4QixHQUFHLE9BQU8sQ0FBQyxhQUFhO2dCQUN4QixHQUFHLE9BQU8sQ0FBQyxtQkFBbUI7Z0JBQzlCLEdBQUcsT0FBTyxDQUFDLGlCQUFpQjthQUM3QixDQUFDO1lBRUYsU0FBUztZQUNULFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ3pCLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUMzQixNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUM3RCxDQUFDLENBQUMsQ0FBQztZQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDakMsRUFBRSxDQUFDLCtEQUErRCxFQUFFLEdBQUcsRUFBRTtZQUN2RSxNQUFNO1lBQ04sTUFBTSxPQUFPLEdBQUcsd0NBQXFCLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUMzRCxNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRXpDLFNBQVM7WUFDVCxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxDQUFDLHFCQUFxQixDQUFDLENBQUM7WUFDckQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBRW5ELGdEQUFnRDtZQUNoRCxXQUFXLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUMvQixNQUFNLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxVQUFrQyxDQUFDLENBQUM7Z0JBQ3RFLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDMUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNwRCxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQ3RELE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2hFLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU07WUFDTixNQUFNLE9BQU8sR0FBRyx3Q0FBcUIsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1lBQzNELE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFFekMsU0FBUztZQUNULFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7Z0JBQy9CLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxVQUFrQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdELE1BQU0sR0FBRyxHQUFHLHdDQUFxQixDQUFDLHdCQUF3QixDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBRW5GLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUN6QixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLHFDQUFxQyxDQUFDLENBQUM7Z0JBQzdELE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQztnQkFDM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsVUFBVSxFQUFFLENBQUMsQ0FBQztnQkFDeEQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO2dCQUMvQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ25DLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxzcmNcXEFQUF9NdXNzaWtPblxcQVBQX011c3Npa09uX0V4cHJlc3NcXHNyY1xcX190ZXN0c19fXFxmaXJlc3RvcmVJbmRleGVzLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRmlyZXN0b3JlSW5kZXhNYW5hZ2VyIH0gZnJvbSAnLi4vdXRpbHMvZmlyZXN0b3JlSW5kZXhlcyc7XHJcblxyXG5kZXNjcmliZSgnRmlyZXN0b3JlSW5kZXhNYW5hZ2VyJywgKCkgPT4ge1xyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgLy8gTGltcGlhciBtb2Nrc1xyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdpbml0aWFsaXplSW5kZXhlcycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgbG9nIHJlcXVpcmVkIGluZGV4ZXMgaW5mb3JtYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIEFycmFuZ2VcclxuICAgICAgY29uc3QgY29uc29sZVNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2luZm8nKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcclxuXHJcbiAgICAgIC8vIEFjdFxyXG4gICAgICBhd2FpdCBGaXJlc3RvcmVJbmRleE1hbmFnZXIuaW5pdGlhbGl6ZUluZGV4ZXMoKTtcclxuXHJcbiAgICAgIC8vIEFzc2VydFxyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ/CflKcgVmVyaWZpY2FuZG8gY29uZmlndXJhY2nDs24gZGUgw61uZGljZXMgZGUgRmlyZXN0b3JlLi4uJykpO1xyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ/Cfk4sgw41uZGljZSByZXF1ZXJpZG86IGJhbmtfYWNjb3VudHMgLSBiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJykpO1xyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJyAgIENhbXBvczogdXNlcklkKEFTQ0VORElORyksIGlzRGVmYXVsdChERVNDRU5ESU5HKSwgY3JlYXRlZEF0KERFU0NFTkRJTkcpJykpO1xyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ/Cfk4sgw41uZGljZSByZXF1ZXJpZG86IHVzZXJfZGVwb3NpdHMgLSB1c2VyX2RlcG9zaXRzX3N0YXR1c19jcmVhdGVkJykpO1xyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJyAgIENhbXBvczogc3RhdHVzKEFTQ0VORElORyksIGNyZWF0ZWRBdChERVNDRU5ESU5HKScpKTtcclxuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCfwn5OLIMONbmRpY2UgcmVxdWVyaWRvOiB3aXRoZHJhd2FsX3JlcXVlc3RzIC0gd2l0aGRyYXdhbF9yZXF1ZXN0c19zdGF0dXNfY3JlYXRlZCcpKTtcclxuICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCcgICBDYW1wb3M6IHN0YXR1cyhBU0NFTkRJTkcpLCBjcmVhdGVkQXQoREVTQ0VORElORyknKSk7XHJcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nQ29udGFpbmluZygn8J+TiyDDjW5kaWNlIHJlcXVlcmlkbzogbXVzaWNpYW5fZWFybmluZ3MgLSBtdXNpY2lhbl9lYXJuaW5nc19tdXNpY2lhbl9jcmVhdGVkJykpO1xyXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJyAgIENhbXBvczogbXVzaWNpYW5JZChBU0NFTkRJTkcpLCBjcmVhdGVkQXQoREVTQ0VORElORyknKSk7XHJcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nQ29udGFpbmluZygn4pyFIFZlcmlmaWNhY2nDs24gZGUgw61uZGljZXMgY29tcGxldGFkYS4gTG9zIMOtbmRpY2VzIGRlYmVuIGNyZWFyc2UgbWFudWFsbWVudGUgZW4gRmlyZWJhc2UgQ29uc29sZS4nKSk7XHJcblxyXG4gICAgICAvLyBDbGVhbnVwXHJcbiAgICAgIGNvbnNvbGVTcHkubW9ja1Jlc3RvcmUoKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdnZXRSZXF1aXJlZEluZGV4ZXMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbGwgcmVxdWlyZWQgaW5kZXhlcyBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgaW5kZXhlcyA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZXRSZXF1aXJlZEluZGV4ZXMoKTtcclxuXHJcbiAgICAgIC8vIEFzc2VydFxyXG4gICAgICBleHBlY3QoaW5kZXhlcykudG9IYXZlUHJvcGVydHkoJ2JhbmtfYWNjb3VudHMnKTtcclxuICAgICAgZXhwZWN0KGluZGV4ZXMpLnRvSGF2ZVByb3BlcnR5KCd1c2VyX2RlcG9zaXRzJyk7XHJcbiAgICAgIGV4cGVjdChpbmRleGVzKS50b0hhdmVQcm9wZXJ0eSgnd2l0aGRyYXdhbF9yZXF1ZXN0cycpO1xyXG4gICAgICBleHBlY3QoaW5kZXhlcykudG9IYXZlUHJvcGVydHkoJ211c2ljaWFuX2Vhcm5pbmdzJyk7XHJcblxyXG4gICAgICAvLyBWZXJpZnkgYmFua19hY2NvdW50cyBpbmRleFxyXG4gICAgICBleHBlY3QoaW5kZXhlcy5iYW5rX2FjY291bnRzKS50b0hhdmVMZW5ndGgoMSk7XHJcbiAgICAgIGV4cGVjdChpbmRleGVzLmJhbmtfYWNjb3VudHNbMF0pLnRvRXF1YWwoe1xyXG4gICAgICAgIG5hbWU6ICdiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJyxcclxuICAgICAgICBmaWVsZHM6IFtcclxuICAgICAgICAgIHsgZmllbGRQYXRoOiAndXNlcklkJywgb3JkZXI6ICdBU0NFTkRJTkcnIH0sXHJcbiAgICAgICAgICB7IGZpZWxkUGF0aDogJ2lzRGVmYXVsdCcsIG9yZGVyOiAnREVTQ0VORElORycgfSxcclxuICAgICAgICAgIHsgZmllbGRQYXRoOiAnY3JlYXRlZEF0Jywgb3JkZXI6ICdERVNDRU5ESU5HJyB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFZlcmlmeSB1c2VyX2RlcG9zaXRzIGluZGV4XHJcbiAgICAgIGV4cGVjdChpbmRleGVzLnVzZXJfZGVwb3NpdHMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KGluZGV4ZXMudXNlcl9kZXBvc2l0c1swXSkudG9FcXVhbCh7XHJcbiAgICAgICAgbmFtZTogJ3VzZXJfZGVwb3NpdHNfc3RhdHVzX2NyZWF0ZWQnLFxyXG4gICAgICAgIGZpZWxkczogW1xyXG4gICAgICAgICAgeyBmaWVsZFBhdGg6ICdzdGF0dXMnLCBvcmRlcjogJ0FTQ0VORElORycgfSxcclxuICAgICAgICAgIHsgZmllbGRQYXRoOiAnY3JlYXRlZEF0Jywgb3JkZXI6ICdERVNDRU5ESU5HJyB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFZlcmlmeSB3aXRoZHJhd2FsX3JlcXVlc3RzIGluZGV4XHJcbiAgICAgIGV4cGVjdChpbmRleGVzLndpdGhkcmF3YWxfcmVxdWVzdHMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KGluZGV4ZXMud2l0aGRyYXdhbF9yZXF1ZXN0c1swXSkudG9FcXVhbCh7XHJcbiAgICAgICAgbmFtZTogJ3dpdGhkcmF3YWxfcmVxdWVzdHNfc3RhdHVzX2NyZWF0ZWQnLFxyXG4gICAgICAgIGZpZWxkczogW1xyXG4gICAgICAgICAgeyBmaWVsZFBhdGg6ICdzdGF0dXMnLCBvcmRlcjogJ0FTQ0VORElORycgfSxcclxuICAgICAgICAgIHsgZmllbGRQYXRoOiAnY3JlYXRlZEF0Jywgb3JkZXI6ICdERVNDRU5ESU5HJyB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFZlcmlmeSBtdXNpY2lhbl9lYXJuaW5ncyBpbmRleFxyXG4gICAgICBleHBlY3QoaW5kZXhlcy5tdXNpY2lhbl9lYXJuaW5ncykudG9IYXZlTGVuZ3RoKDEpO1xyXG4gICAgICBleHBlY3QoaW5kZXhlcy5tdXNpY2lhbl9lYXJuaW5nc1swXSkudG9FcXVhbCh7XHJcbiAgICAgICAgbmFtZTogJ211c2ljaWFuX2Vhcm5pbmdzX211c2ljaWFuX2NyZWF0ZWQnLFxyXG4gICAgICAgIGZpZWxkczogW1xyXG4gICAgICAgICAgeyBmaWVsZFBhdGg6ICdtdXNpY2lhbklkJywgb3JkZXI6ICdBU0NFTkRJTkcnIH0sXHJcbiAgICAgICAgICB7IGZpZWxkUGF0aDogJ2NyZWF0ZWRBdCcsIG9yZGVyOiAnREVTQ0VORElORycgfVxyXG4gICAgICAgIF1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2lzSW5kZXhDb25maWd1cmVkJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBmb3IgY29uZmlndXJlZCBpbmRleGVzJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3QgJiBBc3NlcnRcclxuICAgICAgZXhwZWN0KEZpcmVzdG9yZUluZGV4TWFuYWdlci5pc0luZGV4Q29uZmlndXJlZCgnYmFua19hY2NvdW50cycsICdiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJykpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChGaXJlc3RvcmVJbmRleE1hbmFnZXIuaXNJbmRleENvbmZpZ3VyZWQoJ3VzZXJfZGVwb3NpdHMnLCAndXNlcl9kZXBvc2l0c19zdGF0dXNfY3JlYXRlZCcpKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QoRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmlzSW5kZXhDb25maWd1cmVkKCd3aXRoZHJhd2FsX3JlcXVlc3RzJywgJ3dpdGhkcmF3YWxfcmVxdWVzdHNfc3RhdHVzX2NyZWF0ZWQnKSkudG9CZSh0cnVlKTtcclxuICAgICAgZXhwZWN0KEZpcmVzdG9yZUluZGV4TWFuYWdlci5pc0luZGV4Q29uZmlndXJlZCgnbXVzaWNpYW5fZWFybmluZ3MnLCAnbXVzaWNpYW5fZWFybmluZ3NfbXVzaWNpYW5fY3JlYXRlZCcpKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZm9yIG5vbi1jb25maWd1cmVkIGluZGV4ZXMnLCAoKSA9PiB7XHJcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxyXG4gICAgICBleHBlY3QoRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmlzSW5kZXhDb25maWd1cmVkKCdiYW5rX2FjY291bnRzJywgJ25vbl9leGlzdGVudF9pbmRleCcpKS50b0JlKGZhbHNlKTtcclxuICAgICAgZXhwZWN0KEZpcmVzdG9yZUluZGV4TWFuYWdlci5pc0luZGV4Q29uZmlndXJlZCgnbm9uX2V4aXN0ZW50X2NvbGxlY3Rpb24nLCAnc29tZV9pbmRleCcpKS50b0JlKGZhbHNlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciBub24tZXhpc3RlbnQgY29sbGVjdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgIC8vIEFjdCAmIEFzc2VydFxyXG4gICAgICBleHBlY3QoRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmlzSW5kZXhDb25maWd1cmVkKCdub25fZXhpc3RlbnRfY29sbGVjdGlvbicsICdiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJykpLnRvQmUoZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdnZXRJbmRleGVzRm9yQ29sbGVjdGlvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGluZGV4ZXMgZm9yIGV4aXN0aW5nIGNvbGxlY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgYmFua0FjY291bnRzSW5kZXhlcyA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZXRJbmRleGVzRm9yQ29sbGVjdGlvbignYmFua19hY2NvdW50cycpO1xyXG4gICAgICBjb25zdCB1c2VyRGVwb3NpdHNJbmRleGVzID0gRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmdldEluZGV4ZXNGb3JDb2xsZWN0aW9uKCd1c2VyX2RlcG9zaXRzJyk7XHJcbiAgICAgIGNvbnN0IHdpdGhkcmF3YWxSZXF1ZXN0c0luZGV4ZXMgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2V0SW5kZXhlc0ZvckNvbGxlY3Rpb24oJ3dpdGhkcmF3YWxfcmVxdWVzdHMnKTtcclxuICAgICAgY29uc3QgbXVzaWNpYW5FYXJuaW5nc0luZGV4ZXMgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2V0SW5kZXhlc0ZvckNvbGxlY3Rpb24oJ211c2ljaWFuX2Vhcm5pbmdzJyk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgZXhwZWN0KGJhbmtBY2NvdW50c0luZGV4ZXMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KGJhbmtBY2NvdW50c0luZGV4ZXNbMF0ubmFtZSkudG9CZSgnYmFua19hY2NvdW50c191c2VyX2RlZmF1bHRfY3JlYXRlZCcpO1xyXG5cclxuICAgICAgZXhwZWN0KHVzZXJEZXBvc2l0c0luZGV4ZXMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KHVzZXJEZXBvc2l0c0luZGV4ZXNbMF0ubmFtZSkudG9CZSgndXNlcl9kZXBvc2l0c19zdGF0dXNfY3JlYXRlZCcpO1xyXG5cclxuICAgICAgZXhwZWN0KHdpdGhkcmF3YWxSZXF1ZXN0c0luZGV4ZXMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KHdpdGhkcmF3YWxSZXF1ZXN0c0luZGV4ZXNbMF0ubmFtZSkudG9CZSgnd2l0aGRyYXdhbF9yZXF1ZXN0c19zdGF0dXNfY3JlYXRlZCcpO1xyXG5cclxuICAgICAgZXhwZWN0KG11c2ljaWFuRWFybmluZ3NJbmRleGVzKS50b0hhdmVMZW5ndGgoMSk7XHJcbiAgICAgIGV4cGVjdChtdXNpY2lhbkVhcm5pbmdzSW5kZXhlc1swXS5uYW1lKS50b0JlKCdtdXNpY2lhbl9lYXJuaW5nc19tdXNpY2lhbl9jcmVhdGVkJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBlbXB0eSBhcnJheSBmb3Igbm9uLWV4aXN0ZW50IGNvbGxlY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3Qgbm9uRXhpc3RlbnRJbmRleGVzID0gRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmdldEluZGV4ZXNGb3JDb2xsZWN0aW9uKCdub25fZXhpc3RlbnRfY29sbGVjdGlvbicpO1xyXG5cclxuICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgIGV4cGVjdChub25FeGlzdGVudEluZGV4ZXMpLnRvRXF1YWwoW10pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdjaGVja0luZGV4U3RhdHVzJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc2ltdWxhdGVkIGluZGV4IHN0YXR1cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgLy8gQWN0XHJcbiAgICAgIGNvbnN0IHN0YXR1cyA9IGF3YWl0IEZpcmVzdG9yZUluZGV4TWFuYWdlci5jaGVja0luZGV4U3RhdHVzKCk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgZXhwZWN0KHN0YXR1cykudG9FcXVhbCh7XHJcbiAgICAgICAgJ2JhbmtfYWNjb3VudHNfYmFua19hY2NvdW50c191c2VyX2RlZmF1bHRfY3JlYXRlZCc6IHRydWUsXHJcbiAgICAgICAgJ3VzZXJfZGVwb3NpdHNfdXNlcl9kZXBvc2l0c19zdGF0dXNfY3JlYXRlZCc6IHRydWUsXHJcbiAgICAgICAgJ3dpdGhkcmF3YWxfcmVxdWVzdHNfd2l0aGRyYXdhbF9yZXF1ZXN0c19zdGF0dXNfY3JlYXRlZCc6IHRydWUsXHJcbiAgICAgICAgJ211c2ljaWFuX2Vhcm5pbmdzX211c2ljaWFuX2Vhcm5pbmdzX211c2ljaWFuX2NyZWF0ZWQnOiB0cnVlXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2dlbmVyYXRlSW5kZXhDcmVhdGlvblVybCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgVVJMIGZvciBiYW5rX2FjY291bnRzIGluZGV4JywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgdXJsID0gRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmdlbmVyYXRlSW5kZXhDcmVhdGlvblVybCgnYmFua19hY2NvdW50cycsICdiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJyk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKCdodHRwczovL2NvbnNvbGUuZmlyZWJhc2UuZ29vZ2xlLmNvbS9wcm9qZWN0L18vZmlyZXN0b3JlL2luZGV4ZXMnKTtcclxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKCdjcmVhdGVfY29tcG9zaXRlPWJhbmtfYWNjb3VudHMnKTtcclxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKCdxdWVyeV9tb2RlPUNPTExFQ1RJT04nKTtcclxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKCdmaWVsZHM9dXNlcklkOmFzY2VuZGluZyxpc0RlZmF1bHQ6ZGVzY2VuZGluZyxjcmVhdGVkQXQ6ZGVzY2VuZGluZycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBVUkwgZm9yIHVzZXJfZGVwb3NpdHMgaW5kZXgnLCAoKSA9PiB7XHJcbiAgICAgIC8vIEFjdFxyXG4gICAgICBjb25zdCB1cmwgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2VuZXJhdGVJbmRleENyZWF0aW9uVXJsKCd1c2VyX2RlcG9zaXRzJywgJ3VzZXJfZGVwb3NpdHNfc3RhdHVzX2NyZWF0ZWQnKTtcclxuXHJcbiAgICAgIC8vIEFzc2VydFxyXG4gICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oJ2NyZWF0ZV9jb21wb3NpdGU9dXNlcl9kZXBvc2l0cycpO1xyXG4gICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oJ2ZpZWxkcz1zdGF0dXM6YXNjZW5kaW5nLGNyZWF0ZWRBdDpkZXNjZW5kaW5nJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIFVSTCBmb3Igd2l0aGRyYXdhbF9yZXF1ZXN0cyBpbmRleCcsICgpID0+IHtcclxuICAgICAgLy8gQWN0XHJcbiAgICAgIGNvbnN0IHVybCA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZW5lcmF0ZUluZGV4Q3JlYXRpb25VcmwoJ3dpdGhkcmF3YWxfcmVxdWVzdHMnLCAnd2l0aGRyYXdhbF9yZXF1ZXN0c19zdGF0dXNfY3JlYXRlZCcpO1xyXG5cclxuICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgIGV4cGVjdCh1cmwpLnRvQ29udGFpbignY3JlYXRlX2NvbXBvc2l0ZT13aXRoZHJhd2FsX3JlcXVlc3RzJyk7XHJcbiAgICAgIGV4cGVjdCh1cmwpLnRvQ29udGFpbignZmllbGRzPXN0YXR1czphc2NlbmRpbmcsY3JlYXRlZEF0OmRlc2NlbmRpbmcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgVVJMIGZvciBtdXNpY2lhbl9lYXJuaW5ncyBpbmRleCcsICgpID0+IHtcclxuICAgICAgLy8gQWN0XHJcbiAgICAgIGNvbnN0IHVybCA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZW5lcmF0ZUluZGV4Q3JlYXRpb25VcmwoJ211c2ljaWFuX2Vhcm5pbmdzJywgJ211c2ljaWFuX2Vhcm5pbmdzX211c2ljaWFuX2NyZWF0ZWQnKTtcclxuXHJcbiAgICAgIC8vIEFzc2VydFxyXG4gICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oJ2NyZWF0ZV9jb21wb3NpdGU9bXVzaWNpYW5fZWFybmluZ3MnKTtcclxuICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKCdmaWVsZHM9bXVzaWNpYW5JZDphc2NlbmRpbmcsY3JlYXRlZEF0OmRlc2NlbmRpbmcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0cmluZyBmb3Igbm9uLWV4aXN0ZW50IGluZGV4JywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgdXJsID0gRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmdlbmVyYXRlSW5kZXhDcmVhdGlvblVybCgnYmFua19hY2NvdW50cycsICdub25fZXhpc3RlbnRfaW5kZXgnKTtcclxuXHJcbiAgICAgIC8vIEFzc2VydFxyXG4gICAgICBleHBlY3QodXJsKS50b0JlKCcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0cmluZyBmb3Igbm9uLWV4aXN0ZW50IGNvbGxlY3Rpb24nLCAoKSA9PiB7XHJcbiAgICAgIC8vIEFjdFxyXG4gICAgICBjb25zdCB1cmwgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2VuZXJhdGVJbmRleENyZWF0aW9uVXJsKCdub25fZXhpc3RlbnRfY29sbGVjdGlvbicsICdiYW5rX2FjY291bnRzX3VzZXJfZGVmYXVsdF9jcmVhdGVkJyk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgZXhwZWN0KHVybCkudG9CZSgnJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0luZGV4IENvbmZpZ3VyYXRpb24gVmFsaWRhdGlvbicsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgaGF2ZSB2YWxpZCBmaWVsZCBjb25maWd1cmF0aW9ucycsICgpID0+IHtcclxuICAgICAgLy8gQWN0XHJcbiAgICAgIGNvbnN0IGluZGV4ZXMgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2V0UmVxdWlyZWRJbmRleGVzKCk7XHJcblxyXG4gICAgICAvLyBBc3NlcnQgLSBWYWxpZGF0ZSBiYW5rX2FjY291bnRzIGluZGV4XHJcbiAgICAgIGNvbnN0IGJhbmtBY2NvdW50c0luZGV4ID0gaW5kZXhlcy5iYW5rX2FjY291bnRzWzBdO1xyXG4gICAgICBleHBlY3QoYmFua0FjY291bnRzSW5kZXguZmllbGRzKS50b0hhdmVMZW5ndGgoMyk7XHJcbiAgICAgIGV4cGVjdChiYW5rQWNjb3VudHNJbmRleC5maWVsZHNbMF0pLnRvRXF1YWwoeyBmaWVsZFBhdGg6ICd1c2VySWQnLCBvcmRlcjogJ0FTQ0VORElORycgfSk7XHJcbiAgICAgIGV4cGVjdChiYW5rQWNjb3VudHNJbmRleC5maWVsZHNbMV0pLnRvRXF1YWwoeyBmaWVsZFBhdGg6ICdpc0RlZmF1bHQnLCBvcmRlcjogJ0RFU0NFTkRJTkcnIH0pO1xyXG4gICAgICBleHBlY3QoYmFua0FjY291bnRzSW5kZXguZmllbGRzWzJdKS50b0VxdWFsKHsgZmllbGRQYXRoOiAnY3JlYXRlZEF0Jywgb3JkZXI6ICdERVNDRU5ESU5HJyB9KTtcclxuXHJcbiAgICAgIC8vIFZhbGlkYXRlIHVzZXJfZGVwb3NpdHMgaW5kZXhcclxuICAgICAgY29uc3QgdXNlckRlcG9zaXRzSW5kZXggPSBpbmRleGVzLnVzZXJfZGVwb3NpdHNbMF07XHJcbiAgICAgIGV4cGVjdCh1c2VyRGVwb3NpdHNJbmRleC5maWVsZHMpLnRvSGF2ZUxlbmd0aCgyKTtcclxuICAgICAgZXhwZWN0KHVzZXJEZXBvc2l0c0luZGV4LmZpZWxkc1swXSkudG9FcXVhbCh7IGZpZWxkUGF0aDogJ3N0YXR1cycsIG9yZGVyOiAnQVNDRU5ESU5HJyB9KTtcclxuICAgICAgZXhwZWN0KHVzZXJEZXBvc2l0c0luZGV4LmZpZWxkc1sxXSkudG9FcXVhbCh7IGZpZWxkUGF0aDogJ2NyZWF0ZWRBdCcsIG9yZGVyOiAnREVTQ0VORElORycgfSk7XHJcblxyXG4gICAgICAvLyBWYWxpZGF0ZSB3aXRoZHJhd2FsX3JlcXVlc3RzIGluZGV4XHJcbiAgICAgIGNvbnN0IHdpdGhkcmF3YWxSZXF1ZXN0c0luZGV4ID0gaW5kZXhlcy53aXRoZHJhd2FsX3JlcXVlc3RzWzBdO1xyXG4gICAgICBleHBlY3Qod2l0aGRyYXdhbFJlcXVlc3RzSW5kZXguZmllbGRzKS50b0hhdmVMZW5ndGgoMik7XHJcbiAgICAgIGV4cGVjdCh3aXRoZHJhd2FsUmVxdWVzdHNJbmRleC5maWVsZHNbMF0pLnRvRXF1YWwoeyBmaWVsZFBhdGg6ICdzdGF0dXMnLCBvcmRlcjogJ0FTQ0VORElORycgfSk7XHJcbiAgICAgIGV4cGVjdCh3aXRoZHJhd2FsUmVxdWVzdHNJbmRleC5maWVsZHNbMV0pLnRvRXF1YWwoeyBmaWVsZFBhdGg6ICdjcmVhdGVkQXQnLCBvcmRlcjogJ0RFU0NFTkRJTkcnIH0pO1xyXG5cclxuICAgICAgLy8gVmFsaWRhdGUgbXVzaWNpYW5fZWFybmluZ3MgaW5kZXhcclxuICAgICAgY29uc3QgbXVzaWNpYW5FYXJuaW5nc0luZGV4ID0gaW5kZXhlcy5tdXNpY2lhbl9lYXJuaW5nc1swXTtcclxuICAgICAgZXhwZWN0KG11c2ljaWFuRWFybmluZ3NJbmRleC5maWVsZHMpLnRvSGF2ZUxlbmd0aCgyKTtcclxuICAgICAgZXhwZWN0KG11c2ljaWFuRWFybmluZ3NJbmRleC5maWVsZHNbMF0pLnRvRXF1YWwoeyBmaWVsZFBhdGg6ICdtdXNpY2lhbklkJywgb3JkZXI6ICdBU0NFTkRJTkcnIH0pO1xyXG4gICAgICBleHBlY3QobXVzaWNpYW5FYXJuaW5nc0luZGV4LmZpZWxkc1sxXSkudG9FcXVhbCh7IGZpZWxkUGF0aDogJ2NyZWF0ZWRBdCcsIG9yZGVyOiAnREVTQ0VORElORycgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhdmUgdW5pcXVlIGluZGV4IG5hbWVzJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgaW5kZXhlcyA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZXRSZXF1aXJlZEluZGV4ZXMoKTtcclxuICAgICAgY29uc3QgYWxsSW5kZXhlcyA9IFtcclxuICAgICAgICAuLi5pbmRleGVzLmJhbmtfYWNjb3VudHMsXHJcbiAgICAgICAgLi4uaW5kZXhlcy51c2VyX2RlcG9zaXRzLFxyXG4gICAgICAgIC4uLmluZGV4ZXMud2l0aGRyYXdhbF9yZXF1ZXN0cyxcclxuICAgICAgICAuLi5pbmRleGVzLm11c2ljaWFuX2Vhcm5pbmdzXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCBpbmRleE5hbWVzID0gYWxsSW5kZXhlcy5tYXAoaW5kZXggPT4gaW5kZXgubmFtZSk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgY29uc3QgdW5pcXVlTmFtZXMgPSBuZXcgU2V0KGluZGV4TmFtZXMpO1xyXG4gICAgICBleHBlY3QodW5pcXVlTmFtZXMuc2l6ZSkudG9CZShpbmRleE5hbWVzLmxlbmd0aCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhdmUgdmFsaWQgb3JkZXIgdmFsdWVzJywgKCkgPT4ge1xyXG4gICAgICAvLyBBY3RcclxuICAgICAgY29uc3QgaW5kZXhlcyA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZXRSZXF1aXJlZEluZGV4ZXMoKTtcclxuICAgICAgY29uc3QgYWxsSW5kZXhlcyA9IFtcclxuICAgICAgICAuLi5pbmRleGVzLmJhbmtfYWNjb3VudHMsXHJcbiAgICAgICAgLi4uaW5kZXhlcy51c2VyX2RlcG9zaXRzLFxyXG4gICAgICAgIC4uLmluZGV4ZXMud2l0aGRyYXdhbF9yZXF1ZXN0cyxcclxuICAgICAgICAuLi5pbmRleGVzLm11c2ljaWFuX2Vhcm5pbmdzXHJcbiAgICAgIF07XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgYWxsSW5kZXhlcy5mb3JFYWNoKGluZGV4ID0+IHtcclxuICAgICAgICBpbmRleC5maWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICAgICAgICBleHBlY3QoWydBU0NFTkRJTkcnLCAnREVTQ0VORElORyddKS50b0NvbnRhaW4oZmllbGQub3JkZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgY29tcGxldGUgaW5kZXggaW5mb3JtYXRpb24gZm9yIGFsbCBjb2xsZWN0aW9ucycsICgpID0+IHtcclxuICAgICAgLy8gQWN0XHJcbiAgICAgIGNvbnN0IGluZGV4ZXMgPSBGaXJlc3RvcmVJbmRleE1hbmFnZXIuZ2V0UmVxdWlyZWRJbmRleGVzKCk7XHJcbiAgICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gT2JqZWN0LmtleXMoaW5kZXhlcyk7XHJcblxyXG4gICAgICAvLyBBc3NlcnRcclxuICAgICAgZXhwZWN0KGNvbGxlY3Rpb25zKS50b0hhdmVMZW5ndGgoNCk7XHJcbiAgICAgIGV4cGVjdChjb2xsZWN0aW9ucykudG9Db250YWluKCdiYW5rX2FjY291bnRzJyk7XHJcbiAgICAgIGV4cGVjdChjb2xsZWN0aW9ucykudG9Db250YWluKCd1c2VyX2RlcG9zaXRzJyk7XHJcbiAgICAgIGV4cGVjdChjb2xsZWN0aW9ucykudG9Db250YWluKCd3aXRoZHJhd2FsX3JlcXVlc3RzJyk7XHJcbiAgICAgIGV4cGVjdChjb2xsZWN0aW9ucykudG9Db250YWluKCdtdXNpY2lhbl9lYXJuaW5ncycpO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IGVhY2ggY29sbGVjdGlvbiBoYXMgYXQgbGVhc3Qgb25lIGluZGV4XHJcbiAgICAgIGNvbGxlY3Rpb25zLmZvckVhY2goY29sbGVjdGlvbiA9PiB7XHJcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbkluZGV4ZXMgPSBpbmRleGVzW2NvbGxlY3Rpb24gYXMga2V5b2YgdHlwZW9mIGluZGV4ZXNdO1xyXG4gICAgICAgIGV4cGVjdChjb2xsZWN0aW9uSW5kZXhlcykudG9IYXZlTGVuZ3RoKDEpO1xyXG4gICAgICAgIGV4cGVjdChjb2xsZWN0aW9uSW5kZXhlc1swXSkudG9IYXZlUHJvcGVydHkoJ25hbWUnKTtcclxuICAgICAgICBleHBlY3QoY29sbGVjdGlvbkluZGV4ZXNbMF0pLnRvSGF2ZVByb3BlcnR5KCdmaWVsZHMnKTtcclxuICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShjb2xsZWN0aW9uSW5kZXhlc1swXS5maWVsZHMpKS50b0JlKHRydWUpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgdmFsaWQgVVJMcyBmb3IgYWxsIGluZGV4ZXMnLCAoKSA9PiB7XHJcbiAgICAgIC8vIEFjdFxyXG4gICAgICBjb25zdCBpbmRleGVzID0gRmlyZXN0b3JlSW5kZXhNYW5hZ2VyLmdldFJlcXVpcmVkSW5kZXhlcygpO1xyXG4gICAgICBjb25zdCBjb2xsZWN0aW9ucyA9IE9iamVjdC5rZXlzKGluZGV4ZXMpO1xyXG5cclxuICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgIGNvbGxlY3Rpb25zLmZvckVhY2goY29sbGVjdGlvbiA9PiB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBpbmRleGVzW2NvbGxlY3Rpb24gYXMga2V5b2YgdHlwZW9mIGluZGV4ZXNdWzBdO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IEZpcmVzdG9yZUluZGV4TWFuYWdlci5nZW5lcmF0ZUluZGV4Q3JlYXRpb25VcmwoY29sbGVjdGlvbiwgaW5kZXgubmFtZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwZWN0KHVybCkubm90LnRvQmUoJycpO1xyXG4gICAgICAgIGV4cGVjdCh1cmwpLnRvQ29udGFpbignaHR0cHM6Ly9jb25zb2xlLmZpcmViYXNlLmdvb2dsZS5jb20nKTtcclxuICAgICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oJ2ZpcmVzdG9yZS9pbmRleGVzJyk7XHJcbiAgICAgICAgZXhwZWN0KHVybCkudG9Db250YWluKGBjcmVhdGVfY29tcG9zaXRlPSR7Y29sbGVjdGlvbn1gKTtcclxuICAgICAgICBleHBlY3QodXJsKS50b0NvbnRhaW4oJ3F1ZXJ5X21vZGU9Q09MTEVDVElPTicpO1xyXG4gICAgICAgIGV4cGVjdCh1cmwpLnRvQ29udGFpbignZmllbGRzPScpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTsgIl0sInZlcnNpb24iOjN9